(this["webpackJsonpflat-maintenance"]=this["webpackJsonpflat-maintenance"]||[]).push([[0],{182:function(e,t){},336:function(e,t,a){},338:function(e,t){},399:function(e,t){},401:function(e,t){},425:function(e,t){},453:function(e,t){},455:function(e,t){},484:function(e,t){},486:function(e,t){},487:function(e,t){},493:function(e,t){},495:function(e,t){},498:function(e,t){},500:function(e,t){},520:function(e,t){},536:function(e,t){},539:function(e,t){},586:function(e,t){},613:function(e,t,a){},666:function(e,t,a){},668:function(e,t,a){},669:function(e,t,a){},671:function(e,t){},672:function(e,t){},673:function(e,t,a){},674:function(e,t,a){},675:function(e,t,a){},676:function(e,t,a){},677:function(e,t,a){},678:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(339),s=a(75),o=a(739),c=a(37),l=a(361),p=a.n(l),d=a(362),h=a.n(d),u=a(357),g=a.n(u),j=a(356),b=a.n(j),O=a(359),v=a.n(O),m=a(360),S=a.n(m),A=a(358),y=a.n(A),C=a(76),f=a(102),D=a(343);let x=function(e){return e.LOAD_TRANS="LOAD_TRANS",e.LOAD_CASH_TRANS_SUCCESS="LOAD_CASH_TRANS_SUCCESS",e.LOAD_ONLINE_TRANS_SUCCESS="LOAD_ONLINE_TRANS_SUCCESS",e.LOAD_CASH_TRANS_FAILURE="LOAD_CASH_TRANS_FAILURE",e.LOAD_ONLINE_TRANS_FAILURE="LOAD_ONLINE_TRANS_FAILURE",e.UPDATE_MONTHLY_SPLIT="UPDATE_MONTHLY_SPLIT",e.RESET_MONTHLY_SPLIT="RESET_MONTHLY_SPLIT",e.UPDATE_MONTHLY_MAINT_SPLIT="UPDATE_MONTHLY_MAINT_SPLIT",e.RESET_MONTHLY_MAINT_SPLIT="RESET_MONTHLY_MAINT_SPLIT",e.RESET_TRANS="RESET_TRANS",e}({});const T={loading:!1,cashTransData:void 0,onlineTransData:void 0,monthlyCatSplit:void 0,error:""};var E=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case x.LOAD_TRANS:return{...e,loading:!0};case x.LOAD_CASH_TRANS_SUCCESS:return{...e,loading:!1,cashTransData:t.payload,error:""};case x.LOAD_ONLINE_TRANS_SUCCESS:return{...e,loading:!1,onlineTransData:t.payload,error:""};case x.LOAD_CASH_TRANS_FAILURE:return{...e,loading:!1,cashTransData:void 0,error:t.payload};case x.LOAD_ONLINE_TRANS_FAILURE:return{...e,loading:!1,onlineTransData:void 0,error:t.payload};case x.UPDATE_MONTHLY_SPLIT:return{...e,monthlyCatSplit:t.payload,loading:!1};case x.RESET_MONTHLY_SPLIT:return{...e,monthlyCatSplit:void 0};case x.UPDATE_MONTHLY_MAINT_SPLIT:return{...e,monthlyMaintSplit:t.payload,loading:!1};case x.RESET_MONTHLY_MAINT_SPLIT:return{...e,monthlyMaintSplit:void 0};case x.RESET_TRANS:return T;default:return e}},M=a(342),N=a(39),R=a.n(N),I=a(23),k=a.n(I);const w=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const t={res:!1,error:""};if(e){const n=R.a.AES.decrypt(Y.ENC_CLIENT_EMAIL,e),i=R.a.AES.decrypt(Y.ENC_PRIVATE_KEY,e),r=R.a.AES.decrypt(Y.ENC_CHAT_GPT_KEY,e),s=R.a.AES.decrypt(Y.ENC_GOOGLE_API_KEY,e),o=R.a.AES.decrypt(Y.ENC_GEMINI_KEY,e);try{Y.clientEmail=n.toString(R.a.enc.Utf8),Y.privateKey=i.toString(R.a.enc.Utf8),Y.googleAPIKey=s.toString(R.a.enc.Utf8),Y.secret=e,Y.chatGPTPrivateKey=r.toString(R.a.enc.Utf8),Y.geminiKey=o.toString(R.a.enc.Utf8),sessionStorage.setItem("session-id",e),t.res=!0}catch(a){Y.secret="",t.res=!1,t.error="Invalid Secret Provided"}}else Y.secret="",t.res=!1,t.error="Empty Secret Set";return t},L=["001","002","003","004","005","007","008","009","010","011","012","101","102","103","104","105","106","107","108","109","110","111","112","201","202","203","204","205","206","207","208","209","210","211","212","301","302","303","304","305","306","307","308","309","310","311","312","401","402","403","404","405","406","407","408","409","410","411","412"],_={transCategories:[{key:"maintenance",label:"Maintenance",children:L.map((e=>({key:"maintenance-".concat(e),label:e})))},{key:"corpus",label:"Corpus Fund",children:L.map((e=>({key:"corpus-".concat(e),label:e})))},{key:"monthly",label:"Monthly Expenses",children:[]},{key:"others",label:"Others",children:[{key:"fine",label:"Fine"},{key:"extra",label:"Other Income"},{key:"account-transfer",label:"FD Deposit"},{key:"tenant-deposit",label:"Tenant Deposit"},{key:"rd-deposit",label:"Deposit to RD account"}]}],transactionFinYear:k()().format("YY"),transSheetMonth:"",transactions:[]},Y={secret:sessionStorage.getItem("session-id")||"",SPREADSHEET_ID:"16Q4fGH3MHV4yFZn-Ws0tDpz57hXLjOE_wDSXilJCDZ0",ENC_CLIENT_EMAIL:"U2FsdGVkX19lrOkAqkI1YRZkdHSjXZc+dtJNUzOhSlqaydB6Gxi4lm9MpS7+2/W7OtInfOCmh739buu1z1jzT/jJrAeRX2+hKkxc+3qsduw=",ENC_PRIVATE_KEY:"U2FsdGVkX1/i7T93uNMkvtV/hIYkButYpbgdWdXVf4ftrMUIjGc7OmaZRamJzAZNh3HKcvAW92t+mtWkIpJ2sLzLlB0BWWbBTZDPl+C/oD1YCcDZYCCPaHOcSvedvzBXLP3lGDi61mXPqPPGMDquh90g7oKvO8w+Oe6JIV8HQ9EYYB/rd/IRj34CP9K96NQDxcy06xsL2SfMMQuqSyBwRYYebogb4NZgpjfSKx6AJCvRnHkZMGBt2E0xtGm1UmS+XLq1Dlay8s2fJAYuF4yxSMjJpCzhOdTY0rhbTIQ8D3kZvJJU9+MCS4yqsVBCdqkWRqoQBBhHk8vSwb8ZTcomRUg4w6JDOu+HCT4vA6x5Jz8aSYu0CxZKndd4gHXy55YklnC728IKDavaEC13bNG/OrsBQL8P0IjzuomEAiQdFpdoQg81JmANZx1MbGD8NvdmuNEGzkTLPEssID5pO1AzGCepSeikWB8XXkJu+kHLGQe6SyBE7oxv5SDfeexWfkGOObo2Af9VbtZwg+jlVgKzf0lBj9NW0soC15VrpzV4t7oUpMT3Fe6d3oijHQ2hPxTYZMfuA8UsyO3WSTUbaxNWOpUbijJsDSUpENGQyr1XFSV4+3aN78prPt443BiaHAm8i50y9z2P7TJJteRrRE900MBm/9sMRK3fZb91VUJ9wsvmzRsJK7cxxBStx7T1k3wxQZCJisWXej+vqRlP0le95yB/2BikMV+nYyom4gQrySk8eW2rzvx26LS3LHf867SdpXSWzT7RBdIhxd6IXsK8B/fIjmR6zpeqMb/LUjRm4LcTn3UZgKEYDEFmgRGR07lsTP1czidqjCuOn+o9mZblzbsMFFAFzPhaj0ZKcO82vs3bHkDGIfoaN+EimD1ThwxlEehX08EOOKNLp19sxpUcwaxjbRgwunMh0o7J/H92TpsppRJJRfUEsI/ReI021yqkpiqRZcI/cEn3NykY1MualaqkuddoKqeD2LKjOmxaT26niNSsd/ffhjBD5f1DCWq84iXQaje6SIV1ZwesIUbUUG7MSTHI6Mf3LZuWIK/HQU/MhSYYtIHv7rvcJUyw0e/ZnUfKBRgyMYSLeTZI55MYPJ0HUGPJWIWnYMk8ESLBLnPnDknXo2m1i87Y37ui3Snqy7s6WW6nYlz1/HPexx/HQaQl5UsRGNre6+RREonqmL+B+AITWlN+bA4iLOnYfCg8OdyACDWBge3fwxduWWB4vtzlDNMx/Xqcb52BZAAh6d6Z7AE3t66ZfHv16VZnEEm14uV+zBgt41Mkfv0LNFZ6cqOjafwioFnMO9e3j738n2xwKMzcMzsdnhmHkyF7i7PLZqbTBp8P167/psPnfUV8vfcsmTombUUzOzViqJABfG6EczwhN19dd4lusGVDNrz43ywTA5zfU/jMcy1wk7i90rXo0HZSNNOuLGog2+qlx2xuyHORqdEVshb0BeJYckX95zjXLu6BuTO66vp4oIzecv9vprH3Jfx67mRvKKa+8xExXlY0BDM7vND5+EAZ0wz71MJonVjx/cXHqrSDxcnU1x5BJLAgZliQDZk/lAxBbUSuqvF21NBvZWGk2rDRKr5rTibBRDeOGoTQW1kRus87/YPBvThJ2OlFHkEAYskLyk8xPFTeC2XUJCEF7K6U3UpjL7LLWoCP+KcwazlItikvTzR44AAf2iFRf0+6wVQLZjpHZed0Z7KchTDyCm0ydVHuMAJjpogPjUbj26tbiICQ9SRtO+keG+JUHElkQzOe0bfsTuw8CqwPm6C1hNL9ReYYxrbwAwrZU8si4RWE1qSJ3cQXrxIOP275Uvsr5eUlgWYdJBrrYGUOjvQupB5CX9JL9SuH8Rfml2NzrMLWMM5mT9R1amUKLcl2ZyLkC4NDEmeqxPMtRtPLlQA/1aH939OdMbR5OZ9ozlSZFGiSS1eucvK44xvI4KCbFARx+urxXQgTSmZd/GwcFc5ZZXlojU8DTgQc5HTijP2x8iMptYYK/iPz2brWPs7LZsOiBaKCsbzWGdu/Lo3xJRqZoS5x7jGNl2q0JCj9/a0m7v+ODEZ6LaAQwsKX6M5iqNQ0YQWzlMClB6i1shbbrLsqtACXovqx9ACssZMVt7U9/WlDnmpjV+QT5Duhx8WBKehO2CeL2W9ZO8TtW+YDsV0mytvkXPwMl2RwMSAoNVau7b4CrU67z8BEVFcRKGHIURXxN/vithCvLR7Kk8+37cF16NOLBu1t6uixXH+0371xj74wJf7RFeeceyeZvGDrAsJ5qRvqD+vsAjl3EGUJySw1BJryedcR",ENC_GOOGLE_API_KEY:"U2FsdGVkX1+z10t9/VGkdh+xgB9JO7TwDIGpiW5ivAoQrmKV9c77947cJH49fTgzZcc5DSaLNH1jlCpIiLbSuw==",ENC_CHAT_GPT_KEY:"U2FsdGVkX19CE/c8Tng+qxPTykma92uBwnVA8hVNUPhl5desREv8awMfLxjN2ZnKC23rEB6XcYTSzVfgEwgEqQPZuhXq3Ef0cng56m8DqyI=",ENC_GEMINI_KEY:"U2FsdGVkX1+ja6BvyIZ4xRS/wHKtCFsD22qQ0wfw/U30gL6c2FfqhrQyqt25ch1C77vdq1A7rlLZ0RKBXXjmaQ==",doc:new M.GoogleSpreadsheet("16Q4fGH3MHV4yFZn-Ws0tDpz57hXLjOE_wDSXilJCDZ0"),appData:_},B=()=>Y;Y.secret&&w(Y.secret);const U=i.a.createContext(Y);var P=U,H=function(e){return e.INIT="INIT",e.INIT_SUCCESS="GET_SHEET_INFO",e.INIT_FAILURE="GET_SHEET_INFO_FAILURE",e.SET_SHEET_INFO="SET_SHEET_INFO",e}(H||{}),F=H;const K={initError:"",sheetConfig:B(),sheetInfo:new Map};var J=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case F.INIT:return{...e,initializing:!0};case F.INIT_SUCCESS:return{...e,initializing:!1,appConfig:t.payload};case F.INIT_FAILURE:return{...e,initializing:!1,initError:t.payload};case F.SET_SHEET_INFO:return{...e,sheetInfo:t.payload};default:return e}};let W=function(e){return e.INIT="INIT",e.SUCCESS="SUCCESS",e.FAILURE="FAILURE",e.SET_CONFIG="SET_CONFIG",e.ADD_EVENTS="ADD_EVENTS",e}({});const V={isLoading:!1,data:{},config:{encBotId:"U2FsdGVkX1/0gDV/ibea6VfAgozs8tNyWPB0zt3iRLDsNORNjxOhmloQXZl7ywLjxeQl4Bmxe3iZ7RLdUxi+BA==",listURL:"https://state-tourniquet.000webhostapp.com/suraksha/telegram/get.php",fetchURL:"https://api.telegram.org/bot{{botId}}/getFile?file_id={{fileId}}",downloadURL:"https://api.telegram.org/file/bot{{botId}}/photos/{{filePath}}",updateURL:"https://state-tourniquet.000webhostapp.com/suraksha/telegram/processed.php?id={{recordId}}"},layoutData:void 0,events:[]};var G=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case W.INIT:return{...e,isLoading:!0,layoutData:t.payload};case W.SUCCESS:return{...e,isLoading:!1,data:t.payload,error:void 0};case W.FAILURE:return{...e,isLoading:!1,data:void 0,error:t.payload};case W.SET_CONFIG:return{...e,config:t.payload};case W.ADD_EVENTS:return{...e,events:[...e.events,t.payload]};default:return e}};var q=Object(f.b)({sheet:J,trans:E,bills:G});const z=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||f.c;var Z=Object(f.d)(q,z(Object(f.a)(D.a))),X=a(753),Q=a(733),$=a(755),ee=a(756),te=a(757),ae=a(758),ne=a(744),ie=a(1);function re(e){const[t,a]=i.a.useState(!0),[r,s]=i.a.useState(""),o=Object(n.useCallback)((()=>{e.handleSecret(r)}),[e,r]),c=Object(n.useCallback)((e=>{s(e.target.value)}),[]),l=Object(n.useCallback)((t=>{13===(t.keyCode?t.keyCode:t.which)&&e.handleSecret(r)}),[e,r]);return Object(ie.jsxs)(X.a,{open:t,keepMounted:!0,"aria-labelledby":"Secret Key","aria-describedby":"Enter your secret key",children:[Object(ie.jsx)(Q.a,{id:"alert-dialog-slide-title",children:"Enter the secret key!!!"}),Object(ie.jsxs)($.a,{children:[Object(ie.jsx)(ee.a,{id:"alert-dialog-slide-description",children:"Check with other committee members, if secret key is not known."}),Object(ie.jsx)(te.a,{type:"password",value:r,onChange:c,onKeyPress:l}),Object(ie.jsx)("div",{className:"error",children:e.errorMsg})]}),Object(ie.jsx)(ae.a,{children:Object(ie.jsx)(ne.a,{onClick:o,disabled:!r,color:"primary",children:"OK"})})]})}var se=a(10),oe=a(759),ce=a(353),le=a.n(ce),pe=a(352),de=a.n(pe),he=(a(613),a(47)),ue=a.n(he),ge=a(348),je=a(350),be=a.n(je),Oe=a(351);const ve=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Math.floor(Date.now()/1e3+3600);const{clientEmail:t,privateKey:a}=B(),n={iss:t,sub:"",aud:"https://www.googleapis.com/oauth2/v4/token",scope:"https://www.googleapis.com/auth/drive",exp:e,iat:Math.floor(Date.now()/1e3),jti:Object(Oe.uuid)()};return be.a.sign(n,a||"",{algorithm:"RS256"})},me=async()=>{const{clientEmail:e}=B(),t={grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",client_id:e,assertion:await ve()},a=await ue.a.post("https://www.googleapis.com/oauth2/v4/token",t);if(200===a.status)return a.data.access_token;throw new Error(a.data)};const Se="VERIFIED_",Ae="1zVRwXWZjfAS3Hk1rXq-XtqurPcQ-yAW-";async function ye(e){const{googleAPIKey:t}=B(),a=encodeURI("'".concat(e||Ae,"' in parents and (mimeType = 'image/jpeg' or mimeType = 'image/png' or mimeType = 'application/pdf' or mimeType = 'application/vnd.google-apps.folder')"));try{const e=await ue.a.get("https://www.googleapis.com/drive/v3/files?q=".concat(a,"&key=").concat(t)),{files:n}=e.data;return console.log("Fetched files:",n),n}catch(n){console.error("Error fetching files:",(null===n||void 0===n?void 0:n.message)||n)}return[]}const Ce=async(e,t)=>{try{const a=await me(),n=await ue.a.patch("https://www.googleapis.com/drive/v3/files/".concat(e),{name:"".concat(Se).concat(t)},{headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"}});if(console.log("File moved successfully:",n.data),200===n.status)return n.data}catch(a){console.error("Error occurred while moving the file:",a)}return null};const fe=async e=>{const t=function(e){let t;t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):unescape(e.split(",")[1]);const a=e.split(",")[0].split(":")[1].split(";")[0],n=new Uint8Array(t.length);for(let i=0;i<t.length;i+=1)n[i]=t.charCodeAt(i);return new Blob([n],{type:a})}(e),a=new File([t],"canvasImage.jpg",{type:"image/jpeg"}),n=new FormData;n.append("base64Image",a);return await ue.a.post("https://api.ocr.space/parse/image",n,{headers:{"Content-Type":"multipart/form-data",apikey:"K84187439488957"}})};var De=a(195);class xe{constructor(){if(this.chatGPTPrivateKey="",this.openAI=void 0,this.appConfig=void 0,this.appConfig=B(),this.appConfig.chatGPTPrivateKey){this.chatGPTPrivateKey=this.appConfig.chatGPTPrivateKey;const e=new De.Configuration({organization:"org-wfOq673LgvxydlfXwY3Fmcvm",apiKey:this.chatGPTPrivateKey});this.openAI=new De.OpenAIApi(e)}}async getCompleted(e){return this.openAI?this.openAI.createCompletion({model:"text-davinci-003",prompt:"Say this is a test",max_tokens:7,temperature:0,top_p:1,n:1,stream:!1,logprobs:null,stop:"\n"}):Promise.resolve("")}static getInstance(){return xe.instance||(xe.instance=new xe),xe.instance}}xe.instance=void 0;var Te=xe;var Ee=function(){const e=Object(n.useRef)(),[t,a]=Object(n.useState)(),[i,r]=Object(n.useState)(!0),s=Object(n.useCallback)((()=>{const n=e.current||{};!t&&n&&n.takePhoto?(a(n.takePhoto()),r(!1)):a(void 0)}),[e,t]),o=Object(n.useCallback)((()=>{r((e=>!e))}),[]),c=i?"cash-trans block-page":"cash-trans",[l,p]=Object(n.useState)();return Object(n.useEffect)((()=>{t&&fe(t).then((async e=>{const{ParsedText:t}=e.data.ParsedResults[0]||{};if(t){const e=await Te.getInstance().getCompleted(t);p(e)}}))}),[t]),Object(ie.jsxs)("div",{className:c,children:[Object(ie.jsx)("div",{children:"Handle Cash Transactions"}),Object(ie.jsx)("pre",{children:JSON.stringify(l,void 0,4)}),!t&&Object(ie.jsx)(oe.a,{className:"close-camera","aria-label":"Take Photo",onClick:o,children:i?Object(ie.jsx)(de.a,{}):Object(ie.jsx)(le.a,{})}),Object(ie.jsx)(oe.a,{className:"camera-click","aria-label":"Take Photo",onClick:s,children:Object(ie.jsx)("img",{src:"/images/circular-camera.png",alt:"Take Pic"})})]})};var Me=()=>Object(ie.jsx)(Ee,{}),Ne=a(118),Re=a(745),Ie=a(690),ke=a(766),we=a(741);var Le={"Audit Fees":1,BWSSB:2,Diesel:3,Bescom:4,"House Keeping Salary":5,Security:6,"Garden Maintenance":7,"Garbage Collection Vendor / BBMP":8,"Borewell And Motor Maintenance":9,"Annual Bonus":10,"Lift Maintenance":11,"HK Items Purchased":12,"Health Club Maintenance":13,"Electrical / Plumbing Repairs":14,"Apartment repairs related":15,"Apartment Safety":16,"CCTV / Intercomm":17,"Misc expenses":18,"Apartment developments":19,"Apartment Work By Security and Others":20,"Septic Tank Repairs / Cleaning":21,"Water Tanks Cleaning":22,"Generator Maintenance and Repair":23,"Savings Bank SMS Charges/Cheque book":24,"Festival/Holiday Celebration":25,"Drinking Water for Employees":26,"BAF Subscription Charges":27,"Maintenance Collection":30,"Income Tax Refund":31,"Other Income":32,"Interest on account":33,"Fine / Extra Payment Received":34,"Corpus Fund":35,"Tenant Deposit from the Owners":36,"FD Deposit":37,"Deposit to RD account":38};var _e={Apr:2,May:3,Jun:4,Jul:5,Aug:6,Sep:7,Oct:8,Nov:9,Dec:10,Jan:11,Feb:12,Mar:13},Ye={"001":1,"002":2,"003":3,"004":4,"005":5,"007":6,"008":7,"009":8,"010":9,"011":10,"012":11,101:12,102:13,103:14,104:15,105:16,106:17,107:18,108:19,109:20,110:21,111:22,112:23,201:24,202:25,203:26,204:27,205:28,206:29,207:30,208:31,209:32,210:33,211:34,212:35,301:36,302:37,303:38,304:39,305:40,306:41,307:42,308:43,309:44,310:45,311:46,312:47,401:48,402:49,403:50,404:51,405:52,406:53,407:54,408:55,409:56,410:57,411:58,412:59};var Be={Apr:2,May:3,Jun:4,Jul:5,Aug:6,Sep:7,Oct:8,Nov:9,Dec:10,Jan:11,Feb:12,Mar:13};let Ue;class Pe{constructor(){this.currentSheet="",this.initialized=!1,this.appConfig=void 0,this.appConfig=B()}init(){return this.initialized?Promise.resolve(this.appConfig.doc):new Promise(((e,t)=>{const{doc:a}=this.appConfig;a.useServiceAccountAuth({client_email:this.appConfig.clientEmail||"",private_key:this.appConfig.privateKey||""}).then((()=>{a.loadInfo().then((()=>{this.initialized=!0,e(a)})).catch((e=>{console.log(e)}))})).catch((e=>{console.log(e),t(e)}))}))}getSpreadSheet(){return this.appConfig.doc}async getSheetByTitleAsJson(e){const t=[],a=await this.getSheetByTitle(e);let n=a.headerValues,i=a.columnCount;if(!n||0===n.length){n=[];for(let e=0;e<i;e+=1){const{value:t}=a.getCell(0,e);t&&n.push(a.getCell(0,e).value.toString())}}i=n.length;const{rowCount:r}=a;for(let s=1;s<r;s+=1){const e={},r=[];for(let t=0;t<i;t+=1){const i=n[t],o=a.getCell(s,t).formattedValue;e[i]=o,r.push(o)}if(!r.some((e=>null!==e)))break;t.push(e)}return t}async getSheetByTitle(e){var t;const a=null===(t=this.appConfig.doc)||void 0===t?void 0:t.sheetsByTitle[e];return a&&(this.currentSheet=a.sheetId,await a.loadCells()),a}async getSheet(e){this.currentSheet=e;const t=this.appConfig.doc.sheetsById[e];return await t.loadCells(),t}appendSheet(e,t){return this.appConfig.doc.sheetsById[e].addRow(t)}append(e){return this.appConfig.doc.sheetsById[this.currentSheet||""].addRow(e)}async appendRows(e){const t=this.appConfig.doc.sheetsById[this.currentSheet||""];await t.addRows(e)}getSheetRow(e,t){return this.appConfig.doc.sheetsById[e].getRows({limit:1,offset:t})}getRow(e){return this.appConfig.doc.sheetsById[this.currentSheet||""].getRows({limit:1,offset:e})}getColumn(e){const t=this.appConfig.doc.sheetsById[this.currentSheet||""],a=[],n=t.rowCount<100?t.rowCount:100;for(let i=0;i<n-1;i+=1)a.push(t.getCell(i,e));return a}getColumnWithSheet(e,t){const a=[],n=e.rowCount<100?e.rowCount:100;for(let i=0;i<n-1;i+=1)a.push(e.getCell(i,t));return a}getSheetColumn(e,t){const a=this.appConfig.doc.sheetsById[e],n=[],i=a.rowCount<100?a.rowCount:100;for(let r=0;r<i-1;r+=1)n.push(a.getCell(r,t));return n}getSheetCell(e,t,a){return this.appConfig.doc.sheetsById[e].getCell(t,a)}getCell(e,t){return this.appConfig.doc.sheetsById[this.currentSheet||""].getCell(e,t)}saveSheetCells(e,t){return this.appConfig.doc.sheetsById[e].saveCells(t)}saveCells(e){return this.appConfig.doc.sheetsById[this.currentSheet||""].saveCells(e)}addSheet(e){return this.appConfig.doc.addSheet(e)}async saveSheetWithJSON(e){const t=this.appConfig.doc.sheetsById[this.currentSheet||""];await this.updateSheet(t,e)}async updateCategorySheet(e){const t=await this.getSheetByTitle("Summary");await t.loadCells();return Object.keys(e).forEach((a=>{const n=e[a],i=Object.keys(n),r=a.replace(/-\d+$/,""),s=_e[r];i.forEach((e=>{const a=Le[e];if("undefined"!==typeof a&&"undefined"!==typeof s){t.getCell(a,s).value=n[e]}}))})),t.saveUpdatedCells()}async udpateMaintenanceSheet(e){const t=await this.getSheetByTitle("Maintanence");await t.loadCells();return Object.keys(e).forEach((a=>{const n=e[a],i=Object.keys(Ye),r=a.replace(/-\d+$/,""),s=Be[r];i.forEach((e=>{const a=Ye[e];if("undefined"!==typeof a&&"undefined"!==typeof s){t.getCell(a,s).value=n[e]}}))})),t.saveUpdatedCells()}async searchUpdateRecord(e,t,a,n){const i=await this.getSheetByTitle(e),r=await i.getRows(),s=r.findIndex((e=>Object.entries(t).every((t=>{let[a,n]=t;return e[a]===n}))));if(-1===s)throw console.log("Record not found."),new Error("RECORD_NOT_FOUND");{const e=r[s];e[a]?console.log("Record found but input column is not empty."):(e[a]=n,await e.save(),console.log("Record updated successfully."))}}isEmptySheet(e){return!e||0===e.rowCount}async updateSheet(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(t&&t.length){const n=Object.keys(t[0]),i=n.length,r=a+t.length;for(let s=a;s<r;s+=1){const a=t[s];for(let t=0;t<i;t+=1){const i=e.getCell(s+1,t),r=a[n[t]];i.formattedValue!==r&&(i.value=r)}}}await e.saveUpdatedCells()}async updateSheetWithJSON(e,t){t&&await this.getSheetByTitle(t),await this.appendRows(e)}static getInstance(){return Ue||(Ue=new Pe,Ue.init()),Ue}}var He=Pe.getInstance();const Fe=()=>({type:F.INIT}),Ke=e=>({type:F.INIT_SUCCESS,payload:e}),Je=e=>({type:F.INIT_FAILURE,payload:e});let We=function(e){return e.and="and",e.or="or",e.xor="xor",e.not="not",e.nand="nand",e.nor="nor",e}({});var Ve=class{constructor(e){this.query=void 0,this.query=e}run(e){return Object.keys(this.query).every((t=>{const a=this.query[t];switch(t){case We.or:return a.some((t=>e(t)));case We.nor:return!a.some((t=>e(t)));case We.xor:{const t=a.map((t=>e(t)));return t.some((e=>!0===e))&&t.some((e=>!1===e))}case We.nand:case We.not:return!a.every((t=>e(t)));case We.and:default:return a.every((t=>e(t)))}}))}},Ge=a(119);const qe=(e,t)=>t.split(/\s+/).some((t=>Object(Ge.a)(t.toString())===Object(Ge.a)(e))),ze=(e,t)=>t.some((t=>Object(Ge.a)(t.toString())===Object(Ge.a)(e)));var Ze=class{constructor(e){this.query=void 0,this.query=e}run(e){let t=!1;const{opr:a,value:n}=this.query;if(e&&n)switch(a){case"==":t=e.toString()===n.toString()||qe(n.toString(),e.toString());break;case"!=":t=e.toString()!==n.toString();break;case">":t=e>n;break;case">=":t=e>=n;break;case"<":t=e<n;break;case"<=":t=e<=n;break;case"having":if("string"===typeof e)if(Array.isArray(n))t=n.some((t=>{const a=t.toString(),n=e.toLowerCase(),i=a.toLowerCase();return n.indexOf(i)>-1||qe(i,n)}));else{const a=n.toString(),i=e.toLowerCase(),r=a.toLowerCase();t=i.indexOf(r)>-1||qe(r,i)}break;case"regex":if(Array.isArray(n))t=n.some((t=>{var a;const n=t.toString(),i=new RegExp(n,"i");return(null===(a=e.match(i))||void 0===a?void 0:a.length)>0}));else{var i;const a=n.toString(),r=new RegExp(a,"i");t=(null===(i=e.match(r))||void 0===i?void 0:i.length)>0}break;case"in":Array.isArray(n)&&(t="string"===typeof n[0]?n.indexOf(e.toString())>-1||ze(e.toString(),n):n.indexOf(e)>-1);break;case"range":Array.isArray(n)&&(t="undefined"===typeof n[0]||e>=n[0],t=t&&("undefined"===typeof n[1]||e<=n[1]))}return t}};class Xe{constructor(e){this.query=void 0,this.query=e}run(e){return Object.keys(this.query).every((t=>{const a=this.query[t];let n=!1;if(Array.isArray(a))n=a.every((a=>{const n=new Ze(a),i=e[t];return n.run(i)}));else{n=new Ve(a).run((a=>{const n=new Ze(a),i=e[t];return n.run(i)}))}return n}))}}class Qe{constructor(e){this.catFieldMap=void 0,this.catFieldMap=e}run(e){const t=Object.keys(this.catFieldMap);e.forEach((e=>{if(!e.Category){const a=t.find((t=>{const a=this.catFieldMap[t];let n;if(Array.isArray(a))n=a.every((t=>new Xe(t).run(e)));else{n=new Ve(a).run((t=>new Xe(t).run(e)))}return n}));e.Category=a}}))}}var $e={"Maintenance Collection":[{Credit:[{opr:"in",value:["2,600.00","2600","2,700.00","2700","2,800.00","2800","5,400.00","5400","5,500.00","5500","5,600.00","5600","8,100.00","8100","5,200.00","5200","8,400.00","8400","10,800.00","10800","11,200.00","11200","14,000.00","14000","13,500.00","13500"]}],Description:[{opr:"having",value:["maintenance","neft","upi","imps"]}]}],"Audit Fees":[{Description:[{opr:"having",value:["N YASWANTH","YASWANTH","audit","audit fees"]}]}],"Corpus Fund":[{Credit:[{opr:"in",value:["7500","7,500.00","15,000.00","15000","22,500.00","22500","30,000.00","30000","37,500.00","37500","45,000.00","45000"]}],Description:[{opr:"having",value:["corpus","neft","upi","imps"]}]}],"Income Tax Refund":[{Credit:[{opr:"in",value:["ACH","AY20","ACH Credit","AAKAS1985M"]}]}],Bescom:[{Description:[{opr:"having",value:["BESCOM","Electricity","EBANK:BBPS"]}]}],BWSSB:[{Debit:[{opr:"range",value:[14e3,16500]}],Description:[{opr:"having",value:["BANGALORE WATER SUPPLY","BWSSB","BANGALORE ONE","EBANK:BBPS"]}]}],"CCTV / Intercomm":[{Description:[{opr:"having",value:["SHANKAR TELECOM LINKS","Intercom"]}]}],Security:[{Debit:[{opr:"in",value:[35e3,35e3,41e3,41e3]}]}],"House Keeping Salary":[{Description:[{opr:"regex",value:["keeping","housekeeping","house keeping","Housekeeping.+Salary","House keeping.+Salary","house-keeping.+salary","housekeeping.+ladies","hk.+salary","hyrunni","sunanda"]}]}],"Garden Maintenance":[{Description:[{opr:"regex",value:["garden","gardner","Gardner.+Salary","garden.+work","Manure"]}]}],"Garbage Collection Vendor / BBMP":[{Description:[{opr:"having",value:["SYED ALI BASHA","RR CLEANING","RR CLEAN"]}]}],"Borewell And Motor Maintenance":[{Description:[{opr:"having",value:["borewell","motor","coil","winding"]}]}],"Lift Maintenance":[{Description:[{opr:"regex",value:["JOHNSON.+LIFTS","Lift"]}]}],"HK Items Purchased":[{Description:[{opr:"regex",value:["Housekeeping.+Items","Housekeeping.+Material","hk.+item","HK.+Material","bleaching","garbage drum","powder","mop","dust","dustbin","soap","detergent","broom","switch","tubelight","switch","light","bulb","Phenoyl","powder","phenoyl","sanitizer","cleaner","dettol","bottle","neem oil","tap","kerosene"]}]}],"Electrical / Plumbing Repairs":[{Description:[{opr:"having",value:["electric repair","electric work","electric","Chamundi","plumbing"]}]}],"Septic Tank Repairs / Cleaning":[{Description:[{opr:"having",value:["septik","septic","septic tank","sewage","sewage tank","sewage work","sewage pipe"]}]}],"Water Tanks Cleaning":[{Description:[{opr:"regex",value:["water.+tank","cauvery","kaveri"]}]}],"Generator Maintenance and Repair":[{Description:[{opr:"regex",value:["venus.+energy","kirloskar","generator"]}]}],"Savings Bank SMS Charges/Cheque book":[{Description:[{opr:"regex",value:["SMS .+Alert","cheque.+book","charges","chq.+book"]}]}],"Health Club Maintenance":[{Description:[{opr:"having",value:["gym","FITNESS","sports"]}]}],"Festival/Holiday Celebration":[{Description:[{opr:"regex",value:["diwali.+work","diwali","festival","celebration","pooja","pongal","independence","republic","sweets","flag"]}]}],"Drinking Water for Employees":[{Description:[{opr:"having",value:["drinking","drinking water","mineral water","water purchase"]}]}],Diesel:[{Description:[{opr:"regex",value:["Diesel"]}]}],"BAF Subscription Charges":[{Description:[{opr:"regex",value:["BAF","BAF Subscription"]}]}],"Annual Bonus":[{Description:[{opr:"regex",value:["bonus"]}]}],"Interest on account":[{Description:[{opr:"having",value:["89630100005613"]}]}],"FD Deposit":[{Description:[{opr:"having",value:["TO TRANSFER","Repayment Credit"]}]}],"Tenant Deposit from the Owners":[{Credit:[{opr:"in",value:["10,000.00","10000"]}]}],"Apartment Work By Security and Others":[{Description:[{opr:"regex",value:["Apartment.+Work","Cleaning.+Rain Water"]}]}],"Apartment Safety":[{Description:[{opr:"having",value:["sanitization","sanitizing","mask","sheild","shield","spray","cutting tree","fire","extinguisher","rat poison"]}]}],"Apartment developments":[{Description:[{opr:"having",value:["stationery","pen","paper","folder","files","notebook","note book","note-book","entry book","reciept book","bought","purchased","purchase of","cash voucher"]}]}],"Apartment repairs related":[{Description:[{opr:"having",value:["cement work","cement","service","repair","spanner","fixing","fixed"]}]}],"Misc expenses":[{Description:[{opr:"having",value:["tea","coffee"]}]}],"Fine / Extra Payment Received":[{Description:[{opr:"having",value:["maintenance","neft","upi","imps"]}],Credit:[{opr:"regex",value:["\\d"]}]}],"Other Income":[{Description:[{opr:"having",value:["income","other"]}],Credit:[{opr:">",value:0}]}],"Cash Withdrawal / in hand":{or:[{Description:[{opr:"regex",value:["cash","withdrawal","bank","basavaraj","carry.+forwarded","self"]}]},{"Cheque No":[{opr:"regex",value:["\\d+"]}]}]},"Deposit to RD account":[{Description:[{opr:"having",value:["3715125","SI:89630300010611"]}]}]},et={"001":[{Description:[{opr:"having",value:["khadir","MOHAMEDABDULKHA"]}]}],"002":[{Description:[{opr:"having",value:["shainv","potti","MAHESH","NAGARAJ MUTHUSAMY","NAGARAJ"]}]}],"003":[{Description:[{opr:"having",value:["gulshan","padma","6364883334","subhrojyoti","6289470044"]}]}],"004":[{Description:[{opr:"having",value:["ANAND","ESHWARDAS"]}]}],"005":[{Description:[{opr:"having",value:["KOPRESH"]}]}],"007":[{Description:[{opr:"having",value:["007"]}]}],"008":[{Description:[{opr:"having",value:["NITHINS","/008","Repaka"]}]}],"009":[{Description:[{opr:"having",value:["rutvijkanzaria","PRATIK"]}]}],"010":[{Description:[{opr:"having",value:["ANANTH"]}]}],"011":[{Description:[{opr:"having",value:["AKARSH"]}]}],"012":[{Description:[{opr:"having",value:["K B GANESH","GANESH","VIVEKNAYAK","VIVEK NAYAK"]}]}],101:[{Description:[{opr:"having",value:["VIJAYAKUMAR T","VIJAYAKUMAR"]}]}],102:[{Description:[{opr:"having",value:["ARNAB","CHAKRABORTY","ARNABCHAKRABORT"]}]}],103:[{Description:[{opr:"having",value:["KRISHNA KUMAR","KRISHNAKUMAR"]}]}],104:[{Description:[{opr:"having",value:["AMIT KUMAR","KARMAKAR","AMITKUMAR"]}]}],105:[{Description:[{opr:"having",value:["VIKASVERMA","VIKAS VERMA","MB105","105MAINTENA","8892757591"]}]}],106:[{Description:[{opr:"having",value:["mr.uttammohanty","uttam"]}]}],107:[{Description:[{opr:"having",value:["POLAKALA","NARAYANA PRASAD"]}]}],108:[{Description:[{opr:"having",value:["EMMANUEL RAJA A","EMMANUEL"]}]}],109:[{Description:[{opr:"having",value:["K S A RAJA RAM KUMAR","RAJARAMKUMAR"]}]}],110:[{Description:[{opr:"having",value:["SONYKUMARI","SONY KUMARI","PAVAN DEVARU","PAVANDEVARU","MOBLTA"]}]}],111:[{Description:[{opr:"having",value:["SENTHILKUMAR","SENTHIL"]}]}],112:[{Description:[{opr:"having",value:["ARINDAM"]}]}],201:[{Description:[{opr:"having",value:["ESWAR KRISHNAN","ESWAR","KARTHIKEYAN","flat201"]}]}],202:[{Description:[{opr:"having",value:["SRIHARSHA","SRI HARSHA"]}]}],203:[{Description:[{opr:"having",value:["NILOTPALDAS"]}]}],204:[{Description:[{opr:"having",value:["AMLANJYOTI","AMLAN"]}]}],205:[{Description:[{opr:"having",value:["VIKRAMADITYA"]}]}],206:[{Description:[{opr:"having",value:["PINAKI"]}]}],207:[{Description:[{opr:"having",value:["PRIYA MISHRA","PRIYAMISHRA","SRINIVAS","prashant.dombale"]}]}],208:[{Description:[{opr:"having",value:["JESUDOSS"]}]}],209:[{Description:[{opr:"having",value:["AJUJAMESASHOK","AJU JAMES ASHOK","AJUJAMES","T R RAJARAM","TRRAJARAM","CHALAPATHI"]}]}],210:[{Description:[{opr:"having",value:["TARANBIR","IMPSMBRSur"]}]}],211:[{Description:[{opr:"having",value:["9972528008","pranjan"]}]}],212:[{Description:[{opr:"having",value:["SURAJIT"]}]}],301:[{Description:[{opr:"having",value:["PRABUDH"]}]}],302:[{Description:[{opr:"having",value:["BALAJI"]}]}],303:[{Description:[{opr:"having",value:["SURENDRA"]}]}],304:[{Description:[{opr:"having",value:["MEHDI"]}]}],305:[{Description:[{opr:"having",value:["VIVIN"]}]}],306:[{Description:[{opr:"having",value:["ASHIM","DEBAJYOTI"]}]}],307:[{Description:[{opr:"having",value:["SAMPREETH"]}]}],308:[{Description:[{opr:"having",value:["PRAHLAD"]}]}],309:[{Description:[{opr:"having",value:["7406849918","prasad.kiran","kbv018@okhdfcbank"]}]}],310:[{Description:[{opr:"having",value:["PREMA"]}]}],311:[{Description:[{opr:"having",value:["GURUPRASADA","CHOKKADI"]}]}],312:[{Description:[{opr:"having",value:["SHAKTHI","VINAYAK"]}]}],401:[{Description:[{opr:"having",value:["HARISHA"]}]}],402:[{Description:[{opr:"having",value:["JITHA","JITHAJAMES","JITHA JAMES"]}]}],403:[{Description:[{opr:"having",value:["8147758124","shaheer"]}]}],404:[{Description:[{opr:"having",value:["NOBROKER","/404Main","MOHAMMED SAIF"]}]}],405:[{Description:[{opr:"having",value:["SANTOSHKUMAR","/405main","SANTHOSH KUMAR","MALLA"]}]}],406:[{Description:[{opr:"having",value:["PRAVEENVIJAY","PRAVEEN VIJAY"]}]}],407:[{Description:[{opr:"having",value:["GALLA","VARADARAJU"]}]}],408:[{Description:[{opr:"having",value:["UDAY KIRAN","UDAY","YAGNAMURTHY"]}]}],409:[{Description:[{opr:"having",value:["PRABU","SUNDARRAJU","Jeevanantham"]}]}],410:[{Description:[{opr:"having",value:["rohinimh19","ROHINI","MALLIKARJUN"]}]}],411:[{Description:[{opr:"having",value:["NATESAN","ADITYA KOLLURI","ADITYAKOLLURI","santumahapatra","santu mahapatra"]}]}],412:[{Description:[{opr:"having",value:["CHIRANJAN"]}]}]};class tt{constructor(e){this.catFieldMap=void 0,this.catFieldMap=e}run(e){const t=Object.keys(this.catFieldMap);e.forEach((e=>{if(!e.Flat){const a=t.find((t=>{const a=this.catFieldMap[t];let n;if(Array.isArray(a))n=a.every((t=>new Xe(t).run(e)));else{n=new Ve(a).run((t=>new Xe(t).run(e)))}return n}));e.Flat=a}}))}}let at=function(e){return e["Audit Fees"]="Audit Fees",e.BWSSB="BWSSB",e.Diesel="Diesel",e.Bescom="Bescom",e["House Keeping Salary"]="House Keeping Salary",e.Security="Security",e.Gardener="Gardener",e["Garbage Collection Vendor / BBMP"]="Garbage Collection Vendor / BBMP",e["Borewell And Motor Maintenance"]="Borewell And Motor Maintenance",e["Annual Bonus"]="Annual Bonus",e["Lift Maintenance"]="Lift Maintenance",e["HK Items Purchased"]="HK Items Purchased",e["Health Club Maintenance"]="Health Club Maintenance",e["Electrical / Plumbing Repairs"]="Electrical / Plumbing Repairs",e["Apartment repairs related"]="Apartment repairs related",e["Apartment Painting"]="Apartment Painting",e["CCTV / Intercomm"]="CCTV / Intercomm",e["Misc expenses"]="Misc expenses",e["Apartment developments"]="Apartment developments",e["Apartment Work By Security and Others"]="Apartment Work By Security and Others",e["Septic Tank Repairs / Cleaning"]="Septic Tank Repairs / Cleaning",e["Water Tanks Cleaning"]="Water Tanks Cleaning",e["Generator Maintenance and Repair"]="Generator Maintenance and Repair",e["Savings Bank SMS Charges/Cheque book"]="Savings Bank SMS Charges/Cheque book",e["Festival/Holiday Celebration"]="Festival/Holiday Celebration",e["Drinking Water for Employees"]="Drinking Water for Employees",e["BAF Subscription Charges"]="BAF Subscription Charges",e["Maintenance Collection"]="Maintenance Collection",e["Income Tax Refund"]="Income Tax Refund",e["Other Income"]="Other Income",e["Interest on account"]="Interest on account",e["Fine / Extra Payment Received"]="Fine / Extra Payment Received",e["Corpus Fund"]="Corpus Fund",e["Tenant Deposit from the Owners"]="Tenant Deposit from the Owners",e["FD Deposit"]="FD Deposit",e}({});const nt=()=>({type:x.LOAD_TRANS}),it=e=>({type:x.LOAD_CASH_TRANS_SUCCESS,payload:e}),rt=e=>({type:x.LOAD_ONLINE_TRANS_SUCCESS,payload:e}),st=e=>({type:x.LOAD_CASH_TRANS_FAILURE,payload:e}),ot=e=>({type:x.LOAD_ONLINE_TRANS_FAILURE,payload:e}),ct=e=>({type:x.UPDATE_MONTHLY_SPLIT,payload:e}),lt=e=>({type:x.UPDATE_MONTHLY_MAINT_SPLIT,payload:e});function pt(e,t){return e.filter((e=>{if(e.Category){return e.Category.split(",").some((e=>{const[a]=e.split("(");return t.indexOf(a.trim())>-1}))}return!1}))}function dt(e,t){return a=>{a(nt()),e.forEach((e=>{const a=e.Category,n=e.Date;if(a&&n){var i;const r=a.split(","),s=e.Debit&&"0"!==(null===(i=e.Debit)||void 0===i?void 0:i.toString());let o=s?parseFloat(e.Debit.toString().replace(/,/g,"")):parseFloat(e.Credit.toString().replace(/,/g,""));r.forEach((a=>{let i=a;if(a.indexOf("(")>-1){const e=a.split("(");[i]=e,o=parseFloat(e[1].replace(/(\(|\))/g,"").replace(/,/g,""))}!function(e,t,a,n,i,r){const s=a.replace(/\//g,"-"),o=k()(s,"DD-MM-YYYY").format("MMM-YY");e||(e={});e[o]||(e[o]={});i&&(r=-r);r&&"number"===typeof r?e[o][n]?e[o][n]+=r:e[o][n]=r:console.log("cat",n,o,t)}(t,e,n,i.trim(),!!s,o)}))}})),a(ct({...t}))}}var ht=a(760),ut=a(761),gt=a(762),jt=a(763),bt=a(764),Ot=a(765);var vt=function(){const e=Object(c.c)((e=>e.trans)),t=Object(c.b)();Object(n.useEffect)((()=>{t(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Cash Transactions";return t=>{t(nt()),He.init().then((()=>{He.getSheetByTitleAsJson(e).then((e=>{new Qe($e).run(e),new tt(et).run(pt(e,[at["Maintenance Collection"],at["Corpus Fund"]])),t(it(e)),He.saveSheetWithJSON(e)})).catch((e=>{t(st(e.message))}))}))}}())}),[t]);const a=e.cashTransData,i=Object(n.useMemo)((()=>{let e=[];return a&&a.length>1&&(e=Object.keys(a[0])),e}),[a]);return Object(ie.jsx)(ie.Fragment,{children:Object(ie.jsxs)("div",{className:"cash-trans",children:[e.loading&&Object(ie.jsx)(ht.a,{}),!e.loading&&Object(ie.jsxs)(ut.a,{children:[Object(ie.jsx)(gt.a,{children:Object(ie.jsxs)(jt.a,{children:[Object(ie.jsx)(bt.a,{children:"Sl. No."}),i.map((e=>Object(ie.jsx)(bt.a,{children:e},e)))]})}),Object(ie.jsx)(Ot.a,{children:!!a&&a.map(((e,t)=>Object(ie.jsxs)(jt.a,{children:[Object(ie.jsx)(bt.a,{children:t+1}),i.map((t=>Object(ie.jsx)(bt.a,{children:"Date"!==t?e[t]:k()(e[t],"DD/MM/YYYY").format("DD/MM/YYYY")},"".concat(t,"-").concat(e[t]))))]},JSON.stringify(e))))})]})]})})};var mt=function(){const e=Object(c.c)((e=>e.trans)),t=Object(c.b)();Object(n.useEffect)((()=>{t(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Online Transactions";return t=>{t(nt()),He.init().then((()=>{He.getSheetByTitleAsJson(e).then((e=>{new Qe($e).run(e),new tt(et).run(pt(e,[at["Maintenance Collection"],at["Corpus Fund"]])),t(rt(e)),He.saveSheetWithJSON(e)})).catch((e=>{t(ot(e.message))}))}))}}("Online Transactions"))}),[t]);const a=e.onlineTransData,i=Object(n.useMemo)((()=>{let e=[];return a&&a.length>1&&(e=Object.keys(a[0])),e}),[a]);return Object(ie.jsx)(ie.Fragment,{children:Object(ie.jsxs)("div",{className:"online-trans",children:[e.loading&&Object(ie.jsx)(ht.a,{}),!e.loading&&Object(ie.jsxs)(ut.a,{children:[Object(ie.jsx)(gt.a,{children:Object(ie.jsxs)(jt.a,{children:[Object(ie.jsx)(bt.a,{children:"Sl. No."}),i.map((e=>Object(ie.jsx)(bt.a,{children:e},e)))]})}),Object(ie.jsx)(Ot.a,{children:!!a&&a.map(((e,t)=>Object(ie.jsxs)(jt.a,{children:[Object(ie.jsx)(bt.a,{children:t+1}),i.map((t=>Object(ie.jsx)(bt.a,{children:"Date"!==t?e[t]:k()(e[t],"DD-MM-YYYY").format("DD/MM/YYYY")},"".concat(t,"-").concat(e[t]))))]},JSON.stringify(e))))})]})]})})};a(666);var St=function(){const[e,t]=Object(n.useState)(),[a,i]=Object(n.useState)("cash"),[r,s]=Object(n.useState)(""),l=Object(c.b)(),p=Object(c.c)((e=>e.sheet)),{initError:d}=p,h=Object(c.c)((e=>e.trans)),{monthlyCatSplit:u,cashTransData:g,onlineTransData:j,monthlyMaintSplit:b}=h;Object(n.useEffect)((()=>{r&&l(function(e){return t=>{t(Fe());const a=w(e);a.res?t(Ke({...B()})):t(Je(a.error))}}(r))}),[l,r]);const O=Object(n.useCallback)((()=>{g&&j&&(l(dt([...g,...j],{})),i(void 0))}),[g,l,j]),v=Object(n.useCallback)((()=>{if(g&&j){const a=pt([...g,...j],[at["Maintenance Collection"]]);l((e=a,t={},a=>{a(nt()),e.forEach((e=>{const a=e.Flat,n=e.Date,i=e.Category;if(a&&n&&i){const r=k()(n,"DD/MM/YYYY").format("MMM-YY");t||(t={}),t[r]||(t[r]={});let s=parseFloat(e.Credit.toString().replace(/,/g,""));if(i.indexOf("(")>-1){const e=i.match(/Maintenance Collection\s+\((\d+(\.\d+)?)\)/);e&&(s=parseFloat(e[1]))}s&&"number"===typeof s?t[r][a]?t[r][a]+=s:t[r][a]=s:console.log("Flat",a,r,e)}})),a(lt({...t}))})),i(void 0)}var e,t}),[g,l,j]),m=Object(n.useCallback)((()=>{He.updateCategorySheet(u).then((()=>{console.log("Saved"),t("Summary Updated")}))}),[u]),S=Object(n.useCallback)((()=>{He.udpateMaintenanceSheet(b).then((()=>{console.log("Saved"),t("Maintenence Split Updated")}))}),[b]),[A,y]=Object(n.useState)(0),C=Object(n.useMemo)((()=>["Cash Transactions","Online Transactions","Map Transactions","Categorize Maintenance"]),[]),f=Object(n.useCallback)((e=>!1),[]),D=Object(n.useCallback)((e=>!1),[]),x=Object(n.useCallback)((()=>{switch(A){case 3:i(void 0),y(2);break;case 2:i("online"),y(1);break;case 1:i("cash"),y(0)}}),[A]),T=Object(n.useCallback)((()=>{}),[]),E=Object(n.useCallback)((()=>{switch(A){case 0:i("online"),y(1);break;case 1:i(void 0),y(2),O();break;case 2:i(void 0),y(3),v()}}),[A,v,O]);return Object(ie.jsxs)("div",{children:[!!e&&Object(ie.jsx)(o.a,{severity:"info",children:e}),!!d&&Object(ie.jsx)(o.a,{severity:"error",children:d}),Object(ie.jsxs)("div",{className:"stepper-header",children:[Object(ie.jsx)(Re.a,{className:"steps",activeStep:A,children:C.map(((e,t)=>{const a={},n={};return f(t)&&(n.optional=Object(ie.jsx)(Ie.a,{variant:"caption",children:"Optional"})),D(t)&&(a.completed=!1),Object(ie.jsx)(ke.a,{...a,children:Object(ie.jsx)(we.a,{...n,children:e})},e)}))}),Object(ie.jsxs)("div",{className:"nav",children:[Object(ie.jsx)(ne.a,{disabled:0===A,onClick:x,children:"Back"}),f(A)&&Object(ie.jsx)(ne.a,{variant:"contained",color:"primary",onClick:T,children:"Skip"}),Object(ie.jsx)(ne.a,{variant:"contained",color:"primary",onClick:E,children:A===C.length-1?"Save":"Next"})]})]}),Object(ie.jsxs)("div",{className:"control",children:[2===A&&Object(ie.jsx)(ne.a,{variant:"outlined",disabled:!u,onClick:m,children:"Save Categorized"}),"\xa0\xa0\xa0",3===A&&Object(ie.jsx)(ne.a,{variant:"outlined",disabled:!b,onClick:S,children:"Save Split"})]}),!d&&!!p.sheetConfig.secret&&Object(ie.jsxs)(ie.Fragment,{children:[0===A&&Object(ie.jsx)(vt,{}),1===A&&Object(ie.jsx)(mt,{}),2===A&&!!u&&Object(ie.jsx)(Ne.a,{style:Ne.b,data:u}),3===A&&!!b&&Object(ie.jsx)(Ne.a,{style:Ne.b,data:b})]})]})};var At=()=>Object(ie.jsx)(St,{}),yt=a(750);let Ct=function(e){return e.Online="Online",e.Cash="Cash",e}({});function ft(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];t&&0!==t.length||(t=Object.values(at));let a="";const n=[],i=[];return e.split(/[\s_]/m).filter((e=>e&&"/"!==e)).forEach((e=>{/^\d{1,2}-\d{1,2}-\d{2,4}$/.test(e)&&n.push(e),/^\d+(\.\d{1,2})?-?$/.test(e)&&i.push(e)})),a||(a=e.replace(n[0],""),a=a.replace(i[0],"").replace(/_/g,""),a=function(e,t){const a=new Map;e.forEach((e=>{let n=0;const i=e.toLowerCase();t.forEach((e=>{i.includes(e.toLowerCase())&&(n+=1)})),a.set(e,n)}));const n=[...Array.from(a)].sort(((e,t)=>t[1]-e[1]));if(n.length>0&&0!==n[0][1])return n[0][0];return""}(t,[a])||a),{date:n[0],amount:parseFloat(i[0])||0,description:a}}var Dt=a(59);function xt(e){ye(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"").then((t=>{e(t)}))}const Tt=async(e,t)=>{await async function(e,t,a,n){let i={Date:e,Debit:t,Category:a};try{await He.searchUpdateRecord("Online Transactions",i,"Bill",n)}catch(r){i={Debit:t,Category:a},await He.searchUpdateRecord("Online Transactions",i,"Bill",n)}}(e.date,e.amount,e.category||"",Mt(t))};const Et=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Cash Transactions";await He.getSheetByTitle(t)||await He.addSheet({headerValues:["Date","Description","Item Description/Purpose","Qty","Price","Debit","Credit","Total","Category","Flat","Bill"],title:t});const a=JSON.parse(JSON.stringify(e));return await He.updateSheetWithJSON(a,t),!0},Mt=e=>"https://drive.google.com/file/d/".concat(e,"/preview"),Nt=(e,t)=>{var a,n,i;const r={Date:null!==(a=e.date)&&void 0!==a?a:"",Description:null!==(n=e.description)&&void 0!==n?n:"",Debit:null!==(i=e.amount)&&void 0!==i?i:0,Credit:0,Category:e.category,Total:0};return t&&(r.Bill=Mt(t)),r},Rt=(e,t)=>{const a=Nt(e);!a.Description&&t&&(a.Description=t);new Qe($e).run([a]),e.category=a.Category,!e.description&&e.category&&(e.description=e.category)};function It(e,t){let a={};return new Promise((n=>{if(e&&e.indexOf("_")>-1&&(a=ft(e)),a.amount&&a.date&&a.description){const e={...a};Rt(e),n(e)}else kt("https://drive.google.com/uc?id=".concat(t.id)).then((async e=>{var t;if(null!==e&&void 0!==e&&null!==(t=e.data)&&void 0!==t&&t.ParsedResults){var i,r;const t=(null===(i=e.data.ParsedResults[0])||void 0===i?void 0:i.ParsedText)||"",a=await async function(e){const t=B().geminiKey||"",a=new Dt.a(t).getGenerativeModel({model:"gemini-1.0-pro"}),n=[{category:Dt.c.HARM_CATEGORY_HARASSMENT,threshold:Dt.b.BLOCK_MEDIUM_AND_ABOVE},{category:Dt.c.HARM_CATEGORY_HATE_SPEECH,threshold:Dt.b.BLOCK_MEDIUM_AND_ABOVE},{category:Dt.c.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:Dt.b.BLOCK_MEDIUM_AND_ABOVE},{category:Dt.c.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:Dt.b.BLOCK_MEDIUM_AND_ABOVE}],i=a.startChat({generationConfig:{temperature:.9,topK:0,topP:1,maxOutputTokens:2048},safetySettings:n});try{const t=await i.sendMessage("What is the date (dd-mm-YYYY), amount (in number format), description (in short) and 'cash or cheque', extracted from the following text in JSON format?\n".concat(e)),{response:a}=t,n=a.text().replace(/```/g,"").replace(/JSON/gi,""),r=JSON.parse(n);return Array.isArray(r)?r[0]:r}catch(r){console.log(r)}return{amount:0,date:"",description:"","cash or cheque":null}}(t),s={...a,transactionType:"cheque"===(null===(r=a["cash or cheque"])||void 0===r?void 0:r.toLowerCase())?Ct.Online:Ct.Cash};Rt(s,t.toLowerCase()),n(s)}else{const e={...a};Rt(e),n(e)}}))}))}const kt=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;return new Promise(((a,n)=>{(e=>{const t=new FormData;return t.append("url",e),t.append("language","eng"),t.append("isTable","true"),t.append("OCREngine","2"),t.append("filetype","PDF"),Object(ge.a)(ue.a,{retries:3}),ue.a.post("https://api.ocr.space/parse/image",t,{headers:{"Content-Type":"multipart/form-data",apikey:"K84187439488957"},timeout:7500}).catch((e=>{console.error(e)}))})(e).then((async n=>{if(t-=1,n||0===t)a(n);else if(!n){const n=await kt(e,t);a(n)}}))}))};a(336);var wt=e=>{let{bills:t,handleClick:a}=e;return Object(ie.jsx)("div",{children:Object(ie.jsxs)(yt.a,{container:!0,spacing:2,children:[t.map(((e,t)=>Object(ie.jsxs)(yt.a,{item:!0,xs:2,className:"bill-grid-item",onClick:()=>a(e),children:[e.mimeType.startsWith("image/")&&Object(ie.jsx)("img",{src:Mt(e.id),alt:"Bill ".concat(t+1),style:{width:300,height:300,cursor:"pointer",padding:"5px"}}),"application/pdf"===e.mimeType&&Object(ie.jsx)("embed",{src:Mt(e.id),title:"Bill ".concat(t+1),style:{width:300,height:300,cursor:"pointer",padding:"5px"},type:"application/pdf"}),Object(ie.jsx)("h3",{style:{textAlign:"center"},children:e.name})]},"Image ".concat(t+1)))),0===t.length&&Object(ie.jsx)("h4",{className:"no-bills-msg",children:"No bills to display"})]})})},Lt=a(767),_t=a(751),Yt=a(746),Bt=a(738),Ut=a(768),Pt=a(769),Ht=a(747),Ft=a(736),Kt=a(743);var Jt=e=>{let{callback:t,date:a,amount:i,description:r,category:s,image:o,handleClose:c,expenseCategories:l,mimeType:p,transactionType:d}=e;const[h,u]=Object(n.useState)({date:k()(null!==a&&void 0!==a?a:"01-04-2023","DD-MM-YYYY").format("YYYY-MM-DD"),amount:null!==i&&void 0!==i?i:0,description:null!==r&&void 0!==r?r:"text",category:null!==s&&void 0!==s?s:"",transactionType:d}),[g,j]=Object(n.useState)({date:"",amount:"",description:"",category:"",transactionType:""}),b=Object(n.useCallback)((e=>{const{name:t,value:a}=e.target;u((e=>({...e,[t]:a})))}),[]),O=Object(n.useCallback)((()=>{let e=!1;if(h.transactionType||(g.transactionType="Select a transaction type",e=!0),h.amount||(g.amount="Enter a valid amount",e=!0),h.date&&"invalid date"!==h.date.toLowerCase()||(g.date="Enter a valid date",e=!0),h.description||(g.description="Enter a valid description",e=!0),h.category||(g.category="Select a category",e=!0),e)j({...g});else{const e=JSON.parse(JSON.stringify(h));e.date=k()(e.date,"YYYY-MM-DD").format("DD-MM-YYYY"),t(e)}}),[t,g,h]);return Object(ie.jsx)("div",{className:"expense-dialog",children:Object(ie.jsxs)(X.a,{open:!0,onClose:c,className:"bill-grid-dialog",fullWidth:!0,scroll:"paper",maxWidth:"xl",children:[Object(ie.jsx)(Q.a,{children:"Form"}),Object(ie.jsxs)($.a,{children:[p.startsWith("image/")&&Object(ie.jsx)("img",{className:"expense-bill-img",src:Mt(o),alt:"Expense Bill"}),"application/pdf"===p&&Object(ie.jsx)("embed",{className:"expense-bill-img",src:Mt(o),title:"Expense Bill"}),Object(ie.jsxs)("form",{children:[Object(ie.jsxs)(Lt.a,{variant:"outlined",fullWidth:!0,margin:"normal",error:!!g.transactionType,children:[Object(ie.jsxs)(_t.a,{"aria-label":"Transaction Type",name:"transactionType",value:h.transactionType,onChange:b,row:!0,children:[Object(ie.jsx)(Yt.a,{value:"Cash",control:Object(ie.jsx)(Bt.a,{color:"primary"}),label:"Cash"}),Object(ie.jsx)(Yt.a,{value:"Online",control:Object(ie.jsx)(Bt.a,{color:"primary"}),label:"Online"})]}),!!g.transactionType&&Object(ie.jsx)(Ut.a,{children:g.transactionType})]}),Object(ie.jsx)(Pt.a,{type:"date",name:"date",label:"Date",value:h.date,onChange:b,fullWidth:!0,margin:"normal",variant:"outlined",placeholder:"DD-MM-YYYY",error:!!g.date,helperText:g.date}),Object(ie.jsx)(Pt.a,{type:"number",name:"amount",label:"Amount",value:h.amount,onChange:b,fullWidth:!0,margin:"normal",variant:"outlined",error:!!g.amount,helperText:g.amount}),Object(ie.jsx)(Pt.a,{type:"text",name:"description",label:"Description",value:h.description,onChange:b,fullWidth:!0,margin:"normal",variant:"outlined",error:!!g.description,helperText:g.description}),Object(ie.jsxs)(Lt.a,{variant:"outlined",fullWidth:!0,margin:"normal",error:!!g.category,children:[Object(ie.jsx)(Ht.a,{children:"Category"}),Object(ie.jsx)(Ft.a,{name:"category",value:h.category,onChange:b,label:"Category",children:l.map((e=>Object(ie.jsx)(Kt.a,{value:e.key,children:e.label},e.key)))}),!!g.category&&Object(ie.jsx)(Ut.a,{children:g.category})]})]})]}),Object(ie.jsxs)(ae.a,{children:[Object(ie.jsx)(ne.a,{onClick:()=>c(),color:"primary",children:"Cancel"}),Object(ie.jsx)(ne.a,{onClick:O,color:"primary",children:"Submit"})]})]})})};var Wt=e=>{let{folders:t,handleClick:a}=e;const n=t.length?function(e){const t={APR:1,MAY:2,JUN:3,JUL:4,AUG:5,SEP:6,OCT:7,NOV:8,DEC:9,JAN:10,FEB:11,MAR:12};return e.sort(((e,a)=>t[e.name.toUpperCase()]-t[a.name.toUpperCase()])),e}(t):[];return Object(ie.jsx)("div",{children:Object(ie.jsx)(yt.a,{container:!0,spacing:2,children:n.map(((e,t)=>Object(ie.jsxs)(yt.a,{item:!0,xs:2,onClick:()=>a(e.id),children:[Object(ie.jsx)("img",{src:"/images/folder.jpg",id:"folder-".concat(e.name),alt:"Folder ".concat(t+1),style:{width:200,height:200,cursor:"pointer",padding:"5px"}}),Object(ie.jsx)("h3",{style:{textAlign:"center"},children:e.name})]},"Image ".concat(t+1))))})})};class Vt{constructor(){this.initProm=void 0,this.sheetIntialized=!1,this.sheets=new Map,this.initProm=He.init(),this.initProm.then((()=>{this.sheetIntialized=!0}))}async getSheet(e){return this.sheetIntialized||await this.initProm,new Promise(((t,a)=>{this.sheets.has(e)?t(this.sheets.get(e)):He.getSheetByTitle(e).then((n=>{n?(this.sheets.set(e,n),t(n)):a()}))}))}async getExpenseCategories(){return new Promise(((e,t)=>{let a=[];this.getSheet("Summary").then((t=>{const n=He.getColumnWithSheet(t,0).map((e=>e.value)),i=[];for(let e=1;e<n.length-1&&"Total Expense"!==n[e];e+=1)i.push(n[e]),a=i.map((e=>({key:e,label:e})));e(a)}))}))}async parseMonthlySheet(e){return(await e.getRows()).map((e=>({Date:k()(e.Date,"DD/MM/YYYY").toDate(),Description:e.Desc,"Cheque No":e.ChqNo,Debit:parseFloat(e.Amount)<0?parseFloat(e.Amount):0,Credit:parseFloat(e.Amount)>=0?parseFloat(e.Amount):0,Total:parseFloat(e.Balance),type:e.Type})))}getMonthData(e){return new Promise(((t,a)=>{this.getSheet(e).then((async e=>{const a=await this.parseMonthlySheet(e);t(a)})).catch((()=>{He.addSheet({headerValues:["Date","Desc","ChqNo","Amount","Type","Balance"],title:e}).then((a=>{this.sheets.set(e,a),t([])}))}))}))}pushSheetData(e,t){t.push({Date:k()(e.Date).format("DD-MM-YYYY"),Desc:e.Description,Balance:e.Total,Amount:e.Credit-e.Debit,ChqNo:e["Cheque No"],Type:e.type})}transCompare(e,t){return k()(e.Date).format("DD/MM/YYY")===k()(t.Date).format("DD/MM/YYY")&&e.Description===t.Description&&e.Debit===t.Debit&&e.Credit===t.Credit&&e.type===t.type}async mergeSheetData(e,t){const{transactions:a}=B().appData,n=[];return t.length>0?(a.forEach((e=>{-1===t.findIndex((t=>this.transCompare(t,e)))&&this.pushSheetData(e,n)})),t.forEach((e=>{-1===a.findIndex((t=>this.transCompare(t,e)))&&a.push(e)}))):a.forEach((e=>this.pushSheetData(e,n))),n.length&&await e.addRows(n),!0}async setMonthData(e){const t=await this.getMonthData(e),a=await this.getSheet(e);return await this.mergeSheetData(a,t),!0}}new Vt,a(668);function Gt(){const[e,t]=Object(n.useState)(!1),[a,i]=Object(n.useState)([]),[r,s]=Object(n.useState)(!1),[o,c]=Object(n.useState)(),[l,p]=Object(n.useState)(""),[d,h]=Object(n.useState)({date:"",amount:0,description:"",category:""}),u=Object(n.useCallback)((e=>{p(e)}),[]),g=Object(n.useCallback)((async e=>{c(e),t(!0);const n=a.find((t=>t.id===e.id)),i=null===n||void 0===n?void 0:n.name,r=await It(i,e);t(!1),h(r),s(!0)}),[a]),j=Object(n.useCallback)((e=>{if(o&&null!==e&&void 0!==e&&e.date){const t=a.find((e=>e.id===o.id));o&&t&&Ce(o.id,t.name).then((()=>{if(xt(i,l),e.transactionType===Ct.Cash){const t=[Nt(e,o.id)];Et(t)}else Tt(e,o.id)}))}c(void 0),s(!1)}),[a,o,l]);Object(n.useEffect)((()=>{xt(i,l)}),[l]);const[b,O]=Object(n.useState)([]);Object(n.useEffect)((()=>{(async()=>{const e=new Vt,t=await e.getExpenseCategories();O(t)})()}),[]);const v=Object(n.useMemo)((()=>a.filter((e=>(e.mimeType.startsWith("image/")||"application/pdf"===e.mimeType)&&!e.name.startsWith(Se)))),[a]),m=Object(n.useMemo)((()=>a.filter((e=>"application/vnd.google-apps.folder"===e.mimeType))),[a]);return Object(ie.jsxs)("div",{className:"bill-workspace",children:[Object(ie.jsx)("h3",{children:"Unprocessed Bills"}),!!l&&Object(ie.jsx)(ne.a,{className:"go-to-months-btn",size:"small",variant:"outlined",onClick:()=>p(""),children:"Go Back"}),!l&&Object(ie.jsx)(Wt,{folders:m,handleClick:u}),!!l&&Object(ie.jsx)(wt,{bills:v,handleClick:g}),!!o&&r&&Object(ie.jsx)(Jt,{...d,image:o.id,mimeType:o.mimeType,callback:j,handleClose:j,expenseCategories:b}),e&&Object(ie.jsx)("div",{className:"overlay",children:Object(ie.jsx)(ht.a,{})})]})}var qt=a(354);a(669);var zt=e=>{const[t,a]=Object(n.useState)(),i=Object(n.useCallback)((t=>{e.onUpload(t)}),[e]),r=Object(n.useCallback)((e=>{a(e)}),[]);return Object(ie.jsxs)(ie.Fragment,{children:[t&&Object(ie.jsx)(o.a,{severity:"error",children:t}),Object(ie.jsx)("p",{children:"Upload a transaction file (.xls) to process."}),Object(ie.jsx)("div",{className:"file-upload-wrapper",children:Object(ie.jsx)(qt.FilePicker,{extensions:["xls","xlsx"],onChange:i,onError:r,children:Object(ie.jsx)("button",{type:"button",children:"Upload"})})})]})},Zt=a(196),Xt=a.n(Zt);const Qt="__EMPTY_",$t="2",ea="5",ta="9",aa="12",na="17",ia=["21","19","20","22"],ra={parseXLS:e=>new Promise((t=>{const a=new FileReader;a.onload=e=>{const a=Xt.a.read(e.target.result,{type:"binary"}),n=a.Sheets[a.SheetNames[0]],i=Xt.a.utils.sheet_to_json(n),r=ra.parseTransactions(i);t(r)},a.readAsBinaryString(e)})),parseAmount:e=>{let t;return t="string"===typeof e?parseFloat(e.replace("Cr","").replaceAll(",","")):e,t},getWorkingColumnKeyFromArray:(e,t)=>e.find((e=>!!t["".concat(Qt).concat(e)])),parseTransactions:e=>{let t=[];if(e.length){const a="".concat(Qt).concat($t),n=e.filter((e=>e[a]&&10===e[a].length&&e[a].includes("/")&&"Invalid Date"!==k()(e[a],"dd/MM/YYYY").toDate().toString()));let i=ra.getWorkingColumnKeyFromArray(ia,n[0])||"";const r="".concat(Qt).concat(ea),s="".concat(Qt).concat(ta);i="".concat(Qt).concat(i),t=n.map((e=>{const t={Date:k()(e[a],"DD/MM/YYYY").toDate(),Description:e[r],"Cheque No":e[s]||"",Debit:0,Credit:0,Total:ra.parseAmount(e[i]),type:"ONLINE"};return e["".concat(Qt).concat(aa)]&&(t.Debit=ra.parseAmount(e["".concat(Qt).concat(aa)])),e["".concat(Qt).concat(na)]&&(t.Credit=ra.parseAmount(e["".concat(Qt).concat(na)])),t}))}return t}};var sa=ra,oa=a(771),ca=a(749);a(673);var la=e=>{const{xlsData:t,name:a}=e,i=Object(n.useMemo)((()=>{const e={};return t.forEach((t=>{const a=k()(t.Date).format("MMM-YY");e[a]=a})),e}),[t]),r=Object.values(i),[s,o]=Object(n.useState)(1===r.length?r[0]:""),{appData:c}=Object(n.useContext)(P);c.transSheetMonth=s;Object(n.useCallback)((e=>{e.target.value&&(c.transSheetMonth=e.target.value,o(e.target.value))}),[c]);let l=t;s&&(l=t.filter((e=>k()(e.Date).format("MMM-YY")===s)),c.transactions=l);Object(n.useCallback)((()=>{}),[]);return Object(ie.jsxs)(ie.Fragment,{children:[Object(ie.jsx)("div",{className:"preview-header",children:Object(ie.jsxs)("div",{children:["File: ",Object(ie.jsx)("h4",{children:a})]})}),Object(ie.jsx)(oa.a,{className:"xls-file-preview",component:ca.a,children:Object(ie.jsxs)(ut.a,{size:"small",stickyHeader:!0,"aria-label":"Parsed Bank Transactions",children:[Object(ie.jsx)(gt.a,{children:Object(ie.jsxs)(jt.a,{children:[Object(ie.jsx)(bt.a,{children:"#"}),Object(ie.jsx)(bt.a,{children:"Date"}),Object(ie.jsx)(bt.a,{children:"Description"}),Object(ie.jsx)(bt.a,{align:"right",children:"Cheque No."}),Object(ie.jsx)(bt.a,{align:"right",children:"Debit"}),Object(ie.jsx)(bt.a,{align:"right",children:"Credit"}),Object(ie.jsx)(bt.a,{align:"right",children:"Total"})]})}),Object(ie.jsx)(Ot.a,{children:l.map(((e,t)=>Object(ie.jsxs)(jt.a,{children:[Object(ie.jsx)(bt.a,{component:"th",scope:"row",children:t+1}),Object(ie.jsx)(bt.a,{component:"th",scope:"row",children:k()(e.Date).format("DD-MM-YYYY")}),Object(ie.jsx)(bt.a,{children:e.Description}),Object(ie.jsx)(bt.a,{align:"right",children:e["Cheque No"]}),Object(ie.jsx)(bt.a,{align:"right",children:e.Debit}),Object(ie.jsx)(bt.a,{align:"right",children:e.Credit}),Object(ie.jsx)(bt.a,{align:"right",children:e.Total})]},e.Description)))})]})})]})};var pa=function(e){const{data:t}=e,[a,i]=Object(n.useState)("");Object(n.useEffect)((()=>{He.init()}),[]);const r=Object(n.useCallback)((async()=>{const e="Online Transactions";await He.getSheetByTitle(e)||await He.addSheet({headerValues:["Date","Description","Cheque No","Debit","Credit","Total","Category","Flat"],title:e});const a=JSON.parse(JSON.stringify(t)).map((e=>(e.Date=k()(e.Date).format("DD-MM-YYYY"),e)));await He.updateSheetWithJSON(a,e),i("Sheet Updated")}),[t]);return Object(ie.jsxs)(ie.Fragment,{children:[Object(ie.jsx)("p",{children:a}),Object(ie.jsx)("div",{className:"tools",children:Object(ie.jsx)(ne.a,{variant:"outlined",onClick:r,children:"Save Sheet"})})]})};a(674);var da=()=>{const{sheetConfig:e}=Object(c.c)((e=>e.sheet)),[t,a]=Object(n.useState)(""),[i,r]=Object(n.useState)(0),[s,l]=Object(n.useState)(""),[p,d]=Object(n.useState)([]),h=Object(n.useCallback)((t=>{l(t.name),sa.parseXLS(t).then((t=>{e.appData.transactions=t,t.reverse(),d(t),a(""),r(1)}))}),[e.appData]),u=Object(n.useCallback)((e=>{switch(e){case 0:return Object(ie.jsx)(zt,{onUpload:h});case 1:return Object(ie.jsx)(la,{name:s,xlsData:p});case 2:return Object(ie.jsx)(pa,{data:p});default:return"Unknown step"}}),[p,h,s]),[g,j]=Object(n.useState)(new Set),b=["File Upload","File Preview","Save"],O=Object(n.useCallback)((e=>g.has(e)),[g]),v=Object(n.useCallback)((async()=>{let e=g;if(O(i)&&(e=new Set(e.values()),e.delete(i)),0===i)s?(r((e=>e+1)),a("")):a("Select a file.");else r((e=>e+1)),a("");j(e)}),[i,s,O,g]),m=Object(n.useCallback)((()=>{r(0)}),[]);return Object(ie.jsxs)("div",{className:"wizard",children:[t&&Object(ie.jsx)(o.a,{severity:"error",children:t}),Object(ie.jsxs)("div",{children:[Object(ie.jsx)(Re.a,{activeStep:i,children:b.map(((e,t)=>{const a={},n={};return O(t)&&(a.completed=!1),Object(ie.jsx)(ke.a,{...a,children:Object(ie.jsx)(we.a,{...n,children:e})},e)}))}),Object(ie.jsxs)("div",{children:[i===b.length&&Object(ie.jsxs)("div",{children:[Object(ie.jsx)(Ie.a,{children:"All steps completed - you're finished"}),Object(ie.jsx)(ne.a,{onClick:m,children:"Reset"})]}),i!==b.length&&Object(ie.jsxs)("div",{children:[Object(ie.jsx)(Ie.a,{children:u(i)}),Object(ie.jsxs)("div",{children:[Object(ie.jsx)(ne.a,{disabled:0===i,onClick:()=>{r((e=>e-1))},children:"Back"}),!1,Object(ie.jsx)(ne.a,{variant:"contained",color:"primary",onClick:v,children:i===b.length-1?"Save":"Next"})]})]})]})]})]})};var ha=()=>Object(ie.jsx)(da,{}),ua=a(772),ga=a(773),ja=a(355),ba=a.n(ja);a(675);var Oa=()=>{const[e,t]=Object(n.useState)(""),[a,i]=Object(n.useState)(""),[r,s]=Object(n.useState)(""),[o,c]=Object(n.useState)(""),l=Object(n.useCallback)((e=>{const a=e.target.value;t(a);const n=((e,t)=>R.a.AES.encrypt(e,null!==t&&void 0!==t?t:Y.secret).toString())(a);var r,o;i(n),s((r=n,R.a.AES.decrypt(r,null!==o&&void 0!==o?o:Y.secret).toString(R.a.enc.Utf8)))}),[]),p=Object(n.useCallback)((()=>{navigator.clipboard.writeText(a),c("Encrypted value copied to clipboard!"),setTimeout((()=>{c("")}),3e3)}),[a]),d=Object(n.useMemo)((()=>{let t=Object(ie.jsx)(ie.Fragment,{children:"Decrypted Value"});return e===r&&(t=Object(ie.jsxs)(ie.Fragment,{children:["Decrypted Value ",Object(ie.jsx)(ba.a,{className:"encrypt-check"})," "]})),t}),[r,e]);return Object(ie.jsxs)(ua.a,{maxWidth:"sm",children:[Object(ie.jsx)(Ie.a,{variant:"h4",gutterBottom:!0,children:"Key Encryption"}),Object(ie.jsx)(Pt.a,{label:"Enter Key",variant:"outlined",fullWidth:!0,margin:"normal",value:e,onChange:l}),a&&Object(ie.jsxs)(ga.a,{marginTop:"20px",children:[Object(ie.jsx)(Pt.a,{label:"Encrypted Value",variant:"outlined",fullWidth:!0,margin:"normal",value:a,InputProps:{readOnly:!0},onClick:p}),o&&Object(ie.jsx)(Ie.a,{variant:"body2",color:"primary",children:o})]}),r&&Object(ie.jsx)(ga.a,{marginTop:"20px",children:Object(ie.jsx)(Pt.a,{label:d,variant:"outlined",fullWidth:!0,margin:"normal",value:r,InputProps:{readOnly:!0}})})]})};var va=function(){return Object(ie.jsx)(Oa,{})};var ma=function(){return Object(ie.jsx)(se.c,{children:Object(ie.jsxs)(se.a,{children:[Object(ie.jsx)(se.a,{path:"/",element:Object(ie.jsx)(ha,{})}),Object(ie.jsx)(se.a,{path:"/cat",element:Object(ie.jsx)(At,{})}),Object(ie.jsx)(se.a,{path:"/bills",element:Object(ie.jsx)(Gt,{})}),Object(ie.jsx)(se.a,{path:"/cash",element:Object(ie.jsx)(Me,{})}),Object(ie.jsx)(se.a,{path:"/gen-key",element:Object(ie.jsx)(va,{})})]})})};a(676);var Sa=function(){const[e,t]=Object(n.useState)(""),[a,i]=Object(n.useState)(""),[r,l]=Object(n.useState)(!!B().secret);Object(n.useEffect)((()=>{if(a){w(a).res?(t(""),l(!0)):(t("Wrong secret. Enter it again."),i(""))}}),[a]);const[d,u]=Object(n.useState)(!1);return Object(ie.jsx)(c.a,{store:Z,children:Object(ie.jsxs)(s.a,{children:[Object(ie.jsxs)("header",{className:"app-header",children:[Object(ie.jsx)("img",{src:"/images/ssfa.png",alt:"Suraksha Sunflower Apartment",width:"80px",height:"60px"}),Object(ie.jsx)("span",{children:"Suraksha Sunflower "})]}),Object(ie.jsxs)("div",{className:"app",children:[Object(ie.jsxs)(C.c,{collapsed:d,children:[Object(ie.jsxs)(C.a,{children:[Object(ie.jsx)(C.b,{icon:Object(ie.jsx)(b.a,{}),title:"Parse Online Transactions",children:Object(ie.jsx)(s.b,{to:"/",children:"Parse Online Transactions"})}),Object(ie.jsx)(C.b,{icon:Object(ie.jsx)(g.a,{}),title:"Categorize Transactions",children:Object(ie.jsx)(s.b,{to:"/cat",children:"Categorize Transactions"})}),Object(ie.jsx)(C.b,{icon:Object(ie.jsx)(y.a,{}),title:"Upload Bills",children:Object(ie.jsx)(s.b,{to:"/bills",children:"Upload Bills"})}),Object(ie.jsx)(C.b,{icon:Object(ie.jsx)(v.a,{}),title:"Cash Transactions",children:Object(ie.jsx)(s.b,{to:"/cash",children:"Cash Transactions"})}),Object(ie.jsx)(C.b,{icon:Object(ie.jsx)(S.a,{}),title:"Generate Encrypted Keys",children:Object(ie.jsx)(s.b,{to:"/gen-key",children:"Encrypt Keys"})})]}),Object(ie.jsxs)("div",{className:"sb-footer",children:[!d&&Object(ie.jsx)(p.a,{onClick:()=>u(!0)}),d&&Object(ie.jsx)(h.a,{onClick:()=>u(!1)})]})]}),Object(ie.jsxs)("div",{className:"workspace",children:[e&&Object(ie.jsx)(o.a,{severity:"error",children:e}),!r&&Object(ie.jsx)(re,{errorMsg:e,handleSecret:i}),r&&Object(ie.jsx)(ma,{})]})]})]})})};a(677);const Aa=document.getElementById("root");Object(r.createRoot)(Aa).render(Object(ie.jsx)(i.a.StrictMode,{children:Object(ie.jsx)(Sa,{})}));t.default={}}},[[678,1,2]]]);
//# sourceMappingURL=main.c92800a5.chunk.js.map