(this["webpackJsonpflat-maintenance"]=this["webpackJsonpflat-maintenance"]||[]).push([[0],{206:function(e,t){},331:function(e,t){},349:function(e,t,n){},425:function(e,t){},427:function(e,t){},468:function(e,t){},470:function(e,t){},502:function(e,t){},504:function(e,t){},505:function(e,t){},510:function(e,t){},512:function(e,t){},518:function(e,t){},520:function(e,t){},539:function(e,t){},551:function(e,t){},554:function(e,t){},602:function(e,t){},627:function(e,t,n){},630:function(e,t){},631:function(e,t){},632:function(e,t,n){},633:function(e,t,n){},635:function(e,t,n){},666:function(e,t,n){},667:function(e,t,n){},690:function(e,t,n){},692:function(e,t,n){},693:function(e,t,n){"use strict";n.r(t);var a,r=n(0),i=n.n(r),c=n(25),o=n.n(c),s=n(10),u=n(116),l=n(44),p=n(385),d=n.n(p),h=n(386),b=n.n(h),j=n(382),f=n.n(j),v=n(381),O=n.n(v),g=n(788),m=n(384),S=n.n(m),y=n(383),A=n.n(y),x=n(81),D=n(111),C=n(369),k=n(7);!function(e){e.LOAD_TRANS="LOAD_TRANS",e.LOAD_CASH_TRANS_SUCCESS="LOAD_CASH_TRANS_SUCCESS",e.LOAD_ONLINE_TRANS_SUCCESS="LOAD_ONLINE_TRANS_SUCCESS",e.LOAD_CASH_TRANS_FAILURE="LOAD_CASH_TRANS_FAILURE",e.LOAD_ONLINE_TRANS_FAILURE="LOAD_ONLINE_TRANS_FAILURE",e.UPDATE_MONTHLY_SPLIT="UPDATE_MONTHLY_SPLIT",e.RESET_MONTHLY_SPLIT="RESET_MONTHLY_SPLIT",e.UPDATE_MONTHLY_MAINT_SPLIT="UPDATE_MONTHLY_MAINT_SPLIT",e.RESET_MONTHLY_MAINT_SPLIT="RESET_MONTHLY_MAINT_SPLIT",e.RESET_TRANS="RESET_TRANS"}(a||(a={}));var T={loading:!1,cashTransData:void 0,onlineTransData:void 0,monthlyCatSplit:void 0,error:""},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case a.LOAD_TRANS:return Object(k.a)(Object(k.a)({},e),{},{loading:!0});case a.LOAD_CASH_TRANS_SUCCESS:return Object(k.a)(Object(k.a)({},e),{},{loading:!1,cashTransData:t.payload,error:""});case a.LOAD_ONLINE_TRANS_SUCCESS:return Object(k.a)(Object(k.a)({},e),{},{loading:!1,onlineTransData:t.payload,error:""});case a.LOAD_CASH_TRANS_FAILURE:return Object(k.a)(Object(k.a)({},e),{},{loading:!1,cashTransData:void 0,error:t.payload});case a.LOAD_ONLINE_TRANS_FAILURE:return Object(k.a)(Object(k.a)({},e),{},{loading:!1,onlineTransData:void 0,error:t.payload});case a.UPDATE_MONTHLY_SPLIT:return Object(k.a)(Object(k.a)({},e),{},{monthlyCatSplit:t.payload,loading:!1});case a.RESET_MONTHLY_SPLIT:return Object(k.a)(Object(k.a)({},e),{},{monthlyCatSplit:void 0});case a.UPDATE_MONTHLY_MAINT_SPLIT:return Object(k.a)(Object(k.a)({},e),{},{monthlyMaintSplit:t.payload,loading:!1});case a.RESET_MONTHLY_MAINT_SPLIT:return Object(k.a)(Object(k.a)({},e),{},{monthlyMaintSplit:void 0});case a.RESET_TRANS:return T;default:return e}},M=n(368),N=n(69),w=n.n(N),I=n(27),R=n.n(I),L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t={res:!1,error:""};if(e){var n=w.a.AES.decrypt(H.ENC_CLIENT_EMAIL,e),a=w.a.AES.decrypt(H.ENC_PRIVATE_KEY,e),r=w.a.AES.decrypt(H.ENC_CHAT_GPT_KEY,e),i=w.a.AES.decrypt(H.ENC_GOOGLE_API_KEY,e);try{H.clientEmail=n.toString(w.a.enc.Utf8),H.privateKey=a.toString(w.a.enc.Utf8),H.googleAPIKey=i.toString(w.a.enc.Utf8),H.secret=e,H.chatGPTPrivateKey=r.toString(w.a.enc.Utf8),sessionStorage.setItem("session-id",e),t.res=!0}catch(c){H.secret="",t.res=!1,t.error="Invalid Secret Provided"}}else H.secret="",t.res=!1,t.error="Empty Secret Set";return t},B=["001","002","003","004","005","007","008","009","010","011","012","101","102","103","104","105","106","107","108","109","110","111","112","201","202","203","204","205","206","207","208","209","210","211","212","301","302","303","304","305","306","307","308","309","310","311","312","401","402","403","404","405","406","407","408","409","410","411","412"],Y={transCategories:[{key:"maintenance",label:"Maintenance",children:B.map((function(e){return{key:"maintenance-".concat(e),label:e}}))},{key:"corpus",label:"Corpus Fund",children:B.map((function(e){return{key:"corpus-".concat(e),label:e}}))},{key:"monthly",label:"Monthly Expenses",children:[]},{key:"others",label:"Others",children:[{key:"fine",label:"Fine"},{key:"extra",label:"Other Income"},{key:"account-transfer",label:"FD Deposit"},{key:"tenant-deposit",label:"Tenant Deposit"},{key:"rd-deposit",label:"Deposit to RD account"}]}],transactionFinYear:R()().format("YY"),transSheetMonth:"",transactions:[]},H={secret:sessionStorage.getItem("session-id")||"",SPREADSHEET_ID:"16Q4fGH3MHV4yFZn-Ws0tDpz57hXLjOE_wDSXilJCDZ0",ENC_CLIENT_EMAIL:"U2FsdGVkX19lrOkAqkI1YRZkdHSjXZc+dtJNUzOhSlqaydB6Gxi4lm9MpS7+2/W7OtInfOCmh739buu1z1jzT/jJrAeRX2+hKkxc+3qsduw=",ENC_PRIVATE_KEY:"U2FsdGVkX1/i7T93uNMkvtV/hIYkButYpbgdWdXVf4ftrMUIjGc7OmaZRamJzAZNh3HKcvAW92t+mtWkIpJ2sLzLlB0BWWbBTZDPl+C/oD1YCcDZYCCPaHOcSvedvzBXLP3lGDi61mXPqPPGMDquh90g7oKvO8w+Oe6JIV8HQ9EYYB/rd/IRj34CP9K96NQDxcy06xsL2SfMMQuqSyBwRYYebogb4NZgpjfSKx6AJCvRnHkZMGBt2E0xtGm1UmS+XLq1Dlay8s2fJAYuF4yxSMjJpCzhOdTY0rhbTIQ8D3kZvJJU9+MCS4yqsVBCdqkWRqoQBBhHk8vSwb8ZTcomRUg4w6JDOu+HCT4vA6x5Jz8aSYu0CxZKndd4gHXy55YklnC728IKDavaEC13bNG/OrsBQL8P0IjzuomEAiQdFpdoQg81JmANZx1MbGD8NvdmuNEGzkTLPEssID5pO1AzGCepSeikWB8XXkJu+kHLGQe6SyBE7oxv5SDfeexWfkGOObo2Af9VbtZwg+jlVgKzf0lBj9NW0soC15VrpzV4t7oUpMT3Fe6d3oijHQ2hPxTYZMfuA8UsyO3WSTUbaxNWOpUbijJsDSUpENGQyr1XFSV4+3aN78prPt443BiaHAm8i50y9z2P7TJJteRrRE900MBm/9sMRK3fZb91VUJ9wsvmzRsJK7cxxBStx7T1k3wxQZCJisWXej+vqRlP0le95yB/2BikMV+nYyom4gQrySk8eW2rzvx26LS3LHf867SdpXSWzT7RBdIhxd6IXsK8B/fIjmR6zpeqMb/LUjRm4LcTn3UZgKEYDEFmgRGR07lsTP1czidqjCuOn+o9mZblzbsMFFAFzPhaj0ZKcO82vs3bHkDGIfoaN+EimD1ThwxlEehX08EOOKNLp19sxpUcwaxjbRgwunMh0o7J/H92TpsppRJJRfUEsI/ReI021yqkpiqRZcI/cEn3NykY1MualaqkuddoKqeD2LKjOmxaT26niNSsd/ffhjBD5f1DCWq84iXQaje6SIV1ZwesIUbUUG7MSTHI6Mf3LZuWIK/HQU/MhSYYtIHv7rvcJUyw0e/ZnUfKBRgyMYSLeTZI55MYPJ0HUGPJWIWnYMk8ESLBLnPnDknXo2m1i87Y37ui3Snqy7s6WW6nYlz1/HPexx/HQaQl5UsRGNre6+RREonqmL+B+AITWlN+bA4iLOnYfCg8OdyACDWBge3fwxduWWB4vtzlDNMx/Xqcb52BZAAh6d6Z7AE3t66ZfHv16VZnEEm14uV+zBgt41Mkfv0LNFZ6cqOjafwioFnMO9e3j738n2xwKMzcMzsdnhmHkyF7i7PLZqbTBp8P167/psPnfUV8vfcsmTombUUzOzViqJABfG6EczwhN19dd4lusGVDNrz43ywTA5zfU/jMcy1wk7i90rXo0HZSNNOuLGog2+qlx2xuyHORqdEVshb0BeJYckX95zjXLu6BuTO66vp4oIzecv9vprH3Jfx67mRvKKa+8xExXlY0BDM7vND5+EAZ0wz71MJonVjx/cXHqrSDxcnU1x5BJLAgZliQDZk/lAxBbUSuqvF21NBvZWGk2rDRKr5rTibBRDeOGoTQW1kRus87/YPBvThJ2OlFHkEAYskLyk8xPFTeC2XUJCEF7K6U3UpjL7LLWoCP+KcwazlItikvTzR44AAf2iFRf0+6wVQLZjpHZed0Z7KchTDyCm0ydVHuMAJjpogPjUbj26tbiICQ9SRtO+keG+JUHElkQzOe0bfsTuw8CqwPm6C1hNL9ReYYxrbwAwrZU8si4RWE1qSJ3cQXrxIOP275Uvsr5eUlgWYdJBrrYGUOjvQupB5CX9JL9SuH8Rfml2NzrMLWMM5mT9R1amUKLcl2ZyLkC4NDEmeqxPMtRtPLlQA/1aH939OdMbR5OZ9ozlSZFGiSS1eucvK44xvI4KCbFARx+urxXQgTSmZd/GwcFc5ZZXlojU8DTgQc5HTijP2x8iMptYYK/iPz2brWPs7LZsOiBaKCsbzWGdu/Lo3xJRqZoS5x7jGNl2q0JCj9/a0m7v+ODEZ6LaAQwsKX6M5iqNQ0YQWzlMClB6i1shbbrLsqtACXovqx9ACssZMVt7U9/WlDnmpjV+QT5Duhx8WBKehO2CeL2W9ZO8TtW+YDsV0mytvkXPwMl2RwMSAoNVau7b4CrU67z8BEVFcRKGHIURXxN/vithCvLR7Kk8+37cF16NOLBu1t6uixXH+0371xj74wJf7RFeeceyeZvGDrAsJ5qRvqD+vsAjl3EGUJySw1BJryedcR",ENC_GOOGLE_API_KEY:"U2FsdGVkX1+z10t9/VGkdh+xgB9JO7TwDIGpiW5ivAoQrmKV9c77947cJH49fTgzZcc5DSaLNH1jlCpIiLbSuw==",ENC_CHAT_GPT_KEY:"U2FsdGVkX19CE/c8Tng+qxPTykma92uBwnVA8hVNUPhl5desREv8awMfLxjN2ZnKC23rEB6XcYTSzVfgEwgEqQPZuhXq3Ef0cng56m8DqyI=",doc:new M.GoogleSpreadsheet("16Q4fGH3MHV4yFZn-Ws0tDpz57hXLjOE_wDSXilJCDZ0"),appData:Y};H.secret&&L(H.secret);var _,P=i.a.createContext(H);!function(e){e.all="All Transaction",e.mapped="Only Mapped",e.unmapped="Only Unmapped"}(_||(_={}));var U,F=P;!function(e){e.INIT="INIT",e.INIT_SUCCESS="GET_SHEET_INFO",e.INIT_FAILURE="GET_SHEET_INFO_FAILURE",e.SET_SHEET_INFO="SET_SHEET_INFO"}(U||(U={}));var K,J=U,W={initError:"",sheetConfig:H,sheetInfo:new Map},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case J.INIT:return Object(k.a)(Object(k.a)({},e),{},{initializing:!0});case J.INIT_SUCCESS:return Object(k.a)(Object(k.a)({},e),{},{initializing:!1,appConfig:t.payload});case J.INIT_FAILURE:return Object(k.a)(Object(k.a)({},e),{},{initializing:!1,initError:t.payload});case J.SET_SHEET_INFO:return Object(k.a)(Object(k.a)({},e),{},{sheetInfo:t.payload});default:return e}},G=n(30);!function(e){e.INIT="INIT",e.SUCCESS="SUCCESS",e.FAILURE="FAILURE",e.SET_CONFIG="SET_CONFIG",e.ADD_EVENTS="ADD_EVENTS"}(K||(K={}));var q,z={isLoading:!1,data:{},config:{encBotId:"U2FsdGVkX1/0gDV/ibea6VfAgozs8tNyWPB0zt3iRLDsNORNjxOhmloQXZl7ywLjxeQl4Bmxe3iZ7RLdUxi+BA==",listURL:"https://state-tourniquet.000webhostapp.com/suraksha/telegram/get.php",fetchURL:"https://api.telegram.org/bot{{botId}}/getFile?file_id={{fileId}}",downloadURL:"https://api.telegram.org/file/bot{{botId}}/photos/{{filePath}}",updateURL:"https://state-tourniquet.000webhostapp.com/suraksha/telegram/processed.php?id={{recordId}}"},layoutData:void 0,events:[]},Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case K.INIT:return Object(k.a)(Object(k.a)({},e),{},{isLoading:!0,layoutData:t.payload});case K.SUCCESS:return Object(k.a)(Object(k.a)({},e),{},{isLoading:!1,data:t.payload,error:void 0});case K.FAILURE:return Object(k.a)(Object(k.a)({},e),{},{isLoading:!1,data:void 0,error:t.payload});case K.SET_CONFIG:return Object(k.a)(Object(k.a)({},e),{},{config:t.payload});case K.ADD_EVENTS:return Object(k.a)(Object(k.a)({},e),{},{events:[].concat(Object(G.a)(e.events),[t.payload])});default:return e}},X=Object(D.b)({sheet:V,trans:E,bills:Z}),Q=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||D.c,$=Object(D.d)(X,Q(Object(D.a)(C.a))),ee=n(8),te=n(14),ne=n(767),ae=n(794),re=n(795),ie=n(775),ce=n(790),oe=n(774),se=n(389),ue=n(370),le=(n(627),n(2)),pe=function(e){var t=Object(r.useState)(),n=Object(s.a)(t,2),a=n[0],i=n[1],c=Object(r.useCallback)((function(t){e.onUpload(t)}),[e]),o=Object(r.useCallback)((function(e){i(e)}),[]);return Object(le.jsxs)(le.Fragment,{children:[a&&Object(le.jsx)(g.a,{severity:"error",children:a}),Object(le.jsx)("p",{children:"Upload a transaction file (.xls) to process."}),Object(le.jsx)("div",{className:"file-upload-wrapper",children:Object(le.jsx)(ue.FilePicker,{extensions:["xls","xlsx"],onChange:c,onError:o,children:Object(le.jsx)("button",{type:"button",children:"Upload"})})})]})},de=n(218),he=n.n(de),be="__EMPTY_",je="1",fe="3",ve="9",Oe="11",ge="17",me=["22","20","21"],Se={parseXLS:function(e){return new Promise((function(t){var n=new FileReader;n.onload=function(e){var n=he.a.read(e.target.result,{type:"binary"}),a=n.Sheets[n.SheetNames[0]],r=he.a.utils.sheet_to_json(a),i=Se.parseTransactions(r);t(i)},n.readAsBinaryString(e)}))},parseAmount:function(e){return"string"===typeof e?parseFloat(e.replace("Cr","").replaceAll(",","")):e},getWorkingColumnKeyFromArray:function(e,t){return e.find((function(e){return!!t["".concat(be).concat(e)]}))},parseTransactions:function(e){var t=[];if(e.length){var n="".concat(be).concat(je),a=e.filter((function(e){return e[n]&&10===e[n].length&&e[n].includes("/")&&"Invalid Date"!==R()(e[n],"dd/MM/YYYY").toDate().toString()})),r=Se.getWorkingColumnKeyFromArray(me,a[0])||"",i="".concat(be).concat(fe),c="".concat(be).concat(ve);r="".concat(be).concat(r),t=a.map((function(e){var t={Date:R()(e[n],"DD/MM/YYYY").toDate(),Description:e[i],"Cheque No":e[c]||"",Debit:0,Credit:0,Total:Se.parseAmount(e[r]),type:"ONLINE"};return e["".concat(be).concat(Oe)]&&(t.Debit=Se.parseAmount(e["".concat(be).concat(Oe)])),e["".concat(be).concat(ge)]&&(t.Credit=Se.parseAmount(e["".concat(be).concat(ge)])),t}))}return t}},ye=Se,Ae=n(769),xe=n(773),De=n(772),Ce=n(768),ke=n(770),Te=n(771),Ee=n(766),Me=(n(632),Object(ne.a)({table:{minWidth:650}})),Ne=function(e){var t=e.xlsData,n=e.name,a=Object(r.useMemo)((function(){var e={};return t.forEach((function(t){var n=R()(t.Date).format("MMM-YY");e[n]=n})),e}),[t]),i=Object.values(a),c=Object(r.useState)(1===i.length?i[0]:""),o=Object(s.a)(c,2),u=o[0],l=o[1],p=Me(),d=Object(r.useContext)(F).appData;d.transSheetMonth=u;Object(r.useCallback)((function(e){e.target.value&&(d.transSheetMonth=e.target.value,l(e.target.value))}),[d]);var h=t;u&&(h=t.filter((function(e){return R()(e.Date).format("MMM-YY")===u})),d.transactions=h);Object(r.useCallback)((function(){}),[]);return Object(le.jsxs)(le.Fragment,{children:[Object(le.jsx)("div",{className:"preview-header",children:Object(le.jsxs)("div",{children:["File: ",Object(le.jsx)("h4",{children:n})]})}),Object(le.jsx)(Ce.a,{className:"xls-file-preview",component:Ee.a,children:Object(le.jsxs)(Ae.a,{className:p.table,size:"small",stickyHeader:!0,"aria-label":"Parsed Bank Transactions",children:[Object(le.jsx)(ke.a,{children:Object(le.jsxs)(Te.a,{children:[Object(le.jsx)(De.a,{children:"#"}),Object(le.jsx)(De.a,{children:"Date"}),Object(le.jsx)(De.a,{children:"Description"}),Object(le.jsx)(De.a,{align:"right",children:"Cheque No."}),Object(le.jsx)(De.a,{align:"right",children:"Debit"}),Object(le.jsx)(De.a,{align:"right",children:"Credit"}),Object(le.jsx)(De.a,{align:"right",children:"Total"})]})}),Object(le.jsx)(xe.a,{children:h.map((function(e,t){return Object(le.jsxs)(Te.a,{children:[Object(le.jsx)(De.a,{component:"th",scope:"row",children:t+1}),Object(le.jsx)(De.a,{component:"th",scope:"row",children:R()(e.Date).format("DD-MM-YYYY")}),Object(le.jsx)(De.a,{children:e.Description}),Object(le.jsx)(De.a,{align:"right",children:e["Cheque No"]}),Object(le.jsx)(De.a,{align:"right",children:e.Debit}),Object(le.jsx)(De.a,{align:"right",children:e.Credit}),Object(le.jsx)(De.a,{align:"right",children:e.Total})]},e.Description)}))})]})})]})},we=n(35),Ie=n(33),Re={"Audit Fees":1,BWSSB:2,Diesel:3,Bescom:4,"House Keeping Salary":5,Security:6,"Garden Maintenance":7,"Garbage Collection Vendor (Hasirudala)/BBMP":8,"Borewell And Motor Maintenance":9,"Annual Bonus":10,"Lift Maintenance (Johnson)":11,"HK items (bleaching powder,garbage bin etc)":12,"Health Club Maintenance":13,"Electrical / Plumbing Repairs":14,"Apartment repairs related":15,"Apartment Safety":16,"CCTV / Intercomm":17,"Misc expenses":18,"Apartment developments":19,"Apartment Work By Security and Others":20,"Septic Tank Repairs / Cleaning":21,"Water Tanks Cleaning":22,"Generator Maintenance and Repair":23,"SMS Charges/Cheque book (Vijaya Bank)":24,"Festival/Holiday Celebration":25,"Drinking Water for Employees":26,"BAF Subscription Charges":27,"Maintenance Collection":30,"Income Tax Refund":31,"Other Income":32,"Interest on account":33,"Fine / Extra Payment Received":34,"Corpus Fund":35,"Tenant Deposit from the Owners":36,"FD Deposit":37,"Deposit to RD account":38},Le={Apr:2,May:3,Jun:4,Jul:5,Aug:6,Sep:7,Oct:8,Nov:9,Dec:10,Jan:11,Feb:12,Mar:13},Be={"001":1,"002":2,"003":3,"004":4,"005":5,"007":6,"008":7,"009":8,"010":9,"011":10,"012":11,101:12,102:13,103:14,104:15,105:16,106:17,107:18,108:19,109:20,110:21,111:22,112:23,201:24,202:25,203:26,204:27,205:28,206:29,207:30,208:31,209:32,210:33,211:34,212:35,301:36,302:37,303:38,304:39,305:40,306:41,307:42,308:43,309:44,310:45,311:46,312:47,401:48,402:49,403:50,404:51,405:52,406:53,407:54,408:55,409:56,410:57,411:58,412:59},Ye={Apr:2,May:3,Jun:4,Jul:5,Aug:6,Sep:7,Oct:8,Nov:9,Dec:10,Jan:11,Feb:12,Mar:13},He=function(){function e(){Object(we.a)(this,e),this.currentSheet="",this.initialized=!1}return Object(Ie.a)(e,[{key:"init",value:function(){var e=this;return this.initialized?Promise.resolve(H.doc):new Promise((function(t,n){var a=H.doc;a.useServiceAccountAuth({client_email:H.clientEmail||"",private_key:H.privateKey||""}).then((function(){a.loadInfo().then((function(){e.initialized=!0,t(a)})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e),n(e)}))}))}},{key:"getSpreadSheet",value:function(){return H.doc}},{key:"getSheetByTitleAsJson",value:function(){var e=Object(te.a)(Object(ee.a)().mark((function e(t){var n,a,r,i,c,o,s,u,l,p,d,h;return Object(ee.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],e.next=3,this.getSheetByTitle(t);case 3:if(a=e.sent,r=a.headerValues,i=a.columnCount,!r||0===r.length)for(r=[],c=0;c<i;c+=1)o=a.getCell(0,c),o.value&&r.push(a.getCell(0,c).value.toString());i=r.length,s=a.rowCount,u=1;case 10:if(!(u<s)){e.next=22;break}for(l={},p=[],c=0;c<i;c+=1)d=r[c],h=a.getCell(u,c).formattedValue,l[d]=h,p.push(h);if(!p.some((function(e){return null!==e}))){e.next=18;break}n.push(l),e.next=19;break;case 18:return e.abrupt("break",22);case 19:u+=1,e.next=10;break;case 22:return e.abrupt("return",n);case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getSheetByTitle",value:function(){var e=Object(te.a)(Object(ee.a)().mark((function e(t){var n,a;return Object(ee.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=null===(n=H.doc)||void 0===n?void 0:n.sheetsByTitle[t])){e.next=5;break}return this.currentSheet=a.sheetId,e.next=5,a.loadCells();case 5:return e.abrupt("return",a);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getSheet",value:function(){var e=Object(te.a)(Object(ee.a)().mark((function e(t){var n;return Object(ee.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentSheet=t,n=H.doc.sheetsById[t],e.next=4,n.loadCells();case 4:return e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"appendSheet",value:function(e,t){return H.doc.sheetsById[e].addRow(t)}},{key:"append",value:function(e){return H.doc.sheetsById[this.currentSheet||""].addRow(e)}},{key:"appendRows",value:function(){var e=Object(te.a)(Object(ee.a)().mark((function e(t){var n;return Object(ee.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=H.doc.sheetsById[this.currentSheet||""],e.next=3,n.addRows(t);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getSheetRow",value:function(e,t){return H.doc.sheetsById[e].getRows({limit:1,offset:t})}},{key:"getRow",value:function(e){return H.doc.sheetsById[this.currentSheet||""].getRows({limit:1,offset:e})}},{key:"getColumn",value:function(e){for(var t=H.doc.sheetsById[this.currentSheet||""],n=[],a=t.rowCount<100?t.rowCount:100,r=0;r<a-1;r+=1)n.push(t.getCell(r,e));return n}},{key:"getColumnWithSheet",value:function(e,t){for(var n=[],a=e.rowCount<100?e.rowCount:100,r=0;r<a-1;r+=1)n.push(e.getCell(r,t));return n}},{key:"getSheetColumn",value:function(e,t){for(var n=H.doc.sheetsById[e],a=[],r=n.rowCount<100?n.rowCount:100,i=0;i<r-1;i+=1)a.push(n.getCell(i,t));return a}},{key:"getSheetCell",value:function(e,t,n){return H.doc.sheetsById[e].getCell(t,n)}},{key:"getCell",value:function(e,t){return H.doc.sheetsById[this.currentSheet||""].getCell(e,t)}},{key:"saveSheetCells",value:function(e,t){return H.doc.sheetsById[e].saveCells(t)}},{key:"saveCells",value:function(e){return H.doc.sheetsById[this.currentSheet||""].saveCells(e)}},{key:"addSheet",value:function(e){return H.doc.addSheet(e)}},{key:"saveSheetWithJSON",value:function(){var e=Object(te.a)(Object(ee.a)().mark((function e(t){var n;return Object(ee.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=H.doc.sheetsById[this.currentSheet||""],e.next=3,this.updateSheet(n,t);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateCategorySheet",value:function(){var e=Object(te.a)(Object(ee.a)().mark((function e(t){var n;return Object(ee.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getSheetByTitle("Summary");case 2:return n=e.sent,e.next=5,n.loadCells();case 5:return Object.keys(t).forEach((function(e){var a=t[e],r=Object.keys(a),i=e.replace(/-\d+$/,""),c=Le[i];r.forEach((function(e){var t=Re[e];"undefined"!==typeof t&&"undefined"!==typeof c&&(n.getCell(t,c).value=a[e])}))})),e.abrupt("return",n.saveUpdatedCells());case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"udpateMaintenanceSheet",value:function(){var e=Object(te.a)(Object(ee.a)().mark((function e(t){var n;return Object(ee.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getSheetByTitle("Maintanence");case 2:return n=e.sent,e.next=5,n.loadCells();case 5:return Object.keys(t).forEach((function(e){var a=t[e],r=Object.keys(Be),i=e.replace(/-\d+$/,""),c=Ye[i];r.forEach((function(e){var t=Be[e];"undefined"!==typeof t&&"undefined"!==typeof c&&(n.getCell(t,c).value=a[e])}))})),e.abrupt("return",n.saveUpdatedCells());case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"isEmptySheet",value:function(e){return!e||0===e.rowCount}},{key:"updateSheet",value:function(){var e=Object(te.a)(Object(ee.a)().mark((function e(t,n){var a,r,i,c,o,s,u,l,p,d=arguments;return Object(ee.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=d.length>2&&void 0!==d[2]?d[2]:0,n&&n.length)for(r=Object.keys(n[0]),i=r.length,c=a+n.length,o=a;o<c;o+=1)for(s=n[o],u=0;u<i;u+=1)l=t.getCell(o+1,u),p=s[r[u]],l.formattedValue!==p&&(l.value=p);return e.next=4,t.saveUpdatedCells();case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateSheetWithJSON",value:function(){var e=Object(te.a)(Object(ee.a)().mark((function e(t,n){return Object(ee.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=3;break}return e.next=3,this.getSheetByTitle(n);case 3:return e.next=5,this.appendRows(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}],[{key:"getInstance",value:function(){return q||(q=new e).init(),q}}]),e}(),_e=He.getInstance();var Pe=function(e){var t=e.data,n=Object(r.useState)(""),a=Object(s.a)(n,2),i=a[0],c=a[1];Object(r.useEffect)((function(){_e.init()}),[]);var o=Object(r.useCallback)(Object(te.a)(Object(ee.a)().mark((function e(){var n,a;return Object(ee.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="Online Transactions",e.next=3,_e.getSheetByTitle(n);case 3:if(e.sent){e.next=7;break}return e.next=7,_e.addSheet({headerValues:["Date","Description","Cheque No","Debit","Credit","Total","Category","Flat"],title:n});case 7:return a=JSON.parse(JSON.stringify(t)).map((function(e){return e.Date=R()(e.Date).format("DD-MM-YYYY"),e})),e.next=10,_e.updateSheetWithJSON(a,n);case 10:c("Sheet Updated");case 11:case"end":return e.stop()}}),e)}))),[t]);return Object(le.jsxs)(le.Fragment,{children:[Object(le.jsx)("p",{children:i}),Object(le.jsx)("div",{className:"tools",children:Object(le.jsx)(oe.a,{variant:"outlined",onClick:o,children:"Save Sheet"})})]})},Ue=(n(633),Object(ne.a)((function(e){return Object(ae.a)({root:{width:"100%"},button:{marginRight:e.spacing(1)},instructions:{marginTop:e.spacing(1),marginBottom:e.spacing(1)}})})));var Fe,Ke=function(){var e=Ue(),t=Object(l.c)((function(e){return e.sheet})).sheetConfig,n=Object(r.useState)(""),a=Object(s.a)(n,2),i=a[0],c=a[1],o=Object(r.useState)(0),u=Object(s.a)(o,2),p=u[0],d=u[1],h=Object(r.useState)(""),b=Object(s.a)(h,2),j=b[0],f=b[1],v=Object(r.useState)([]),O=Object(s.a)(v,2),m=O[0],S=O[1],y=Object(r.useCallback)((function(e){f(e.name),ye.parseXLS(e).then((function(e){t.appData.transactions=e,e.reverse(),S(e),c(""),d(1)}))}),[t.appData]),A=Object(r.useCallback)((function(e){switch(e){case 0:return Object(le.jsx)(pe,{onUpload:y});case 1:return Object(le.jsx)(Ne,{name:j,xlsData:m});case 2:return Object(le.jsx)(Pe,{data:m});default:return"Unknown step"}}),[m,y,j]),x=Object(r.useState)(new Set),D=Object(s.a)(x,2),C=D[0],T=D[1],E=["File Upload","File Preview","Save"],M=Object(r.useCallback)((function(e){return C.has(e)}),[C]),N=Object(r.useCallback)(Object(te.a)(Object(ee.a)().mark((function e(){var t;return Object(ee.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=C,M(p)&&(t=new Set(t.values())).delete(p),e.t0=p,e.next=0===e.t0?5:(e.t0,7);break;case 5:return j?(d((function(e){return e+1})),c("")):c("Select a file."),e.abrupt("break",9);case 7:d((function(e){return e+1})),c("");case 9:T(t);case 10:case"end":return e.stop()}}),e)}))),[p,j,M,C]),w=Object(r.useCallback)((function(){d(0)}),[]);return Object(le.jsxs)("div",{className:"wizard",children:[i&&Object(le.jsx)(g.a,{severity:"error",children:i}),Object(le.jsxs)("div",{className:e.root,children:[Object(le.jsx)(re.a,{activeStep:p,children:E.map((function(e,t){var n={},a={};return M(t)&&(n.completed=!1),Object(le.jsx)(ie.a,Object(k.a)(Object(k.a)({},n),{},{children:Object(le.jsx)(ce.a,Object(k.a)(Object(k.a)({},a),{},{children:e}))}),e)}))}),Object(le.jsxs)("div",{children:[p===E.length&&Object(le.jsxs)("div",{children:[Object(le.jsx)(se.a,{className:e.instructions,children:"All steps completed - you're finished"}),Object(le.jsx)(oe.a,{onClick:w,className:e.button,children:"Reset"})]}),p!==E.length&&Object(le.jsxs)("div",{children:[Object(le.jsx)(se.a,{className:e.instructions,children:A(p)}),Object(le.jsxs)("div",{children:[Object(le.jsx)(oe.a,{disabled:0===p,onClick:function(){d((function(e){return e-1}))},className:e.button,children:"Back"}),!1,Object(le.jsx)(oe.a,{variant:"contained",color:"primary",onClick:N,className:e.button,children:p===E.length-1?"Save":"Next"})]})]})]})]})]})},Je=function(){return Object(le.jsx)(Ke,{})},We=n(219),Ve=n.n(We);function Ge(e){return function(t){t({type:J.INIT});var n,a=L(e);a.res?t((n=Object(k.a)({},H),{type:J.INIT_SUCCESS,payload:n})):t(function(e){return{type:J.INIT_FAILURE,payload:e}}(a.error))}}!function(e){e.and="and",e.or="or",e.xor="xor",e.not="not",e.nand="nand",e.nor="nor"}(Fe||(Fe={}));var qe,ze=function(){function e(t){Object(we.a)(this,e),this.query=void 0,this.query=t}return Object(Ie.a)(e,[{key:"run",value:function(e){var t=this;return Object.keys(this.query).every((function(n){var a=t.query[n];switch(n){case Fe.or:return a.some((function(t){return e(t)}));case Fe.nor:return!a.some((function(t){return e(t)}));case Fe.xor:var r=a.map((function(t){return e(t)}));return r.some((function(e){return!0===e}))&&r.some((function(e){return!1===e}));case Fe.nand:case Fe.not:return!a.every((function(t){return e(t)}));case Fe.and:default:return a.every((function(t){return e(t)}))}}))}}]),e}(),Ze=function(){function e(t){Object(we.a)(this,e),this.query=void 0,this.query=t}return Object(Ie.a)(e,[{key:"run",value:function(e){var t=!1,n=this.query,a=n.opr,r=n.value;if(e&&r)switch(a){case"==":t=e.toString()===r.toString();break;case"!=":t=e.toString()!==r.toString();break;case">":t=e>r;break;case">=":t=e>=r;break;case"<":t=e<r;break;case"<=":t=e<=r;break;case"having":if("string"===typeof e)if(Array.isArray(r))t=r.some((function(t){var n=t.toString();return e.toLowerCase().indexOf(n.toLowerCase())>-1}));else{var i=r.toString();t=e.toLowerCase().indexOf(i.toLowerCase())>-1}break;case"regex":if(Array.isArray(r))t=r.some((function(t){var n,a=t.toString(),r=new RegExp(a,"i");return(null===(n=e.match(r))||void 0===n?void 0:n.length)>0}));else{var c,o=r.toString(),s=new RegExp(o,"i");t=(null===(c=e.match(s))||void 0===c?void 0:c.length)>0}break;case"in":Array.isArray(r)&&(t="string"===typeof r[0]?r.indexOf(e.toString())>-1:r.indexOf(e)>-1);break;case"range":Array.isArray(r)&&(t=(t="undefined"===typeof r[0]||e>=r[0])&&("undefined"===typeof r[1]||e<=r[1]))}return t}}]),e}(),Xe=function(){function e(t){Object(we.a)(this,e),this.query=void 0,this.query=t}return Object(Ie.a)(e,[{key:"run",value:function(e){var t=this;return Object.keys(this.query).every((function(n){var a=t.query[n],r=!1;Array.isArray(a)?r=a.every((function(t){var a=new Ze(t),r=e[n];return a.run(r)})):r=new ze(a).run((function(t){var a=new Ze(t),r=e[n];return a.run(r)}));return r}))}}]),e}(),Qe=function(){function e(t){Object(we.a)(this,e),this.catFieldMap=void 0,this.catFieldMap=t}return Object(Ie.a)(e,[{key:"run",value:function(e){var t=this,n=Object.keys(this.catFieldMap);e.forEach((function(e){if(!e.Category){var a=n.find((function(n){var a,r=t.catFieldMap[n];Array.isArray(r)?a=r.every((function(t){return new Xe(t).run(e)})):a=new ze(r).run((function(t){return new Xe(t).run(e)}));return a}));e.Category=a}}))}}]),e}(),$e={"Maintenance Collection":[{Credit:[{opr:"in",value:["2,600.00","2600","2,700.00","2700","2,800.00","2800","5,400.00","5400","5,500.00","5500","5,600.00","5600","8,100.00","8100","5,200.00","5200","8,400.00","8400","10,800.00","10800","11,200.00","11200","14,000.00","14000","13,500.00","13500"]}],Description:[{opr:"having",value:["maintenance","neft","upi","imps"]}]}],"Audit Fees":[{Description:[{opr:"having",value:["N YASWANTH","YASWANTH"]}]}],"Corpus Fund":[{Credit:[{opr:"in",value:["7500","7,500.00","15,000.00","15000","22,500.00","22500","30,000.00","30000","37,500.00","37500","45,000.00","45000"]}],Description:[{opr:"having",value:["corpus","neft","upi","imps"]}]}],"Income Tax Refund":[{Credit:[{opr:"in",value:["ACH","AY20","ACH Credit","AAKAS1985M"]}]}],Bescom:[{Description:[{opr:"having",value:["BESCOM","Electricity","EBANK:BBPS"]}]}],BWSSB:[{Debit:[{opr:"range",value:[14e3,16500]}],Description:[{opr:"having",value:["BANGALORE WATER SUPPLY","BWSSB","BANGALORE ONE","EBANK:BBPS"]}]}],"CCTV / Intercomm":[{Description:[{opr:"having",value:["SHANKAR TELECOM LINKS","Intercom"]}]}],Security:[{Debit:[{opr:"in",value:["35,000.00","35000","41000","41,000.00"]}]}],"House Keeping Salary":[{Description:[{opr:"regex",value:["Housekeeping.+Salary","House keeping.+Salary","house-keeping.+salary","housekeeping.+ladies","hk.+salary"]}]}],"Garden Maintenance":[{Description:[{opr:"regex",value:["garden","Gardner.+Salary","garden.+work","Manure"]}]}],"Garbage Collection Vendor (Hasirudala)/BBMP":[{Description:[{opr:"having",value:["SYED ALI BASHA"]}]}],"Borewell And Motor Maintenance":[{Description:[{opr:"having",value:["borewell","motor","coil","winding"]}]}],"Lift Maintenance (Johnson)":[{Description:[{opr:"regex",value:["JOHNSON.+LIFTS","Lift"]}]}],"HK items (bleaching powder,garbage bin etc)":[{Description:[{opr:"regex",value:["Housekeeping.+Items","Housekeeping.+Material","hk.+item","HK.+Material","bleaching","garbage drum","powder","mop","dust","dustbin","soap","detergent","broom","switch","tubelight","switch","light","bulb","Phenoyl","powder","phenoyl","sanitizer","cleaner","dettol","bottle","neem oil","tap","kerosene"]}]}],"Electrical / Plumbing Repairs":[{Description:[{opr:"having",value:["electric repair","electric work","electric","Chamundi","plumbing"]}]}],"Septic Tank Repairs / Cleaning":[{Description:[{opr:"having",value:["septik","septic","septic tank","sewage tank","sewage work","sewage pipe"]}]}],"Water Tanks Cleaning":[{Description:[{opr:"regex",value:["water.+tank"]}]}],"Generator Maintenance and Repair":[{Description:[{opr:"regex",value:["venus.+energy","kirloskar","generator"]}]}],"SMS Charges/Cheque book (Vijaya Bank)":[{Description:[{opr:"regex",value:["SMS .+Alert","cheque.+book","charges","chq.+book"]}]}],"Health Club Maintenance":[{Description:[{opr:"having",value:["gym","FITNESS","sports"]}]}],"Festival/Holiday Celebration":[{Description:[{opr:"regex",value:["diwali.+work","diwali","festival","celebration","pooja","pongal","independence","republic","sweets","flag"]}]}],"Drinking Water for Employees":[{Description:[{opr:"having",value:["drinking","drinking water","mineral water","water purchase"]}]}],Diesel:[{Description:[{opr:"regex",value:["Diesel"]}]}],"BAF Subscription Charges":[{Description:[{opr:"regex",value:["BAF","BAF Subscription"]}]}],"Annual Bonus":[{Description:[{opr:"regex",value:["bonus"]}]}],"Interest on account":[{Description:[{opr:"having",value:["89630100005613"]}]}],"FD Deposit":[{Description:[{opr:"having",value:["TO TRANSFER","Repayment Credit"]}]}],"Tenant Deposit from the Owners":[{Credit:[{opr:"in",value:["10,000.00","10000"]}]}],"Apartment Work By Security and Others":[{Description:[{opr:"regex",value:["Apartment.+Work","Cleaning.+Rain Water"]}]}],"Apartment Safety":[{Description:[{opr:"having",value:["sanitization","sanitizing","mask","sheild","shield","spray","cutting tree","fire","extinguisher","rat poison"]}]}],"Apartment developments":[{Description:[{opr:"having",value:["stationery","pen","paper","folder","files","notebook","note book","note-book","entry book","reciept book","bought","purchased","purchase of","cash voucher"]}]}],"Apartment repairs related":[{Description:[{opr:"having",value:["cement work","cement","service","repair","spanner","fixing","fixed"]}]}],"Misc expenses":[{Description:[{opr:"having",value:["tea","coffee"]}]}],"Fine / Extra Payment Received":[{Description:[{opr:"having",value:["maintenance","neft","upi","imps"]}],Credit:[{opr:"regex",value:["\\d"]}]}],"Other Income":[{Description:[{opr:"having",value:["income","other"]}],Credit:[{opr:">",value:0}]}],"Cash Withdrawal / in hand":{or:[{Description:[{opr:"regex",value:["cash","withdrawal","bank","basavaraj","carry.+forwarded","self"]}]},{"Cheque No":[{opr:"regex",value:["\\d+"]}]}]},"Deposit to RD account":[{Description:[{opr:"having",value:["3715125","SI:89630300010611"]}]}]},et={"001":[{Description:[{opr:"having",value:["khadir","MOHAMEDABDULKHA"]}]}],"002":[{Description:[{opr:"having",value:["shainv","potti","MAHESH"]}]}],"003":[{Description:[{opr:"having",value:["gulshan","padma","6364883334","subhrojyoti","6289470044"]}]}],"004":[{Description:[{opr:"having",value:["ANAND","ESHWARDAS"]}]}],"005":[{Description:[{opr:"having",value:["KOPRESH"]}]}],"007":[{Description:[{opr:"having",value:["007"]}]}],"008":[{Description:[{opr:"having",value:["NITHINS","/008","Repaka"]}]}],"009":[{Description:[{opr:"having",value:["rutvijkanzaria","PRATIK"]}]}],"010":[{Description:[{opr:"having",value:["ANANTH"]}]}],"011":[{Description:[{opr:"having",value:["AKARSH"]}]}],"012":[{Description:[{opr:"having",value:["K B GANESH","GANESH"]}]}],101:[{Description:[{opr:"having",value:["VIJAYAKUMAR T","VIJAYAKUMAR"]}]}],102:[{Description:[{opr:"having",value:["ARNAB","CHAKRABORTY","ARNABCHAKRABORT"]}]}],103:[{Description:[{opr:"having",value:["KRISHNA KUMAR","KRISHNAKUMAR"]}]}],104:[{Description:[{opr:"having",value:["AMIT KUMAR","KARMAKAR","AMITKUMAR"]}]}],105:[{Description:[{opr:"having",value:["VIKASVERMA","VIKAS VERMA","MB105","105MAINTENA"]}]}],106:[{Description:[{opr:"having",value:["mr.uttammohanty"]}]}],107:[{Description:[{opr:"having",value:["POLAKALA"]}]}],108:[{Description:[{opr:"having",value:["EMMANUEL RAJA A","EMMANUEL"]}]}],109:[{Description:[{opr:"having",value:["K S A RAJA RAM KUMAR","RAJARAMKUMAR"]}]}],110:[{Description:[{opr:"having",value:["SONYKUMARI","SONY KUMARI","PAVAN DEVARU","PAVANDEVARU","MOBLTA"]}]}],111:[{Description:[{opr:"having",value:["SENTHILKUMAR","SENTHIL"]}]}],112:[{Description:[{opr:"having",value:["ARINDAM"]}]}],201:[{Description:[{opr:"having",value:["ESWAR KRISHNAN","ESWAR","KARTHIKEYAN","flat201"]}]}],202:[{Description:[{opr:"having",value:["SRIHARSHA","SRI HARSHA"]}]}],203:[{Description:[{opr:"having",value:["NILOTPALDAS"]}]}],204:[{Description:[{opr:"having",value:["AMLANJYOTI","AMLAN"]}]}],205:[{Description:[{opr:"having",value:["VIKRAMADITYA"]}]}],206:[{Description:[{opr:"having",value:["PINAKI"]}]}],207:[{Description:[{opr:"having",value:["PRIYA MISHRA","PRIYAMISHRA","SRINIVAS","prashant.dombale"]}]}],208:[{Description:[{opr:"having",value:["JESUDOSS"]}]}],209:[{Description:[{opr:"having",value:["AJUJAMESASHOK","AJU JAMES ASHOK","AJUJAMES","T R RAJARAM","TRRAJARAM","CHALAPATHI"]}]}],210:[{Description:[{opr:"having",value:["TARANBIR","IMPSMBRSur"]}]}],211:[{Description:[{opr:"having",value:["9972528008"]}]}],212:[{Description:[{opr:"having",value:["SURAJIT"]}]}],301:[{Description:[{opr:"having",value:["PRABUDH"]}]}],302:[{Description:[{opr:"having",value:["BALAJI"]}]}],303:[{Description:[{opr:"having",value:["SURENDRA"]}]}],304:[{Description:[{opr:"having",value:["MEHDI"]}]}],305:[{Description:[{opr:"having",value:["VIVIN"]}]}],306:[{Description:[{opr:"having",value:["ASHIM","DEBAJYOTI"]}]}],307:[{Description:[{opr:"having",value:["SAMPREETH"]}]}],308:[{Description:[{opr:"having",value:["PRAHLAD"]}]}],309:[{Description:[{opr:"having",value:["7406849918","prasad.kiran","kbv018@okhdfcbank"]}]}],310:[{Description:[{opr:"having",value:["PREMA"]}]}],311:[{Description:[{opr:"having",value:["GURUPRASADA","CHOKKADI"]}]}],312:[{Description:[{opr:"having",value:["SHAKTHI","VINAYAK"]}]}],401:[{Description:[{opr:"having",value:["HARISHA"]}]}],402:[{Description:[{opr:"having",value:["JITHA","JITHAJAMES","JITHA JAMES"]}]}],403:[{Description:[{opr:"having",value:["8147758124","shaheer"]}]}],404:[{Description:[{opr:"having",value:["NOBROKER","/404Main","MOHAMMED SAIF"]}]}],405:[{Description:[{opr:"having",value:["SANTOSHKUMAR","/405main","SANTHOSH KUMAR","MALLA"]}]}],406:[{Description:[{opr:"having",value:["PRAVEENVIJAY","PRAVEEN VIJAY"]}]}],407:[{Description:[{opr:"having",value:["GALLA","VARADARAJU"]}]}],408:[{Description:[{opr:"having",value:["UDAY KIRAN","UDAY","YAGNAMURTHY"]}]}],409:[{Description:[{opr:"having",value:["PRABU","SUNDARRAJU","Jeevanantham"]}]}],410:[{Description:[{opr:"having",value:["rohinimh19","ROHINI","MALLIKARJUN"]}]}],411:[{Description:[{opr:"having",value:["NATESAN","ADITYA KOLLURI","ADITYAKOLLURI"]}]}],412:[{Description:[{opr:"having",value:["CHIRANJAN"]}]}]},tt=function(){function e(t){Object(we.a)(this,e),this.catFieldMap=void 0,this.catFieldMap=t}return Object(Ie.a)(e,[{key:"run",value:function(e){var t=this,n=Object.keys(this.catFieldMap);e.forEach((function(e){if(!e.Flat){var a=n.find((function(n){var a,r=t.catFieldMap[n];Array.isArray(r)?a=r.every((function(t){return new Xe(t).run(e)})):a=new ze(r).run((function(t){return new Xe(t).run(e)}));return a}));e.Flat=a}}))}}]),e}();!function(e){e["Audit Fees"]="Audit Fees",e.BWSSB="BWSSB",e.Diesel="Diesel",e.Bescom="Bescom",e["House Keeping Salary"]="House Keeping Salary",e.Security="Security",e.Gardener="Gardener",e["Garbage Collection Vendor (Hasirudala)/BBMP"]="Garbage Collection Vendor (Hasirudala)/BBMP",e["Borewell And Motor Maintenance"]="Borewell And Motor Maintenance",e["Annual Bonus"]="Annual Bonus",e["Lift Maintenance (Johnson)"]="Lift Maintenance (Johnson)",e["HK items (bleaching powder,garbage bin etc)"]="HK items (bleaching powder,garbage bin etc)",e["Health Club Maintenance"]="Health Club Maintenance",e["Electrical / Plumbing Repairs"]="Electrical / Plumbing Repairs",e["Apartment repairs related"]="Apartment repairs related",e["Apartment Painting"]="Apartment Painting",e["CCTV / Intercomm"]="CCTV / Intercomm",e["Misc expenses"]="Misc expenses",e["Apartment developments"]="Apartment developments",e["Apartment Work By Security and Others"]="Apartment Work By Security and Others",e["Septic Tank Repairs / Cleaning"]="Septic Tank Repairs / Cleaning",e["Water Tanks Cleaning"]="Water Tanks Cleaning",e["Generator Maintenance and Repair"]="Generator Maintenance and Repair",e["SMS Charges/Cheque book (Vijaya Bank)"]="SMS Charges/Cheque book (Vijaya Bank)",e["Festival/Holiday Celebration"]="Festival/Holiday Celebration",e["Drinking Water for Employees"]="Drinking Water for Employees",e["BAF Subscription Charges"]="BAF Subscription Charges",e["Maintenance Collection"]="Maintenance Collection",e["Income Tax Refund"]="Income Tax Refund",e["Other Income"]="Other Income",e["Interest on account"]="Interest on account",e["Fine / Extra Payment Received"]="Fine / Extra Payment Received",e["Corpus Fund"]="Corpus Fund",e["Tenant Deposit from the Owners"]="Tenant Deposit from the Owners",e["FD Deposit"]="FD Deposit"}(qe||(qe={}));var nt=function(){return{type:a.LOAD_TRANS}},at=function(e){return{type:a.LOAD_CASH_TRANS_SUCCESS,payload:e}},rt=function(e){return{type:a.LOAD_ONLINE_TRANS_SUCCESS,payload:e}},it=function(e){return{type:a.LOAD_CASH_TRANS_FAILURE,payload:e}},ct=function(e){return{type:a.LOAD_ONLINE_TRANS_FAILURE,payload:e}};function ot(e,t){return e.filter((function(e){return e.Category&&t.indexOf(e.Category)>-1}))}function st(e,t){return function(n){var r;n(nt()),e.forEach((function(e){var n=e.Category,a=e.Date;if(n&&a){var r,i=a.replace(/\//g,"-"),c=R()(i,"DD-MM-YYYY").format("MMM-YY");t||(t={}),t[c]||(t[c]={});var o=e.Debit&&"0"!==(null===(r=e.Debit)||void 0===r?void 0:r.toString()),s=o?parseFloat(e.Debit.toString().replace(/,/g,"")):parseFloat(e.Credit.toString().replace(/,/g,""));o&&(s=-s),s&&"number"===typeof s?t[c][n]?t[c][n]+=s:t[c][n]=s:console.log("cat",n,c,e)}})),n((r=Object(k.a)({},t),{type:a.UPDATE_MONTHLY_SPLIT,payload:r}))}}function ut(e,t){return function(n){var r;n(nt()),e.forEach((function(e){var n=e.Flat,a=e.Date;if(n&&a){var r=R()(a,"DD/MM/YYYY").format("MMM-YY");t||(t={}),t[r]||(t[r]={});var i=parseFloat(e.Credit.toString().replace(/,/g,""));i&&"number"===typeof i?t[r][n]?t[r][n]+=i:t[r][n]=i:console.log("Flat",n,r,e)}})),n((r=Object(k.a)({},t),{type:a.UPDATE_MONTHLY_MAINT_SPLIT,payload:r}))}}var lt=n(776);var pt=function(){var e=Object(l.c)((function(e){return e.trans})),t=Object(l.b)();Object(r.useEffect)((function(){t(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Cash Transactions";return function(t){t(nt()),_e.init().then((function(){_e.getSheetByTitleAsJson(e).then((function(e){new Qe($e).run(e),new tt(et).run(ot(e,[qe["Maintenance Collection"],qe["Corpus Fund"]])),t(at(e)),_e.saveSheetWithJSON(e)})).catch((function(e){t(it(e.message))}))}))}}())}),[t]);var n=e.cashTransData,a=Object(r.useMemo)((function(){var e=[];return n&&n.length>1&&(e=Object.keys(n[0])),e}),[n]);return Object(le.jsx)(le.Fragment,{children:Object(le.jsxs)("div",{className:"cash-trans",children:[e.loading&&Object(le.jsx)(lt.a,{}),!e.loading&&Object(le.jsxs)(Ae.a,{children:[Object(le.jsx)(ke.a,{children:Object(le.jsxs)(Te.a,{children:[Object(le.jsx)(De.a,{children:"Sl. No."}),a.map((function(e){return Object(le.jsx)(De.a,{children:e},e)}))]})}),Object(le.jsx)(xe.a,{children:!!n&&n.map((function(e,t){return Object(le.jsxs)(Te.a,{children:[Object(le.jsx)(De.a,{children:t+1}),a.map((function(t){return Object(le.jsx)(De.a,{children:"Date"!==t?e[t]:R()(e[t],"DD/MM/YYYY").format("DD/MM/YYYY")},"".concat(t,"-").concat(e[t]))}))]},JSON.stringify(e))}))})]})]})})};var dt=function(){var e=Object(l.c)((function(e){return e.trans})),t=Object(l.b)();Object(r.useEffect)((function(){t(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Online Transactions";return function(t){t(nt()),_e.init().then((function(){_e.getSheetByTitleAsJson(e).then((function(e){new Qe($e).run(e),new tt(et).run(ot(e,[qe["Maintenance Collection"],qe["Corpus Fund"]])),t(rt(e)),_e.saveSheetWithJSON(e)})).catch((function(e){t(ct(e.message))}))}))}}("Online Transactions"))}),[t]);var n=e.onlineTransData,a=Object(r.useMemo)((function(){var e=[];return n&&n.length>1&&(e=Object.keys(n[0])),e}),[n]);return Object(le.jsx)(le.Fragment,{children:Object(le.jsxs)("div",{className:"online-trans",children:[e.loading&&Object(le.jsx)(lt.a,{}),!e.loading&&Object(le.jsxs)(Ae.a,{children:[Object(le.jsx)(ke.a,{children:Object(le.jsxs)(Te.a,{children:[Object(le.jsx)(De.a,{children:"Sl. No."}),a.map((function(e){return Object(le.jsx)(De.a,{children:e},e)}))]})}),Object(le.jsx)(xe.a,{children:!!n&&n.map((function(e,t){return Object(le.jsxs)(Te.a,{children:[Object(le.jsx)(De.a,{children:t+1}),a.map((function(t){return Object(le.jsx)(De.a,{children:"Date"!==t?e[t]:R()(e[t],"DD-MM-YYYY").format("DD/MM/YYYY")},"".concat(t,"-").concat(e[t]))}))]},JSON.stringify(e))}))})]})]})})},ht=(n(635),Object(ne.a)((function(e){return Object(ae.a)({root:{width:"100%"},button:{marginRight:e.spacing(1)},instructions:{marginTop:e.spacing(1),marginBottom:e.spacing(1)}})})));var bt=function(){var e=Object(r.useState)(),t=Object(s.a)(e,2),n=t[0],a=t[1],i=Object(r.useState)("cash"),c=Object(s.a)(i,2),o=(c[0],c[1]),u=Object(r.useState)(""),p=Object(s.a)(u,2),d=p[0],h=(p[1],Object(l.b)()),b=Object(l.c)((function(e){return e.sheet})),j=b.initError,f=Object(l.c)((function(e){return e.trans})),v=f.monthlyCatSplit,O=f.cashTransData,m=f.onlineTransData,S=f.monthlyMaintSplit;Object(r.useEffect)((function(){d&&h(Ge(d))}),[h,d]);var y=Object(r.useCallback)((function(){O&&m&&(h(st([].concat(Object(G.a)(O),Object(G.a)(m)),{})),o(void 0))}),[O,h,m]),A=Object(r.useCallback)((function(){if(O&&m){var e=ot([].concat(Object(G.a)(O),Object(G.a)(m)),[qe["Maintenance Collection"]]);h(ut(e,{})),o(void 0)}}),[O,h,m]),x=Object(r.useCallback)((function(){_e.updateCategorySheet(v).then((function(){console.log("Saved"),a("Summary Updated")}))}),[v]),D=Object(r.useCallback)((function(){_e.udpateMaintenanceSheet(S).then((function(){console.log("Saved"),a("Maintenence Split Updated")}))}),[S]),C=Object(r.useState)(0),T=Object(s.a)(C,2),E=T[0],M=T[1],N=Object(r.useMemo)((function(){return["Cash Transactions","Online Transactions","Map Transactions","Categorize Maintenance"]}),[]),w=Object(r.useCallback)((function(e){return!1}),[]),I=Object(r.useCallback)((function(e){return!1}),[]),R=ht(),L=Object(r.useCallback)((function(){switch(E){case 3:o(void 0),M(2);break;case 2:o("online"),M(1);break;case 1:o("cash"),M(0)}}),[E]),B=Object(r.useCallback)((function(){}),[]),Y=Object(r.useCallback)((function(){switch(E){case 0:o("online"),M(1);break;case 1:o(void 0),M(2),y();break;case 2:o(void 0),M(3),A()}}),[E,A,y]);return Object(le.jsxs)("div",{children:[!!n&&Object(le.jsx)(g.a,{severity:"info",children:n}),!!j&&Object(le.jsx)(g.a,{severity:"error",children:j}),Object(le.jsxs)("div",{className:"stepper-header",children:[Object(le.jsx)(re.a,{className:"steps",activeStep:E,children:N.map((function(e,t){var n={},a={};return w(t)&&(a.optional=Object(le.jsx)(se.a,{variant:"caption",children:"Optional"})),I(t)&&(n.completed=!1),Object(le.jsx)(ie.a,Object(k.a)(Object(k.a)({},n),{},{children:Object(le.jsx)(ce.a,Object(k.a)(Object(k.a)({},a),{},{children:e}))}),e)}))}),Object(le.jsxs)("div",{className:"nav",children:[Object(le.jsx)(oe.a,{disabled:0===E,onClick:L,className:R.button,children:"Back"}),w(E)&&Object(le.jsx)(oe.a,{variant:"contained",color:"primary",onClick:B,className:R.button,children:"Skip"}),Object(le.jsx)(oe.a,{variant:"contained",color:"primary",onClick:Y,className:R.button,children:E===N.length-1?"Save":"Next"})]})]}),Object(le.jsxs)("div",{className:"control",children:[2===E&&Object(le.jsx)(oe.a,{variant:"outlined",disabled:!v,onClick:x,children:"Save Categorized"}),"\xa0\xa0\xa0",3===E&&Object(le.jsx)(oe.a,{variant:"outlined",disabled:!S,onClick:D,children:"Save Split"})]}),!j&&!!b.sheetConfig.secret&&Object(le.jsxs)(le.Fragment,{children:[0===E&&Object(le.jsx)(pt,{}),1===E&&Object(le.jsx)(dt,{}),2===E&&!!v&&Object(le.jsx)(Ve.a,{src:v}),3===E&&!!S&&Object(le.jsx)(Ve.a,{src:S})]})]})},jt=function(){return Object(le.jsx)(bt,{})},ft=n(62),vt=n.n(ft),Ot=n(372),gt=n.n(Ot),mt=n(373),St=H.clientEmail,yt=H.privateKey,At=(H.googleAPIKey,function(){var e=Object(te.a)(Object(ee.a)().mark((function e(){var t,n,a,r=arguments;return Object(ee.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:Math.floor(Date.now()/1e3+3600),n={iss:St,sub:"",aud:"https://www.googleapis.com/oauth2/v4/token",scope:"https://www.googleapis.com/auth/drive",exp:t,iat:Math.floor(Date.now()/1e3),jti:Object(mt.uuid)()},a=gt.a.sign(n,yt||"",{algorithm:"RS256"}),e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()),xt=function(){var e=Object(te.a)(Object(ee.a)().mark((function e(){var t,n,a;return Object(ee.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,At();case 2:return t=e.sent,"https://www.googleapis.com/oauth2/v4/token",n={grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",client_id:St,assertion:t},e.next=7,vt.a.post("https://www.googleapis.com/oauth2/v4/token",n);case 7:if(200!==(a=e.sent).status){e.next=10;break}return e.abrupt("return",a.data.access_token);case 10:throw new Error(a.data);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Dt="VERIFIED_",Ct="1zVRwXWZjfAS3Hk1rXq-XtqurPcQ-yAW-",kt=H.googleAPIKey;function Tt(e){return Et.apply(this,arguments)}function Et(){return(Et=Object(te.a)(Object(ee.a)().mark((function e(t){var n,a,r;return Object(ee.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=encodeURI("'".concat(t||Ct,"' in parents and (mimeType = 'image/jpeg' or mimeType = 'image/png' or mimeType = 'application/pdf' or mimeType = 'application/vnd.google-apps.folder')")),e.prev=2,e.next=5,vt.a.get("https://www.googleapis.com/drive/v3/files?q=".concat(n,"&key=").concat(kt));case 5:return a=e.sent,r=a.data.files,console.log("Fetched files:",r),e.abrupt("return",r);case 11:e.prev=11,e.t0=e.catch(2),console.error("Error fetching files:",(null===e.t0||void 0===e.t0?void 0:e.t0.message)||e.t0);case 14:return e.abrupt("return",[]);case 15:case"end":return e.stop()}}),e,null,[[2,11]])})))).apply(this,arguments)}var Mt=function(){var e=Object(te.a)(Object(ee.a)().mark((function e(t,n){var a,r;return Object(ee.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,xt();case 3:return a=e.sent,e.next=6,vt.a.patch("https://www.googleapis.com/drive/v3/files/".concat(t),{name:"".concat(Dt).concat(n)},{headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"}});case 6:if(r=e.sent,console.log("File moved successfully:",r.data),200!==r.status){e.next=10;break}return e.abrupt("return",r.data);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error("Error occurred while moving the file:",e.t0);case 15:return e.abrupt("return",null);case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,n){return e.apply(this,arguments)}}(),Nt=n(777),wt=["Yaswanth auditor fees","BWSSB Water bill","Diesel Purchased","Bescom electricity bill payment","Housekeeping Salary (Hyrunnisa / Sunanda)","Security Salary","Garden Maintenance / Work","Garbage Collection Vendor BBMP/RR Cleaning Services","Borewell And Motor Maintenance/Repair","Annual Bonus","Lift Maintenance (Johnson)","HK items (bleaching powder,garbage bin etc)","Health Club Maintenance","EB / Electrical / Plumbing Repairs","Apartment repairs related - Concrete floor - Sivaji","Apartment Safety - Fire Extiguisher","CCTV / Intercomm","Misc expenses - Cash Paid for unbilled services","Apartment developments - Stationary/books/pens/papers/clips/file/folders purchased","Apartment work done By Security and Others","Septic Tank Repair / Cleaning","Water Tank/Tanks Cleaning","Generator Maintenance and Repair","Festival/Holiday Celebration","Drinking Water for Employees","BAF Subscription Charges"];function It(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:wt,n="",a="",r="",i=e.split(/[\s_]/m).filter((function(e){return e&&"/"!==e}));return i.forEach((function(e){!n&&/^\d{2}-\d{2}-\d{4}$/.test(e)&&(n=e),!a&&/^\d+(\.\d{1,2})?$/.test(e)&&(a=e)})),r||(r=Rt(t,i)),{date:n,amount:parseFloat(a)||0,description:r}}function Rt(e,t){var n=new Map;e.forEach((function(e){var a=0,r=e.toLowerCase();t.forEach((function(e){r.includes(e.toLowerCase())&&(a+=1)})),n.set(e,a)}));var a=Array.from(n),r=[].concat(a).sort((function(e,t){return t[1]-e[1]}));return r.length>0&&0!==r[0][1]?r[0][0]:""}function Lt(e){var t;t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):unescape(e.split(",")[1]);for(var n=e.split(",")[0].split(":")[1].split(";")[0],a=new Uint8Array(t.length),r=0;r<t.length;r+=1)a[r]=t.charCodeAt(r);return new Blob([a],{type:n})}var Bt=function(){var e=Object(te.a)(Object(ee.a)().mark((function e(t){var n,a,r,i;return Object(ee.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Lt(t),a=new File([n],"canvasImage.jpg",{type:"image/jpeg"}),(r=new FormData).append("base64Image",a),e.next=6,vt.a.post("https://api.ocr.space/parse/image",r,{headers:{"Content-Type":"multipart/form-data",apikey:"K84187439488957"}});case 6:return i=e.sent,e.abrupt("return",i);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function Yt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Tt(t).then((function(t){e(t)}))}var Ht=function(){var e=Object(te.a)(Object(ee.a)().mark((function e(t){var n,a,r=arguments;return Object(ee.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:"Cash Transactions",e.next=3,_e.getSheetByTitle(n);case 3:if(e.sent){e.next=7;break}return e.next=7,_e.addSheet({headerValues:["Date","Description","Item Description/Purpose","Qty","Price","Debit","Credit","Total","Category","Flat","Bill"],title:n});case 7:return a=JSON.parse(JSON.stringify(t)),e.next=10,_e.updateSheetWithJSON(a,n);case 10:return e.abrupt("return",!0);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_t=function(e){return"https://drive.google.com/uc?id=".concat(e)},Pt=function(e,t){var n,a,r,i={Date:null!==(n=e.date)&&void 0!==n?n:"",Description:null!==(a=e.description)&&void 0!==a?a:"",Debit:null!==(r=e.amount)&&void 0!==r?r:0,Credit:0,Category:e.category,Total:0};return t&&(i.Bill=_t(t)),i},Ut=function(e){var t=Pt(e);new Qe($e).run([t]),e.category=t.Category};function Ft(e,t,n){var a={},r=new Promise((function(r){if(e&&e.indexOf("_")>-1&&(a=It(e)),a.amount&&a.date&&a.description){var i=Object(k.a)(Object(k.a)({},t),a);Ut(i),r(i)}else(function(e){var t=new FormData;return t.append("url",e),t.append("language","eng"),t.append("isOverlayRequired","true"),vt.a.post("https://api.ocr.space/parse/image",t,{headers:{"Content-Type":"multipart/form-data",apikey:"K84187439488957"}}).catch((function(e){console.error(e)}))})("https://drive.google.com/uc?id=".concat(n.id)).then((function(e){var n,i,c=It((null===(n=e.data)||void 0===n||null===(i=n.ParsedResults[0])||void 0===i?void 0:i.ParsedText)||"");c.amount=a.amount&&a.amount>0?a.amount:c.amount,c.description=a.description||c.description,c.date=a.date?a.date:c.date;var o=Object(k.a)(Object(k.a)({},t),c);Ut(o),r(o)}))}));return r}n(349);var Kt=function(e){var t=e.bills,n=e.handleClick;return Object(le.jsx)("div",{children:Object(le.jsxs)(Nt.a,{container:!0,spacing:2,children:[t.map((function(e,t){return Object(le.jsxs)(Nt.a,{item:!0,xs:2,className:"bill-grid-item",onClick:function(){return n(e)},children:[e.mimeType.startsWith("image/")&&Object(le.jsx)("img",{src:_t(e.id),alt:"Bill ".concat(t+1),style:{width:300,height:300,cursor:"pointer",padding:"5px"}}),"application/pdf"===e.mimeType&&Object(le.jsx)("embed",{src:_t(e.id),title:"Bill ".concat(t+1),style:{width:300,height:300,cursor:"pointer",padding:"5px"},type:"application/pdf"}),Object(le.jsx)("h3",{style:{textAlign:"center"},children:e.name})]},"Image ".concat(t+1))})),0===t.length&&Object(le.jsx)("h4",{className:"no-bills-msg",children:"No bills to display"})]})})},Jt=n(13),Wt=n(792),Vt=n(778),Gt=n(779),qt=n(780),zt=n(698),Zt=n(706),Xt=n(703),Qt=n(796),$t=n(699),en=n(781),tn=function(e){var t=e.callback,n=e.date,a=e.amount,i=e.description,c=e.category,o=e.image,u=e.handleClose,l=e.expenseCategories,p=e.mimeType,d=Object(r.useState)({date:R()(null!==n&&void 0!==n?n:"01-04-2023","DD-MM-YYYY").format("YYYY-MM-DD"),amount:null!==a&&void 0!==a?a:0,description:null!==i&&void 0!==i?i:"text",category:null!==c&&void 0!==c?c:""}),h=Object(s.a)(d,2),b=h[0],j=h[1],f=Object(r.useState)({date:"",amount:"",description:"",category:""}),v=Object(s.a)(f,2),O=v[0],g=v[1],m=Object(r.useCallback)((function(e){var t=e.target,n=t.name,a=t.value;j((function(e){return Object(k.a)(Object(k.a)({},e),{},Object(Jt.a)({},n,a))}))}),[]),S=Object(r.useCallback)((function(){var e=!1;if(b.amount||(O.amount="Enter a valid amount",e=!0),b.date&&"invalid date"!==b.date.toLowerCase()||(O.date="Enter a valid date",e=!0),b.description||(O.description="Enter a valid description",e=!0),b.category||(O.category="Select a category",e=!0),e)g(Object(k.a)({},O));else{var n=JSON.parse(JSON.stringify(b));n.date=R()(n.date,"YYYY-MM-DD").format("DD-MM-YYYY"),t(n)}}),[t,O,b]);return Object(le.jsx)("div",{className:"expense-dialog",children:Object(le.jsxs)(Wt.a,{open:!0,onClose:u,children:[Object(le.jsx)(Vt.a,{children:"Form"}),Object(le.jsxs)(Gt.a,{children:[p.startsWith("image/")&&Object(le.jsx)("img",{className:"expense-bill-img",src:"https://drive.google.com/uc?id=".concat(o),alt:"Expense Bill"}),"application/pdf"===p&&Object(le.jsx)("embed",{className:"expense-bill-img",src:"https://drive.google.com/uc?id=".concat(o),title:"Expense Bill"}),Object(le.jsxs)("form",{children:[Object(le.jsx)(qt.a,{type:"date",name:"date",label:"Date",value:b.date,onChange:m,fullWidth:!0,margin:"normal",variant:"outlined",placeholder:"DD-MM-YYYY",error:!!O.date,helperText:O.date}),Object(le.jsx)(qt.a,{type:"number",name:"amount",label:"Amount",value:b.amount,onChange:m,fullWidth:!0,margin:"normal",variant:"outlined",error:!!O.amount,helperText:O.amount}),Object(le.jsx)(qt.a,{type:"text",name:"description",label:"Description",value:b.description,onChange:m,fullWidth:!0,margin:"normal",variant:"outlined",error:!!O.description,helperText:O.description}),Object(le.jsxs)(zt.a,{variant:"outlined",fullWidth:!0,margin:"normal",error:!!O.category,children:[Object(le.jsx)(Zt.a,{children:"Category"}),Object(le.jsx)(Xt.a,{name:"category",value:b.category,onChange:m,label:"Category",children:l.map((function(e){return Object(le.jsx)(Qt.a,{value:e.key,children:e.label},e.key)}))}),!!O.category&&Object(le.jsx)($t.a,{children:O.category})]})]})]}),Object(le.jsxs)(en.a,{children:[Object(le.jsx)(oe.a,{onClick:function(){return u()},color:"primary",children:"Cancel"}),Object(le.jsx)(oe.a,{onClick:S,color:"primary",children:"Submit"})]})]})})},nn=function(e){var t=e.folders,n=e.handleClick;return Object(le.jsx)("div",{children:Object(le.jsx)(Nt.a,{container:!0,spacing:2,children:t.map((function(e,t){return Object(le.jsxs)(Nt.a,{item:!0,xs:2,children:[Object(le.jsx)("img",{src:"/images/folder.jpg",id:"folder-".concat(e.name),alt:"Folder ".concat(t+1),style:{width:200,height:200,cursor:"pointer",padding:"5px"},onClick:function(){return n(e.id)}}),Object(le.jsx)("h3",{style:{textAlign:"center"},children:e.name})]},"Image ".concat(t+1))}))})})},an=function(){function e(){var t=this;Object(we.a)(this,e),this.initProm=void 0,this.sheetIntialized=!1,this.sheets=new Map,this.initProm=_e.init(),this.initProm.then((function(){t.sheetIntialized=!0}))}return Object(Ie.a)(e,[{key:"getSheet",value:function(){var e=Object(te.a)(Object(ee.a)().mark((function e(t){var n=this;return Object(ee.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.sheetIntialized){e.next=3;break}return e.next=3,this.initProm;case 3:return e.abrupt("return",new Promise((function(e,a){n.sheets.has(t)?e(n.sheets.get(t)):_e.getSheetByTitle(t).then((function(r){r?(n.sheets.set(t,r),e(r)):a()}))})));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getExpenseCategories",value:function(){var e=Object(te.a)(Object(ee.a)().mark((function e(){var t=this;return Object(ee.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var a=[];t.getSheet("Summary").then((function(t){for(var n=_e.getColumnWithSheet(t,0).map((function(e){return e.value})),r=[],i=1;i<n.length-1&&"Total Expense"!==n[i];i+=1)r.push(n[i]),a=r.map((function(e){return{key:e,label:e}}));e(a)}))})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"parseMonthlySheet",value:function(){var e=Object(te.a)(Object(ee.a)().mark((function e(t){var n,a;return Object(ee.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getRows();case 2:return n=e.sent,a=n.map((function(e){return{Date:R()(e.Date,"DD/MM/YYYY").toDate(),Description:e.Desc,"Cheque No":e.ChqNo,Debit:parseFloat(e.Amount)<0?parseFloat(e.Amount):0,Credit:parseFloat(e.Amount)>=0?parseFloat(e.Amount):0,Total:parseFloat(e.Balance),type:e.Type}})),e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getMonthData",value:function(e){var t=this;return new Promise((function(n,a){t.getSheet(e).then(function(){var e=Object(te.a)(Object(ee.a)().mark((function e(a){var r;return Object(ee.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.parseMonthlySheet(a);case 2:r=e.sent,n(r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(){_e.addSheet({headerValues:["Date","Desc","ChqNo","Amount","Type","Balance"],title:e}).then((function(a){t.sheets.set(e,a),n([])}))}))}))}},{key:"pushSheetData",value:function(e,t){t.push({Date:R()(e.Date).format("DD-MM-YYYY"),Desc:e.Description,Balance:e.Total,Amount:e.Credit-e.Debit,ChqNo:e["Cheque No"],Type:e.type})}},{key:"transCompare",value:function(e,t){return R()(e.Date).format("DD/MM/YYY")===R()(t.Date).format("DD/MM/YYY")&&e.Description===t.Description&&e.Debit===t.Debit&&e.Credit===t.Credit&&e.type===t.type}},{key:"mergeSheetData",value:function(){var e=Object(te.a)(Object(ee.a)().mark((function e(t,n){var a,r,i=this;return Object(ee.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=H.appData.transactions,r=[],n.length>0?(a.forEach((function(e){-1===n.findIndex((function(t){return i.transCompare(t,e)}))&&i.pushSheetData(e,r)})),n.forEach((function(e){-1===a.findIndex((function(t){return i.transCompare(t,e)}))&&a.push(e)}))):a.forEach((function(e){return i.pushSheetData(e,r)})),!r.length){e.next=6;break}return e.next=6,t.addRows(r);case 6:return e.abrupt("return",!0);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setMonthData",value:function(){var e=Object(te.a)(Object(ee.a)().mark((function e(t){var n,a;return Object(ee.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMonthData(t);case 2:return n=e.sent,e.next=5,this.getSheet(t);case 5:return a=e.sent,e.next=8,this.mergeSheetData(a,n);case 8:return e.abrupt("return",!0);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();new an,n(666);function rn(){var e=Object(r.useState)(!1),t=Object(s.a)(e,2),n=t[0],a=t[1],i=Object(r.useState)([]),c=Object(s.a)(i,2),o=c[0],u=c[1],l=Object(r.useState)(!1),p=Object(s.a)(l,2),d=p[0],h=p[1],b=Object(r.useState)(),j=Object(s.a)(b,2),f=j[0],v=j[1],O=Object(r.useState)(""),g=Object(s.a)(O,2),m=g[0],S=g[1],y=Object(r.useState)({date:"",amount:0,description:"",category:""}),A=Object(s.a)(y,2),x=A[0],D=A[1],C=Object(r.useCallback)((function(e){S(e)}),[]),T=Object(r.useCallback)(function(){var e=Object(te.a)(Object(ee.a)().mark((function e(t){var n,r,i;return Object(ee.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v(t),a(!0),n=o.find((function(e){return e.id===t.id})),r=null===n||void 0===n?void 0:n.name,e.next=6,Ft(r,x,t);case 6:i=e.sent,a(!1),D(i),h(!0);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[o,x]),E=Object(r.useCallback)((function(e){if(f&&null!==e&&void 0!==e&&e.date){var t=o.find((function(e){return e.id===f.id}));f&&t&&Mt(f.id,t.name).then((function(){Yt(u,m);var t=[Pt(e,f.id)];Ht(t)}))}v(void 0),h(!1)}),[o,f,m]);Object(r.useEffect)((function(){Yt(u,m)}),[m]);var M=Object(r.useState)([]),N=Object(s.a)(M,2),w=N[0],I=N[1];Object(r.useEffect)((function(){Object(te.a)(Object(ee.a)().mark((function e(){var t,n;return Object(ee.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new an,e.next=3,t.getExpenseCategories();case 3:n=e.sent,I(n);case 5:case"end":return e.stop()}}),e)})))()}),[]);var R=Object(r.useMemo)((function(){return o.filter((function(e){return(e.mimeType.startsWith("image/")||"application/pdf"===e.mimeType)&&!e.name.startsWith(Dt)}))}),[o]),L=Object(r.useMemo)((function(){return o.filter((function(e){return"application/vnd.google-apps.folder"===e.mimeType}))}),[o]);return Object(le.jsxs)("div",{className:"bill-workspace",children:[Object(le.jsx)("h3",{children:"Unprocessed Bills"}),!!m&&Object(le.jsx)(oe.a,{className:"go-to-months-btn",size:"small",variant:"outlined",onClick:function(){return S("")},children:"Go Back"}),!m&&Object(le.jsx)(nn,{folders:L,handleClick:C}),!!m&&Object(le.jsx)(Kt,{bills:R,handleClick:T}),!!f&&d&&Object(le.jsx)(tn,Object(k.a)(Object(k.a)({},x),{},{image:f.id,mimeType:f.mimeType,callback:E,handleClose:E,expenseCategories:w})),n&&Object(le.jsx)("div",{className:"overlay",children:Object(le.jsx)(lt.a,{})})]})}var cn=n(787),on=n(380),sn=n.n(on),un=n(379),ln=n.n(un),pn=n(374),dn=(n(667),n(220)),hn=function(){function e(){if(Object(we.a)(this,e),this.chatGPTPrivateKey="",this.openAI=void 0,H.chatGPTPrivateKey){this.chatGPTPrivateKey=H.chatGPTPrivateKey;var t=new dn.Configuration({organization:"org-wfOq673LgvxydlfXwY3Fmcvm",apiKey:this.chatGPTPrivateKey});this.openAI=new dn.OpenAIApi(t)}}return Object(Ie.a)(e,[{key:"getCompleted",value:function(){var e=Object(te.a)(Object(ee.a)().mark((function e(t){return Object(ee.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.openAI){e.next=2;break}return e.abrupt("return",this.openAI.createCompletion({model:"text-davinci-003",prompt:"Say this is a test",max_tokens:7,temperature:0,top_p:1,n:1,stream:!1,logprobs:null,stop:"\n"}));case 2:return e.abrupt("return",Promise.resolve(""));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();hn.instance=void 0;var bn=hn;var jn=function(){var e=Object(r.useRef)(),t=Object(r.useState)(),n=Object(s.a)(t,2),a=n[0],i=n[1],c=Object(r.useState)(!0),o=Object(s.a)(c,2),u=o[0],l=o[1],p=Object(r.useCallback)((function(){var t=e.current||{};!a&&t&&t.takePhoto?(i(t.takePhoto()),l(!1)):i(void 0)}),[e,a]),d=Object(r.useCallback)((function(){l((function(e){return!e}))}),[]),h=u?"cash-trans block-page":"cash-trans",b=Object(r.useState)(),j=Object(s.a)(b,2),f=j[0],v=j[1];return Object(r.useEffect)((function(){a&&Bt(a).then(function(){var e=Object(te.a)(Object(ee.a)().mark((function e(t){var n,a,r;return Object(ee.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.data.ParsedResults[0]||{},!(a=n.ParsedText)){e.next=6;break}return e.next=4,bn.getInstance().getCompleted(a);case 4:r=e.sent,v(r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[a]),Object(le.jsxs)("div",{className:h,children:[Object(le.jsx)("div",{children:"Handle Cash Transactions"}),Object(le.jsx)("pre",{children:JSON.stringify(f,void 0,4)}),!a&&Object(le.jsx)(cn.a,{className:"close-camera","aria-label":"Take Photo",onClick:d,children:u?Object(le.jsx)(ln.a,{}):Object(le.jsx)(sn.a,{})}),!a&&Object(le.jsx)(pn.a,{ref:e,facingMode:"environment",errorMessages:{}}),Object(le.jsx)(cn.a,{className:"camera-click","aria-label":"Take Photo",onClick:p,children:Object(le.jsx)("img",{src:"/images/circular-camera.png",alt:"Take Pic"})})]})},fn=function(){return Object(le.jsx)(jn,{})},vn=n(696),On=n(786);function gn(e){var t=i.a.useState(!0),n=Object(s.a)(t,2),a=n[0],c=(n[1],i.a.useState("")),o=Object(s.a)(c,2),u=o[0],l=o[1],p=Object(r.useCallback)((function(){e.handleSecret(u)}),[e,u]),d=Object(r.useCallback)((function(e){l(e.target.value)}),[]),h=Object(r.useCallback)((function(t){13===(t.keyCode?t.keyCode:t.which)&&e.handleSecret(u)}),[e,u]);return Object(le.jsxs)(Wt.a,{open:a,keepMounted:!0,"aria-labelledby":"Secret Key","aria-describedby":"Enter your secret key",children:[Object(le.jsx)(Vt.a,{id:"alert-dialog-slide-title",children:"Enter the secret key!!!"}),Object(le.jsxs)(Gt.a,{children:[Object(le.jsx)(On.a,{id:"alert-dialog-slide-description",children:"Check with other committee members, if secret key is not known."}),Object(le.jsx)(vn.a,{type:"password",value:u,onChange:d,onKeyPress:h}),Object(le.jsx)("div",{className:"error",children:e.errorMsg})]}),Object(le.jsx)(en.a,{children:Object(le.jsx)(oe.a,{onClick:p,disabled:!u,color:"primary",children:"OK"})})]})}n(690),n(691);var mn=function(e){return Object(le.jsx)(Je,{})},Sn=function(e){return Object(le.jsx)(jt,{})},yn=function(e){return Object(le.jsx)(rn,{})},An=function(e){return Object(le.jsx)(fn,{})};var xn=function(){var e=Object(r.useState)(""),t=Object(s.a)(e,2),n=t[0],a=t[1],i=Object(r.useState)(""),c=Object(s.a)(i,2),o=c[0],p=c[1],h=Object(r.useState)(!!H.secret),j=Object(s.a)(h,2),v=j[0],m=j[1];Object(r.useEffect)((function(){o&&(L(o).res?(a(""),m(!0)):(a("Wrong secret. Enter it again."),p("")))}),[o]);var y=Object(r.useState)(!1),D=Object(s.a)(y,2),C=D[0],k=D[1];return Object(le.jsxs)(l.a,{store:$,children:[Object(le.jsxs)("header",{className:"app-header",children:[Object(le.jsx)("img",{src:"/images/ssfa.png",alt:"Suraksha Sunflower Apartment",width:"80px",height:"60px"}),Object(le.jsx)("span",{children:"Suraksha Sunflower "})]}),Object(le.jsxs)("div",{className:"app",children:[Object(le.jsxs)(x.c,{collapsed:C,children:[Object(le.jsxs)(x.a,{iconShape:"circle",children:[Object(le.jsx)(x.b,{icon:Object(le.jsx)(O.a,{}),title:"Parse Online Transactions",children:Object(le.jsx)(u.a,{to:"/",children:"Parse Online Transactions"})}),Object(le.jsx)(x.b,{icon:Object(le.jsx)(f.a,{}),title:"Categorize Transactions",children:Object(le.jsx)(u.a,{to:"cat",children:"Categorize Transactions"})}),Object(le.jsx)(x.b,{icon:Object(le.jsx)(A.a,{}),title:"Upload Bills",children:Object(le.jsx)(u.a,{to:"bills",children:"Upload Bills"})}),Object(le.jsx)(x.b,{icon:Object(le.jsx)(S.a,{}),title:"Cash Transactions",children:Object(le.jsx)(u.a,{to:"cash",children:"Cash Transactions"})})]}),Object(le.jsxs)(x.d,{className:"sb-footer",children:[!C&&Object(le.jsx)(d.a,{onClick:function(){return k(!0)}}),C&&Object(le.jsx)(b.a,{onClick:function(){return k(!1)}})]})]}),Object(le.jsxs)("div",{className:"workspace",children:[n&&Object(le.jsx)(g.a,{severity:"error",children:n}),!v&&Object(le.jsx)(gn,{errorMsg:n,handleSecret:p}),v&&Object(le.jsxs)(u.b,{children:[Object(le.jsx)(mn,{path:"/"}),Object(le.jsx)(Sn,{path:"cat"}),Object(le.jsx)(yn,{path:"bills"}),Object(le.jsx)(An,{path:"cash"})]})]})]})]})};n(692);o.a.render(Object(le.jsx)(i.a.StrictMode,{children:Object(le.jsx)(xn,{})}),document.getElementById("root"));t.default={}}},[[693,1,2]]]);
//# sourceMappingURL=main.afbc7c72.chunk.js.map