(this["webpackJsonpflat-maintenance"]=this["webpackJsonpflat-maintenance"]||[]).push([[0],{208:function(e,t){},334:function(e,t){},352:function(e,t,n){},430:function(e,t){},432:function(e,t){},473:function(e,t){},475:function(e,t){},507:function(e,t){},509:function(e,t){},510:function(e,t){},515:function(e,t){},517:function(e,t){},523:function(e,t){},525:function(e,t){},544:function(e,t){},556:function(e,t){},559:function(e,t){},607:function(e,t){},632:function(e,t,n){},635:function(e,t){},636:function(e,t){},637:function(e,t,n){},638:function(e,t,n){},640:function(e,t,n){},671:function(e,t,n){},672:function(e,t,n){},695:function(e,t,n){},697:function(e,t,n){},698:function(e,t,n){"use strict";n.r(t);var a,r=n(0),i=n.n(r),c=n(26),o=n.n(c),s=n(9),u=n(118),l=n(44),p=n(388),h=n.n(p),d=n(389),b=n.n(d),j=n(385),f=n.n(j),v=n(384),O=n.n(v),g=n(793),m=n(387),S=n.n(m),y=n(386),A=n.n(y),x=n(82),C=n(113),D=n(372),k=n(10);!function(e){e.LOAD_TRANS="LOAD_TRANS",e.LOAD_CASH_TRANS_SUCCESS="LOAD_CASH_TRANS_SUCCESS",e.LOAD_ONLINE_TRANS_SUCCESS="LOAD_ONLINE_TRANS_SUCCESS",e.LOAD_CASH_TRANS_FAILURE="LOAD_CASH_TRANS_FAILURE",e.LOAD_ONLINE_TRANS_FAILURE="LOAD_ONLINE_TRANS_FAILURE",e.UPDATE_MONTHLY_SPLIT="UPDATE_MONTHLY_SPLIT",e.RESET_MONTHLY_SPLIT="RESET_MONTHLY_SPLIT",e.UPDATE_MONTHLY_MAINT_SPLIT="UPDATE_MONTHLY_MAINT_SPLIT",e.RESET_MONTHLY_MAINT_SPLIT="RESET_MONTHLY_MAINT_SPLIT",e.RESET_TRANS="RESET_TRANS"}(a||(a={}));var T={loading:!1,cashTransData:void 0,onlineTransData:void 0,monthlyCatSplit:void 0,error:""},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case a.LOAD_TRANS:return Object(k.a)(Object(k.a)({},e),{},{loading:!0});case a.LOAD_CASH_TRANS_SUCCESS:return Object(k.a)(Object(k.a)({},e),{},{loading:!1,cashTransData:t.payload,error:""});case a.LOAD_ONLINE_TRANS_SUCCESS:return Object(k.a)(Object(k.a)({},e),{},{loading:!1,onlineTransData:t.payload,error:""});case a.LOAD_CASH_TRANS_FAILURE:return Object(k.a)(Object(k.a)({},e),{},{loading:!1,cashTransData:void 0,error:t.payload});case a.LOAD_ONLINE_TRANS_FAILURE:return Object(k.a)(Object(k.a)({},e),{},{loading:!1,onlineTransData:void 0,error:t.payload});case a.UPDATE_MONTHLY_SPLIT:return Object(k.a)(Object(k.a)({},e),{},{monthlyCatSplit:t.payload,loading:!1});case a.RESET_MONTHLY_SPLIT:return Object(k.a)(Object(k.a)({},e),{},{monthlyCatSplit:void 0});case a.UPDATE_MONTHLY_MAINT_SPLIT:return Object(k.a)(Object(k.a)({},e),{},{monthlyMaintSplit:t.payload,loading:!1});case a.RESET_MONTHLY_MAINT_SPLIT:return Object(k.a)(Object(k.a)({},e),{},{monthlyMaintSplit:void 0});case a.RESET_TRANS:return T;default:return e}},N=n(371),M=n(70),w=n.n(M),R=n(27),I=n.n(R),L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t={res:!1,error:""};if(e){var n=w.a.AES.decrypt(_.ENC_CLIENT_EMAIL,e),a=w.a.AES.decrypt(_.ENC_PRIVATE_KEY,e),r=w.a.AES.decrypt(_.ENC_CHAT_GPT_KEY,e),i=w.a.AES.decrypt(_.ENC_GOOGLE_API_KEY,e);try{_.clientEmail=n.toString(w.a.enc.Utf8),_.privateKey=a.toString(w.a.enc.Utf8),_.googleAPIKey=i.toString(w.a.enc.Utf8),_.secret=e,_.chatGPTPrivateKey=r.toString(w.a.enc.Utf8),sessionStorage.setItem("session-id",e),t.res=!0}catch(c){_.secret="",t.res=!1,t.error="Invalid Secret Provided"}}else _.secret="",t.res=!1,t.error="Empty Secret Set";return t},B=["001","002","003","004","005","007","008","009","010","011","012","101","102","103","104","105","106","107","108","109","110","111","112","201","202","203","204","205","206","207","208","209","210","211","212","301","302","303","304","305","306","307","308","309","310","311","312","401","402","403","404","405","406","407","408","409","410","411","412"],Y={transCategories:[{key:"maintenance",label:"Maintenance",children:B.map((function(e){return{key:"maintenance-".concat(e),label:e}}))},{key:"corpus",label:"Corpus Fund",children:B.map((function(e){return{key:"corpus-".concat(e),label:e}}))},{key:"monthly",label:"Monthly Expenses",children:[]},{key:"others",label:"Others",children:[{key:"fine",label:"Fine"},{key:"extra",label:"Other Income"},{key:"account-transfer",label:"FD Deposit"},{key:"tenant-deposit",label:"Tenant Deposit"},{key:"rd-deposit",label:"Deposit to RD account"}]}],transactionFinYear:I()().format("YY"),transSheetMonth:"",transactions:[]},_={secret:sessionStorage.getItem("session-id")||"",SPREADSHEET_ID:"16Q4fGH3MHV4yFZn-Ws0tDpz57hXLjOE_wDSXilJCDZ0",ENC_CLIENT_EMAIL:"U2FsdGVkX19lrOkAqkI1YRZkdHSjXZc+dtJNUzOhSlqaydB6Gxi4lm9MpS7+2/W7OtInfOCmh739buu1z1jzT/jJrAeRX2+hKkxc+3qsduw=",ENC_PRIVATE_KEY:"U2FsdGVkX1/i7T93uNMkvtV/hIYkButYpbgdWdXVf4ftrMUIjGc7OmaZRamJzAZNh3HKcvAW92t+mtWkIpJ2sLzLlB0BWWbBTZDPl+C/oD1YCcDZYCCPaHOcSvedvzBXLP3lGDi61mXPqPPGMDquh90g7oKvO8w+Oe6JIV8HQ9EYYB/rd/IRj34CP9K96NQDxcy06xsL2SfMMQuqSyBwRYYebogb4NZgpjfSKx6AJCvRnHkZMGBt2E0xtGm1UmS+XLq1Dlay8s2fJAYuF4yxSMjJpCzhOdTY0rhbTIQ8D3kZvJJU9+MCS4yqsVBCdqkWRqoQBBhHk8vSwb8ZTcomRUg4w6JDOu+HCT4vA6x5Jz8aSYu0CxZKndd4gHXy55YklnC728IKDavaEC13bNG/OrsBQL8P0IjzuomEAiQdFpdoQg81JmANZx1MbGD8NvdmuNEGzkTLPEssID5pO1AzGCepSeikWB8XXkJu+kHLGQe6SyBE7oxv5SDfeexWfkGOObo2Af9VbtZwg+jlVgKzf0lBj9NW0soC15VrpzV4t7oUpMT3Fe6d3oijHQ2hPxTYZMfuA8UsyO3WSTUbaxNWOpUbijJsDSUpENGQyr1XFSV4+3aN78prPt443BiaHAm8i50y9z2P7TJJteRrRE900MBm/9sMRK3fZb91VUJ9wsvmzRsJK7cxxBStx7T1k3wxQZCJisWXej+vqRlP0le95yB/2BikMV+nYyom4gQrySk8eW2rzvx26LS3LHf867SdpXSWzT7RBdIhxd6IXsK8B/fIjmR6zpeqMb/LUjRm4LcTn3UZgKEYDEFmgRGR07lsTP1czidqjCuOn+o9mZblzbsMFFAFzPhaj0ZKcO82vs3bHkDGIfoaN+EimD1ThwxlEehX08EOOKNLp19sxpUcwaxjbRgwunMh0o7J/H92TpsppRJJRfUEsI/ReI021yqkpiqRZcI/cEn3NykY1MualaqkuddoKqeD2LKjOmxaT26niNSsd/ffhjBD5f1DCWq84iXQaje6SIV1ZwesIUbUUG7MSTHI6Mf3LZuWIK/HQU/MhSYYtIHv7rvcJUyw0e/ZnUfKBRgyMYSLeTZI55MYPJ0HUGPJWIWnYMk8ESLBLnPnDknXo2m1i87Y37ui3Snqy7s6WW6nYlz1/HPexx/HQaQl5UsRGNre6+RREonqmL+B+AITWlN+bA4iLOnYfCg8OdyACDWBge3fwxduWWB4vtzlDNMx/Xqcb52BZAAh6d6Z7AE3t66ZfHv16VZnEEm14uV+zBgt41Mkfv0LNFZ6cqOjafwioFnMO9e3j738n2xwKMzcMzsdnhmHkyF7i7PLZqbTBp8P167/psPnfUV8vfcsmTombUUzOzViqJABfG6EczwhN19dd4lusGVDNrz43ywTA5zfU/jMcy1wk7i90rXo0HZSNNOuLGog2+qlx2xuyHORqdEVshb0BeJYckX95zjXLu6BuTO66vp4oIzecv9vprH3Jfx67mRvKKa+8xExXlY0BDM7vND5+EAZ0wz71MJonVjx/cXHqrSDxcnU1x5BJLAgZliQDZk/lAxBbUSuqvF21NBvZWGk2rDRKr5rTibBRDeOGoTQW1kRus87/YPBvThJ2OlFHkEAYskLyk8xPFTeC2XUJCEF7K6U3UpjL7LLWoCP+KcwazlItikvTzR44AAf2iFRf0+6wVQLZjpHZed0Z7KchTDyCm0ydVHuMAJjpogPjUbj26tbiICQ9SRtO+keG+JUHElkQzOe0bfsTuw8CqwPm6C1hNL9ReYYxrbwAwrZU8si4RWE1qSJ3cQXrxIOP275Uvsr5eUlgWYdJBrrYGUOjvQupB5CX9JL9SuH8Rfml2NzrMLWMM5mT9R1amUKLcl2ZyLkC4NDEmeqxPMtRtPLlQA/1aH939OdMbR5OZ9ozlSZFGiSS1eucvK44xvI4KCbFARx+urxXQgTSmZd/GwcFc5ZZXlojU8DTgQc5HTijP2x8iMptYYK/iPz2brWPs7LZsOiBaKCsbzWGdu/Lo3xJRqZoS5x7jGNl2q0JCj9/a0m7v+ODEZ6LaAQwsKX6M5iqNQ0YQWzlMClB6i1shbbrLsqtACXovqx9ACssZMVt7U9/WlDnmpjV+QT5Duhx8WBKehO2CeL2W9ZO8TtW+YDsV0mytvkXPwMl2RwMSAoNVau7b4CrU67z8BEVFcRKGHIURXxN/vithCvLR7Kk8+37cF16NOLBu1t6uixXH+0371xj74wJf7RFeeceyeZvGDrAsJ5qRvqD+vsAjl3EGUJySw1BJryedcR",ENC_GOOGLE_API_KEY:"U2FsdGVkX1+z10t9/VGkdh+xgB9JO7TwDIGpiW5ivAoQrmKV9c77947cJH49fTgzZcc5DSaLNH1jlCpIiLbSuw==",ENC_CHAT_GPT_KEY:"U2FsdGVkX19CE/c8Tng+qxPTykma92uBwnVA8hVNUPhl5desREv8awMfLxjN2ZnKC23rEB6XcYTSzVfgEwgEqQPZuhXq3Ef0cng56m8DqyI=",doc:new N.GoogleSpreadsheet("16Q4fGH3MHV4yFZn-Ws0tDpz57hXLjOE_wDSXilJCDZ0"),appData:Y},U=function(){return _};_.secret&&L(_.secret);var H,P=i.a.createContext(_);!function(e){e.all="All Transaction",e.mapped="Only Mapped",e.unmapped="Only Unmapped"}(H||(H={}));var F,K=P;!function(e){e.INIT="INIT",e.INIT_SUCCESS="GET_SHEET_INFO",e.INIT_FAILURE="GET_SHEET_INFO_FAILURE",e.SET_SHEET_INFO="SET_SHEET_INFO"}(F||(F={}));var J,W=F,V={initError:"",sheetConfig:U(),sheetInfo:new Map},G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case W.INIT:return Object(k.a)(Object(k.a)({},e),{},{initializing:!0});case W.INIT_SUCCESS:return Object(k.a)(Object(k.a)({},e),{},{initializing:!1,appConfig:t.payload});case W.INIT_FAILURE:return Object(k.a)(Object(k.a)({},e),{},{initializing:!1,initError:t.payload});case W.SET_SHEET_INFO:return Object(k.a)(Object(k.a)({},e),{},{sheetInfo:t.payload});default:return e}},q=n(30);!function(e){e.INIT="INIT",e.SUCCESS="SUCCESS",e.FAILURE="FAILURE",e.SET_CONFIG="SET_CONFIG",e.ADD_EVENTS="ADD_EVENTS"}(J||(J={}));var z,Z={isLoading:!1,data:{},config:{encBotId:"U2FsdGVkX1/0gDV/ibea6VfAgozs8tNyWPB0zt3iRLDsNORNjxOhmloQXZl7ywLjxeQl4Bmxe3iZ7RLdUxi+BA==",listURL:"https://state-tourniquet.000webhostapp.com/suraksha/telegram/get.php",fetchURL:"https://api.telegram.org/bot{{botId}}/getFile?file_id={{fileId}}",downloadURL:"https://api.telegram.org/file/bot{{botId}}/photos/{{filePath}}",updateURL:"https://state-tourniquet.000webhostapp.com/suraksha/telegram/processed.php?id={{recordId}}"},layoutData:void 0,events:[]},X=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case J.INIT:return Object(k.a)(Object(k.a)({},e),{},{isLoading:!0,layoutData:t.payload});case J.SUCCESS:return Object(k.a)(Object(k.a)({},e),{},{isLoading:!1,data:t.payload,error:void 0});case J.FAILURE:return Object(k.a)(Object(k.a)({},e),{},{isLoading:!1,data:void 0,error:t.payload});case J.SET_CONFIG:return Object(k.a)(Object(k.a)({},e),{},{config:t.payload});case J.ADD_EVENTS:return Object(k.a)(Object(k.a)({},e),{},{events:[].concat(Object(q.a)(e.events),[t.payload])});default:return e}},Q=Object(C.b)({sheet:G,trans:E,bills:X}),$=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||C.c,ee=Object(C.d)(Q,$(Object(C.a)(D.a))),te=n(7),ne=n(13),ae=n(771),re=n(801),ie=n(802),ce=n(779),oe=n(796),se=n(778),ue=n(223),le=n(373),pe=(n(632),n(2)),he=function(e){var t=Object(r.useState)(),n=Object(s.a)(t,2),a=n[0],i=n[1],c=Object(r.useCallback)((function(t){e.onUpload(t)}),[e]),o=Object(r.useCallback)((function(e){i(e)}),[]);return Object(pe.jsxs)(pe.Fragment,{children:[a&&Object(pe.jsx)(g.a,{severity:"error",children:a}),Object(pe.jsx)("p",{children:"Upload a transaction file (.xls) to process."}),Object(pe.jsx)("div",{className:"file-upload-wrapper",children:Object(pe.jsx)(le.FilePicker,{extensions:["xls","xlsx"],onChange:c,onError:o,children:Object(pe.jsx)("button",{type:"button",children:"Upload"})})})]})},de=n(220),be=n.n(de),je="__EMPTY_",fe="1",ve="3",Oe="9",ge="11",me="17",Se=["22","20","21"],ye={parseXLS:function(e){return new Promise((function(t){var n=new FileReader;n.onload=function(e){var n=be.a.read(e.target.result,{type:"binary"}),a=n.Sheets[n.SheetNames[0]],r=be.a.utils.sheet_to_json(a),i=ye.parseTransactions(r);t(i)},n.readAsBinaryString(e)}))},parseAmount:function(e){return"string"===typeof e?parseFloat(e.replace("Cr","").replaceAll(",","")):e},getWorkingColumnKeyFromArray:function(e,t){return e.find((function(e){return!!t["".concat(je).concat(e)]}))},parseTransactions:function(e){var t=[];if(e.length){var n="".concat(je).concat(fe),a=e.filter((function(e){return e[n]&&10===e[n].length&&e[n].includes("/")&&"Invalid Date"!==I()(e[n],"dd/MM/YYYY").toDate().toString()})),r=ye.getWorkingColumnKeyFromArray(Se,a[0])||"",i="".concat(je).concat(ve),c="".concat(je).concat(Oe);r="".concat(je).concat(r),t=a.map((function(e){var t={Date:I()(e[n],"DD/MM/YYYY").toDate(),Description:e[i],"Cheque No":e[c]||"",Debit:0,Credit:0,Total:ye.parseAmount(e[r]),type:"ONLINE"};return e["".concat(je).concat(ge)]&&(t.Debit=ye.parseAmount(e["".concat(je).concat(ge)])),e["".concat(je).concat(me)]&&(t.Credit=ye.parseAmount(e["".concat(je).concat(me)])),t}))}return t}},Ae=ye,xe=n(773),Ce=n(777),De=n(776),ke=n(772),Te=n(774),Ee=n(775),Ne=n(769),Me=(n(637),Object(ae.a)({table:{minWidth:650}})),we=function(e){var t=e.xlsData,n=e.name,a=Object(r.useMemo)((function(){var e={};return t.forEach((function(t){var n=I()(t.Date).format("MMM-YY");e[n]=n})),e}),[t]),i=Object.values(a),c=Object(r.useState)(1===i.length?i[0]:""),o=Object(s.a)(c,2),u=o[0],l=o[1],p=Me(),h=Object(r.useContext)(K).appData;h.transSheetMonth=u;Object(r.useCallback)((function(e){e.target.value&&(h.transSheetMonth=e.target.value,l(e.target.value))}),[h]);var d=t;u&&(d=t.filter((function(e){return I()(e.Date).format("MMM-YY")===u})),h.transactions=d);Object(r.useCallback)((function(){}),[]);return Object(pe.jsxs)(pe.Fragment,{children:[Object(pe.jsx)("div",{className:"preview-header",children:Object(pe.jsxs)("div",{children:["File: ",Object(pe.jsx)("h4",{children:n})]})}),Object(pe.jsx)(ke.a,{className:"xls-file-preview",component:Ne.a,children:Object(pe.jsxs)(xe.a,{className:p.table,size:"small",stickyHeader:!0,"aria-label":"Parsed Bank Transactions",children:[Object(pe.jsx)(Te.a,{children:Object(pe.jsxs)(Ee.a,{children:[Object(pe.jsx)(De.a,{children:"#"}),Object(pe.jsx)(De.a,{children:"Date"}),Object(pe.jsx)(De.a,{children:"Description"}),Object(pe.jsx)(De.a,{align:"right",children:"Cheque No."}),Object(pe.jsx)(De.a,{align:"right",children:"Debit"}),Object(pe.jsx)(De.a,{align:"right",children:"Credit"}),Object(pe.jsx)(De.a,{align:"right",children:"Total"})]})}),Object(pe.jsx)(Ce.a,{children:d.map((function(e,t){return Object(pe.jsxs)(Ee.a,{children:[Object(pe.jsx)(De.a,{component:"th",scope:"row",children:t+1}),Object(pe.jsx)(De.a,{component:"th",scope:"row",children:I()(e.Date).format("DD-MM-YYYY")}),Object(pe.jsx)(De.a,{children:e.Description}),Object(pe.jsx)(De.a,{align:"right",children:e["Cheque No"]}),Object(pe.jsx)(De.a,{align:"right",children:e.Debit}),Object(pe.jsx)(De.a,{align:"right",children:e.Credit}),Object(pe.jsx)(De.a,{align:"right",children:e.Total})]},e.Description)}))})]})})]})},Re=n(35),Ie=n(33),Le={"Audit Fees":1,BWSSB:2,Diesel:3,Bescom:4,"House Keeping Salary":5,Security:6,"Garden Maintenance":7,"Garbage Collection Vendor (Hasirudala)/BBMP":8,"Borewell And Motor Maintenance":9,"Annual Bonus":10,"Lift Maintenance (Johnson)":11,"HK items (bleaching powder,garbage bin etc)":12,"Health Club Maintenance":13,"Electrical / Plumbing Repairs":14,"Apartment repairs related":15,"Apartment Safety":16,"CCTV / Intercomm":17,"Misc expenses":18,"Apartment developments":19,"Apartment Work By Security and Others":20,"Septic Tank Repairs / Cleaning":21,"Water Tanks Cleaning":22,"Generator Maintenance and Repair":23,"SMS Charges/Cheque book (Vijaya Bank)":24,"Festival/Holiday Celebration":25,"Drinking Water for Employees":26,"BAF Subscription Charges":27,"Maintenance Collection":30,"Income Tax Refund":31,"Other Income":32,"Interest on account":33,"Fine / Extra Payment Received":34,"Corpus Fund":35,"Tenant Deposit from the Owners":36,"FD Deposit":37,"Deposit to RD account":38},Be={Apr:2,May:3,Jun:4,Jul:5,Aug:6,Sep:7,Oct:8,Nov:9,Dec:10,Jan:11,Feb:12,Mar:13},Ye={"001":1,"002":2,"003":3,"004":4,"005":5,"007":6,"008":7,"009":8,"010":9,"011":10,"012":11,101:12,102:13,103:14,104:15,105:16,106:17,107:18,108:19,109:20,110:21,111:22,112:23,201:24,202:25,203:26,204:27,205:28,206:29,207:30,208:31,209:32,210:33,211:34,212:35,301:36,302:37,303:38,304:39,305:40,306:41,307:42,308:43,309:44,310:45,311:46,312:47,401:48,402:49,403:50,404:51,405:52,406:53,407:54,408:55,409:56,410:57,411:58,412:59},_e={Apr:2,May:3,Jun:4,Jul:5,Aug:6,Sep:7,Oct:8,Nov:9,Dec:10,Jan:11,Feb:12,Mar:13},Ue=function(){function e(){Object(Re.a)(this,e),this.currentSheet="",this.initialized=!1,this.appConfig=void 0,this.appConfig=U()}return Object(Ie.a)(e,[{key:"init",value:function(){var e=this;return this.initialized?Promise.resolve(this.appConfig.doc):new Promise((function(t,n){var a=e.appConfig.doc;a.useServiceAccountAuth({client_email:e.appConfig.clientEmail||"",private_key:e.appConfig.privateKey||""}).then((function(){a.loadInfo().then((function(){e.initialized=!0,t(a)})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e),n(e)}))}))}},{key:"getSpreadSheet",value:function(){return this.appConfig.doc}},{key:"getSheetByTitleAsJson",value:function(){var e=Object(ne.a)(Object(te.a)().mark((function e(t){var n,a,r,i,c,o,s,u,l,p,h,d;return Object(te.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],e.next=3,this.getSheetByTitle(t);case 3:if(a=e.sent,r=a.headerValues,i=a.columnCount,!r||0===r.length)for(r=[],c=0;c<i;c+=1)o=a.getCell(0,c),o.value&&r.push(a.getCell(0,c).value.toString());i=r.length,s=a.rowCount,u=1;case 10:if(!(u<s)){e.next=22;break}for(l={},p=[],c=0;c<i;c+=1)h=r[c],d=a.getCell(u,c).formattedValue,l[h]=d,p.push(d);if(!p.some((function(e){return null!==e}))){e.next=18;break}n.push(l),e.next=19;break;case 18:return e.abrupt("break",22);case 19:u+=1,e.next=10;break;case 22:return e.abrupt("return",n);case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getSheetByTitle",value:function(){var e=Object(ne.a)(Object(te.a)().mark((function e(t){var n,a;return Object(te.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=null===(n=this.appConfig.doc)||void 0===n?void 0:n.sheetsByTitle[t])){e.next=5;break}return this.currentSheet=a.sheetId,e.next=5,a.loadCells();case 5:return e.abrupt("return",a);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getSheet",value:function(){var e=Object(ne.a)(Object(te.a)().mark((function e(t){var n;return Object(te.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentSheet=t,n=this.appConfig.doc.sheetsById[t],e.next=4,n.loadCells();case 4:return e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"appendSheet",value:function(e,t){return this.appConfig.doc.sheetsById[e].addRow(t)}},{key:"append",value:function(e){return this.appConfig.doc.sheetsById[this.currentSheet||""].addRow(e)}},{key:"appendRows",value:function(){var e=Object(ne.a)(Object(te.a)().mark((function e(t){var n;return Object(te.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.appConfig.doc.sheetsById[this.currentSheet||""],e.next=3,n.addRows(t);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getSheetRow",value:function(e,t){return this.appConfig.doc.sheetsById[e].getRows({limit:1,offset:t})}},{key:"getRow",value:function(e){return this.appConfig.doc.sheetsById[this.currentSheet||""].getRows({limit:1,offset:e})}},{key:"getColumn",value:function(e){for(var t=this.appConfig.doc.sheetsById[this.currentSheet||""],n=[],a=t.rowCount<100?t.rowCount:100,r=0;r<a-1;r+=1)n.push(t.getCell(r,e));return n}},{key:"getColumnWithSheet",value:function(e,t){for(var n=[],a=e.rowCount<100?e.rowCount:100,r=0;r<a-1;r+=1)n.push(e.getCell(r,t));return n}},{key:"getSheetColumn",value:function(e,t){for(var n=this.appConfig.doc.sheetsById[e],a=[],r=n.rowCount<100?n.rowCount:100,i=0;i<r-1;i+=1)a.push(n.getCell(i,t));return a}},{key:"getSheetCell",value:function(e,t,n){return this.appConfig.doc.sheetsById[e].getCell(t,n)}},{key:"getCell",value:function(e,t){return this.appConfig.doc.sheetsById[this.currentSheet||""].getCell(e,t)}},{key:"saveSheetCells",value:function(e,t){return this.appConfig.doc.sheetsById[e].saveCells(t)}},{key:"saveCells",value:function(e){return this.appConfig.doc.sheetsById[this.currentSheet||""].saveCells(e)}},{key:"addSheet",value:function(e){return this.appConfig.doc.addSheet(e)}},{key:"saveSheetWithJSON",value:function(){var e=Object(ne.a)(Object(te.a)().mark((function e(t){var n;return Object(te.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.appConfig.doc.sheetsById[this.currentSheet||""],e.next=3,this.updateSheet(n,t);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateCategorySheet",value:function(){var e=Object(ne.a)(Object(te.a)().mark((function e(t){var n;return Object(te.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getSheetByTitle("Summary");case 2:return n=e.sent,e.next=5,n.loadCells();case 5:return Object.keys(t).forEach((function(e){var a=t[e],r=Object.keys(a),i=e.replace(/-\d+$/,""),c=Be[i];r.forEach((function(e){var t=Le[e];"undefined"!==typeof t&&"undefined"!==typeof c&&(n.getCell(t,c).value=a[e])}))})),e.abrupt("return",n.saveUpdatedCells());case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"udpateMaintenanceSheet",value:function(){var e=Object(ne.a)(Object(te.a)().mark((function e(t){var n;return Object(te.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getSheetByTitle("Maintanence");case 2:return n=e.sent,e.next=5,n.loadCells();case 5:return Object.keys(t).forEach((function(e){var a=t[e],r=Object.keys(Ye),i=e.replace(/-\d+$/,""),c=_e[i];r.forEach((function(e){var t=Ye[e];"undefined"!==typeof t&&"undefined"!==typeof c&&(n.getCell(t,c).value=a[e])}))})),e.abrupt("return",n.saveUpdatedCells());case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"searchUpdateRecord",value:function(){var e=Object(ne.a)(Object(te.a)().mark((function e(t,n,a,r){var i,c,o,u;return Object(te.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getSheetByTitle(t);case 2:return i=e.sent,e.next=5,i.getRows();case 5:if(c=e.sent,-1===(o=c.findIndex((function(e){return Object.entries(n).every((function(t){var n=Object(s.a)(t,2),a=n[0],r=n[1];return e[a]===r}))})))){e.next=19;break}if((u=c[o])[a]){e.next=16;break}return u[a]=r,e.next=13,u.save();case 13:console.log("Record updated successfully."),e.next=17;break;case 16:console.log("Record found but input column is not empty.");case 17:e.next=21;break;case 19:throw console.log("Record not found."),new Error("RECORD_NOT_FOUND");case 21:case"end":return e.stop()}}),e,this)})));return function(t,n,a,r){return e.apply(this,arguments)}}()},{key:"isEmptySheet",value:function(e){return!e||0===e.rowCount}},{key:"updateSheet",value:function(){var e=Object(ne.a)(Object(te.a)().mark((function e(t,n){var a,r,i,c,o,s,u,l,p,h=arguments;return Object(te.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=h.length>2&&void 0!==h[2]?h[2]:0,n&&n.length)for(r=Object.keys(n[0]),i=r.length,c=a+n.length,o=a;o<c;o+=1)for(s=n[o],u=0;u<i;u+=1)l=t.getCell(o+1,u),p=s[r[u]],l.formattedValue!==p&&(l.value=p);return e.next=4,t.saveUpdatedCells();case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateSheetWithJSON",value:function(){var e=Object(ne.a)(Object(te.a)().mark((function e(t,n){return Object(te.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=3;break}return e.next=3,this.getSheetByTitle(n);case 3:return e.next=5,this.appendRows(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}],[{key:"getInstance",value:function(){return z||(z=new e).init(),z}}]),e}(),He=Ue.getInstance();var Pe=function(e){var t=e.data,n=Object(r.useState)(""),a=Object(s.a)(n,2),i=a[0],c=a[1];Object(r.useEffect)((function(){He.init()}),[]);var o=Object(r.useCallback)(Object(ne.a)(Object(te.a)().mark((function e(){var n,a;return Object(te.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="Online Transactions",e.next=3,He.getSheetByTitle(n);case 3:if(e.sent){e.next=7;break}return e.next=7,He.addSheet({headerValues:["Date","Description","Cheque No","Debit","Credit","Total","Category","Flat"],title:n});case 7:return a=JSON.parse(JSON.stringify(t)).map((function(e){return e.Date=I()(e.Date).format("DD-MM-YYYY"),e})),e.next=10,He.updateSheetWithJSON(a,n);case 10:c("Sheet Updated");case 11:case"end":return e.stop()}}),e)}))),[t]);return Object(pe.jsxs)(pe.Fragment,{children:[Object(pe.jsx)("p",{children:i}),Object(pe.jsx)("div",{className:"tools",children:Object(pe.jsx)(se.a,{variant:"outlined",onClick:o,children:"Save Sheet"})})]})},Fe=(n(638),Object(ae.a)((function(e){return Object(re.a)({root:{width:"100%"},button:{marginRight:e.spacing(1)},instructions:{marginTop:e.spacing(1),marginBottom:e.spacing(1)}})})));var Ke,Je=function(){var e=Fe(),t=Object(l.c)((function(e){return e.sheet})).sheetConfig,n=Object(r.useState)(""),a=Object(s.a)(n,2),i=a[0],c=a[1],o=Object(r.useState)(0),u=Object(s.a)(o,2),p=u[0],h=u[1],d=Object(r.useState)(""),b=Object(s.a)(d,2),j=b[0],f=b[1],v=Object(r.useState)([]),O=Object(s.a)(v,2),m=O[0],S=O[1],y=Object(r.useCallback)((function(e){f(e.name),Ae.parseXLS(e).then((function(e){t.appData.transactions=e,e.reverse(),S(e),c(""),h(1)}))}),[t.appData]),A=Object(r.useCallback)((function(e){switch(e){case 0:return Object(pe.jsx)(he,{onUpload:y});case 1:return Object(pe.jsx)(we,{name:j,xlsData:m});case 2:return Object(pe.jsx)(Pe,{data:m});default:return"Unknown step"}}),[m,y,j]),x=Object(r.useState)(new Set),C=Object(s.a)(x,2),D=C[0],T=C[1],E=["File Upload","File Preview","Save"],N=Object(r.useCallback)((function(e){return D.has(e)}),[D]),M=Object(r.useCallback)(Object(ne.a)(Object(te.a)().mark((function e(){var t;return Object(te.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=D,N(p)&&(t=new Set(t.values())).delete(p),e.t0=p,e.next=0===e.t0?5:(e.t0,7);break;case 5:return j?(h((function(e){return e+1})),c("")):c("Select a file."),e.abrupt("break",9);case 7:h((function(e){return e+1})),c("");case 9:T(t);case 10:case"end":return e.stop()}}),e)}))),[p,j,N,D]),w=Object(r.useCallback)((function(){h(0)}),[]);return Object(pe.jsxs)("div",{className:"wizard",children:[i&&Object(pe.jsx)(g.a,{severity:"error",children:i}),Object(pe.jsxs)("div",{className:e.root,children:[Object(pe.jsx)(ie.a,{activeStep:p,children:E.map((function(e,t){var n={},a={};return N(t)&&(n.completed=!1),Object(pe.jsx)(ce.a,Object(k.a)(Object(k.a)({},n),{},{children:Object(pe.jsx)(oe.a,Object(k.a)(Object(k.a)({},a),{},{children:e}))}),e)}))}),Object(pe.jsxs)("div",{children:[p===E.length&&Object(pe.jsxs)("div",{children:[Object(pe.jsx)(ue.a,{className:e.instructions,children:"All steps completed - you're finished"}),Object(pe.jsx)(se.a,{onClick:w,className:e.button,children:"Reset"})]}),p!==E.length&&Object(pe.jsxs)("div",{children:[Object(pe.jsx)(ue.a,{className:e.instructions,children:A(p)}),Object(pe.jsxs)("div",{children:[Object(pe.jsx)(se.a,{disabled:0===p,onClick:function(){h((function(e){return e-1}))},className:e.button,children:"Back"}),!1,Object(pe.jsx)(se.a,{variant:"contained",color:"primary",onClick:M,className:e.button,children:p===E.length-1?"Save":"Next"})]})]})]})]})]})},We=function(){return Object(pe.jsx)(Je,{})},Ve=n(221),Ge=n.n(Ve);function qe(e){return function(t){t({type:W.INIT});var n,a=L(e);a.res?t((n=Object(k.a)({},U()),{type:W.INIT_SUCCESS,payload:n})):t(function(e){return{type:W.INIT_FAILURE,payload:e}}(a.error))}}!function(e){e.and="and",e.or="or",e.xor="xor",e.not="not",e.nand="nand",e.nor="nor"}(Ke||(Ke={}));var ze,Ze=function(){function e(t){Object(Re.a)(this,e),this.query=void 0,this.query=t}return Object(Ie.a)(e,[{key:"run",value:function(e){var t=this;return Object.keys(this.query).every((function(n){var a=t.query[n];switch(n){case Ke.or:return a.some((function(t){return e(t)}));case Ke.nor:return!a.some((function(t){return e(t)}));case Ke.xor:var r=a.map((function(t){return e(t)}));return r.some((function(e){return!0===e}))&&r.some((function(e){return!1===e}));case Ke.nand:case Ke.not:return!a.every((function(t){return e(t)}));case Ke.and:default:return a.every((function(t){return e(t)}))}}))}}]),e}(),Xe=function(){function e(t){Object(Re.a)(this,e),this.query=void 0,this.query=t}return Object(Ie.a)(e,[{key:"run",value:function(e){var t=!1,n=this.query,a=n.opr,r=n.value;if(e&&r)switch(a){case"==":t=e.toString()===r.toString();break;case"!=":t=e.toString()!==r.toString();break;case">":t=e>r;break;case">=":t=e>=r;break;case"<":t=e<r;break;case"<=":t=e<=r;break;case"having":if("string"===typeof e)if(Array.isArray(r))t=r.some((function(t){var n=t.toString();return e.toLowerCase().indexOf(n.toLowerCase())>-1}));else{var i=r.toString();t=e.toLowerCase().indexOf(i.toLowerCase())>-1}break;case"regex":if(Array.isArray(r))t=r.some((function(t){var n,a=t.toString(),r=new RegExp(a,"i");return(null===(n=e.match(r))||void 0===n?void 0:n.length)>0}));else{var c,o=r.toString(),s=new RegExp(o,"i");t=(null===(c=e.match(s))||void 0===c?void 0:c.length)>0}break;case"in":Array.isArray(r)&&(t="string"===typeof r[0]?r.indexOf(e.toString())>-1:r.indexOf(e)>-1);break;case"range":Array.isArray(r)&&(t=(t="undefined"===typeof r[0]||e>=r[0])&&("undefined"===typeof r[1]||e<=r[1]))}return t}}]),e}(),Qe=function(){function e(t){Object(Re.a)(this,e),this.query=void 0,this.query=t}return Object(Ie.a)(e,[{key:"run",value:function(e){var t=this;return Object.keys(this.query).every((function(n){var a=t.query[n],r=!1;Array.isArray(a)?r=a.every((function(t){var a=new Xe(t),r=e[n];return a.run(r)})):r=new Ze(a).run((function(t){var a=new Xe(t),r=e[n];return a.run(r)}));return r}))}}]),e}(),$e=function(){function e(t){Object(Re.a)(this,e),this.catFieldMap=void 0,this.catFieldMap=t}return Object(Ie.a)(e,[{key:"run",value:function(e){var t=this,n=Object.keys(this.catFieldMap);e.forEach((function(e){if(!e.Category){var a=n.find((function(n){var a,r=t.catFieldMap[n];Array.isArray(r)?a=r.every((function(t){return new Qe(t).run(e)})):a=new Ze(r).run((function(t){return new Qe(t).run(e)}));return a}));e.Category=a}}))}}]),e}(),et={"Maintenance Collection":[{Credit:[{opr:"in",value:["2,600.00","2600","2,700.00","2700","2,800.00","2800","5,400.00","5400","5,500.00","5500","5,600.00","5600","8,100.00","8100","5,200.00","5200","8,400.00","8400","10,800.00","10800","11,200.00","11200","14,000.00","14000","13,500.00","13500"]}],Description:[{opr:"having",value:["maintenance","neft","upi","imps"]}]}],"Audit Fees":[{Description:[{opr:"having",value:["N YASWANTH","YASWANTH","audit","audit fees"]}]}],"Corpus Fund":[{Credit:[{opr:"in",value:["7500","7,500.00","15,000.00","15000","22,500.00","22500","30,000.00","30000","37,500.00","37500","45,000.00","45000"]}],Description:[{opr:"having",value:["corpus","neft","upi","imps"]}]}],"Income Tax Refund":[{Credit:[{opr:"in",value:["ACH","AY20","ACH Credit","AAKAS1985M"]}]}],Bescom:[{Description:[{opr:"having",value:["BESCOM","Electricity","EBANK:BBPS"]}]}],BWSSB:[{Debit:[{opr:"range",value:[14e3,16500]}],Description:[{opr:"having",value:["BANGALORE WATER SUPPLY","BWSSB","BANGALORE ONE","EBANK:BBPS"]}]}],"CCTV / Intercomm":[{Description:[{opr:"having",value:["SHANKAR TELECOM LINKS","Intercom"]}]}],Security:[{Debit:[{opr:"in",value:["35,000.00","35000","41000","41,000.00"]}]}],"House Keeping Salary":[{Description:[{opr:"regex",value:["Housekeeping.+Salary","House keeping.+Salary","house-keeping.+salary","housekeeping.+ladies","hk.+salary","hyrunni","sunanda"]}]}],"Garden Maintenance":[{Description:[{opr:"regex",value:["garden","Gardner.+Salary","garden.+work","Manure"]}]}],"Garbage Collection Vendor (Hasirudala)/BBMP":[{Description:[{opr:"having",value:["SYED ALI BASHA","RR CLEANING","RR CLEAN"]}]}],"Borewell And Motor Maintenance":[{Description:[{opr:"having",value:["borewell","motor","coil","winding"]}]}],"Lift Maintenance (Johnson)":[{Description:[{opr:"regex",value:["JOHNSON.+LIFTS","Lift"]}]}],"HK items (bleaching powder,garbage bin etc)":[{Description:[{opr:"regex",value:["Housekeeping.+Items","Housekeeping.+Material","hk.+item","HK.+Material","bleaching","garbage drum","powder","mop","dust","dustbin","soap","detergent","broom","switch","tubelight","switch","light","bulb","Phenoyl","powder","phenoyl","sanitizer","cleaner","dettol","bottle","neem oil","tap","kerosene"]}]}],"Electrical / Plumbing Repairs":[{Description:[{opr:"having",value:["electric repair","electric work","electric","Chamundi","plumbing"]}]}],"Septic Tank Repairs / Cleaning":[{Description:[{opr:"having",value:["septik","septic","septic tank","sewage","sewage tank","sewage work","sewage pipe"]}]}],"Water Tanks Cleaning":[{Description:[{opr:"regex",value:["water.+tank","cauvery","kaveri"]}]}],"Generator Maintenance and Repair":[{Description:[{opr:"regex",value:["venus.+energy","kirloskar","generator"]}]}],"SMS Charges/Cheque book (Vijaya Bank)":[{Description:[{opr:"regex",value:["SMS .+Alert","cheque.+book","charges","chq.+book"]}]}],"Health Club Maintenance":[{Description:[{opr:"having",value:["gym","FITNESS","sports"]}]}],"Festival/Holiday Celebration":[{Description:[{opr:"regex",value:["diwali.+work","diwali","festival","celebration","pooja","pongal","independence","republic","sweets","flag"]}]}],"Drinking Water for Employees":[{Description:[{opr:"having",value:["drinking","drinking water","mineral water","water purchase"]}]}],Diesel:[{Description:[{opr:"regex",value:["Diesel"]}]}],"BAF Subscription Charges":[{Description:[{opr:"regex",value:["BAF","BAF Subscription"]}]}],"Annual Bonus":[{Description:[{opr:"regex",value:["bonus"]}]}],"Interest on account":[{Description:[{opr:"having",value:["89630100005613"]}]}],"FD Deposit":[{Description:[{opr:"having",value:["TO TRANSFER","Repayment Credit"]}]}],"Tenant Deposit from the Owners":[{Credit:[{opr:"in",value:["10,000.00","10000"]}]}],"Apartment Work By Security and Others":[{Description:[{opr:"regex",value:["Apartment.+Work","Cleaning.+Rain Water"]}]}],"Apartment Safety":[{Description:[{opr:"having",value:["sanitization","sanitizing","mask","sheild","shield","spray","cutting tree","fire","extinguisher","rat poison"]}]}],"Apartment developments":[{Description:[{opr:"having",value:["stationery","pen","paper","folder","files","notebook","note book","note-book","entry book","reciept book","bought","purchased","purchase of","cash voucher"]}]}],"Apartment repairs related":[{Description:[{opr:"having",value:["cement work","cement","service","repair","spanner","fixing","fixed"]}]}],"Misc expenses":[{Description:[{opr:"having",value:["tea","coffee"]}]}],"Fine / Extra Payment Received":[{Description:[{opr:"having",value:["maintenance","neft","upi","imps"]}],Credit:[{opr:"regex",value:["\\d"]}]}],"Other Income":[{Description:[{opr:"having",value:["income","other"]}],Credit:[{opr:">",value:0}]}],"Cash Withdrawal / in hand":{or:[{Description:[{opr:"regex",value:["cash","withdrawal","bank","basavaraj","carry.+forwarded","self"]}]},{"Cheque No":[{opr:"regex",value:["\\d+"]}]}]},"Deposit to RD account":[{Description:[{opr:"having",value:["3715125","SI:89630300010611"]}]}]},tt={"001":[{Description:[{opr:"having",value:["khadir","MOHAMEDABDULKHA"]}]}],"002":[{Description:[{opr:"having",value:["shainv","potti","MAHESH","NAGARAJ MUTHUSAMY","NAGARAJ"]}]}],"003":[{Description:[{opr:"having",value:["gulshan","padma","6364883334","subhrojyoti","6289470044"]}]}],"004":[{Description:[{opr:"having",value:["ANAND","ESHWARDAS"]}]}],"005":[{Description:[{opr:"having",value:["KOPRESH"]}]}],"007":[{Description:[{opr:"having",value:["007"]}]}],"008":[{Description:[{opr:"having",value:["NITHINS","/008","Repaka"]}]}],"009":[{Description:[{opr:"having",value:["rutvijkanzaria","PRATIK"]}]}],"010":[{Description:[{opr:"having",value:["ANANTH"]}]}],"011":[{Description:[{opr:"having",value:["AKARSH"]}]}],"012":[{Description:[{opr:"having",value:["K B GANESH","GANESH"]}]}],101:[{Description:[{opr:"having",value:["VIJAYAKUMAR T","VIJAYAKUMAR"]}]}],102:[{Description:[{opr:"having",value:["ARNAB","CHAKRABORTY","ARNABCHAKRABORT"]}]}],103:[{Description:[{opr:"having",value:["KRISHNA KUMAR","KRISHNAKUMAR"]}]}],104:[{Description:[{opr:"having",value:["AMIT KUMAR","KARMAKAR","AMITKUMAR"]}]}],105:[{Description:[{opr:"having",value:["VIKASVERMA","VIKAS VERMA","MB105","105MAINTENA"]}]}],106:[{Description:[{opr:"having",value:["mr.uttammohanty"]}]}],107:[{Description:[{opr:"having",value:["POLAKALA"]}]}],108:[{Description:[{opr:"having",value:["EMMANUEL RAJA A","EMMANUEL"]}]}],109:[{Description:[{opr:"having",value:["K S A RAJA RAM KUMAR","RAJARAMKUMAR"]}]}],110:[{Description:[{opr:"having",value:["SONYKUMARI","SONY KUMARI","PAVAN DEVARU","PAVANDEVARU","MOBLTA"]}]}],111:[{Description:[{opr:"having",value:["SENTHILKUMAR","SENTHIL"]}]}],112:[{Description:[{opr:"having",value:["ARINDAM"]}]}],201:[{Description:[{opr:"having",value:["ESWAR KRISHNAN","ESWAR","KARTHIKEYAN","flat201"]}]}],202:[{Description:[{opr:"having",value:["SRIHARSHA","SRI HARSHA"]}]}],203:[{Description:[{opr:"having",value:["NILOTPALDAS"]}]}],204:[{Description:[{opr:"having",value:["AMLANJYOTI","AMLAN"]}]}],205:[{Description:[{opr:"having",value:["VIKRAMADITYA"]}]}],206:[{Description:[{opr:"having",value:["PINAKI"]}]}],207:[{Description:[{opr:"having",value:["PRIYA MISHRA","PRIYAMISHRA","SRINIVAS","prashant.dombale"]}]}],208:[{Description:[{opr:"having",value:["JESUDOSS"]}]}],209:[{Description:[{opr:"having",value:["AJUJAMESASHOK","AJU JAMES ASHOK","AJUJAMES","T R RAJARAM","TRRAJARAM","CHALAPATHI"]}]}],210:[{Description:[{opr:"having",value:["TARANBIR","IMPSMBRSur"]}]}],211:[{Description:[{opr:"having",value:["9972528008","pranjan"]}]}],212:[{Description:[{opr:"having",value:["SURAJIT"]}]}],301:[{Description:[{opr:"having",value:["PRABUDH"]}]}],302:[{Description:[{opr:"having",value:["BALAJI"]}]}],303:[{Description:[{opr:"having",value:["SURENDRA"]}]}],304:[{Description:[{opr:"having",value:["MEHDI"]}]}],305:[{Description:[{opr:"having",value:["VIVIN"]}]}],306:[{Description:[{opr:"having",value:["ASHIM","DEBAJYOTI"]}]}],307:[{Description:[{opr:"having",value:["SAMPREETH"]}]}],308:[{Description:[{opr:"having",value:["PRAHLAD"]}]}],309:[{Description:[{opr:"having",value:["7406849918","prasad.kiran","kbv018@okhdfcbank"]}]}],310:[{Description:[{opr:"having",value:["PREMA"]}]}],311:[{Description:[{opr:"having",value:["GURUPRASADA","CHOKKADI"]}]}],312:[{Description:[{opr:"having",value:["SHAKTHI","VINAYAK"]}]}],401:[{Description:[{opr:"having",value:["HARISHA"]}]}],402:[{Description:[{opr:"having",value:["JITHA","JITHAJAMES","JITHA JAMES"]}]}],403:[{Description:[{opr:"having",value:["8147758124","shaheer"]}]}],404:[{Description:[{opr:"having",value:["NOBROKER","/404Main","MOHAMMED SAIF"]}]}],405:[{Description:[{opr:"having",value:["SANTOSHKUMAR","/405main","SANTHOSH KUMAR","MALLA"]}]}],406:[{Description:[{opr:"having",value:["PRAVEENVIJAY","PRAVEEN VIJAY"]}]}],407:[{Description:[{opr:"having",value:["GALLA","VARADARAJU"]}]}],408:[{Description:[{opr:"having",value:["UDAY KIRAN","UDAY","YAGNAMURTHY"]}]}],409:[{Description:[{opr:"having",value:["PRABU","SUNDARRAJU","Jeevanantham"]}]}],410:[{Description:[{opr:"having",value:["rohinimh19","ROHINI","MALLIKARJUN"]}]}],411:[{Description:[{opr:"having",value:["NATESAN","ADITYA KOLLURI","ADITYAKOLLURI"]}]}],412:[{Description:[{opr:"having",value:["CHIRANJAN"]}]}]},nt=function(){function e(t){Object(Re.a)(this,e),this.catFieldMap=void 0,this.catFieldMap=t}return Object(Ie.a)(e,[{key:"run",value:function(e){var t=this,n=Object.keys(this.catFieldMap);e.forEach((function(e){if(!e.Flat){var a=n.find((function(n){var a,r=t.catFieldMap[n];Array.isArray(r)?a=r.every((function(t){return new Qe(t).run(e)})):a=new Ze(r).run((function(t){return new Qe(t).run(e)}));return a}));e.Flat=a}}))}}]),e}();!function(e){e["Audit Fees"]="Audit Fees",e.BWSSB="BWSSB",e.Diesel="Diesel",e.Bescom="Bescom",e["House Keeping Salary"]="House Keeping Salary",e.Security="Security",e.Gardener="Gardener",e["Garbage Collection Vendor (Hasirudala)/BBMP"]="Garbage Collection Vendor (Hasirudala)/BBMP",e["Borewell And Motor Maintenance"]="Borewell And Motor Maintenance",e["Annual Bonus"]="Annual Bonus",e["Lift Maintenance (Johnson)"]="Lift Maintenance (Johnson)",e["HK items (bleaching powder,garbage bin etc)"]="HK items (bleaching powder,garbage bin etc)",e["Health Club Maintenance"]="Health Club Maintenance",e["Electrical / Plumbing Repairs"]="Electrical / Plumbing Repairs",e["Apartment repairs related"]="Apartment repairs related",e["Apartment Painting"]="Apartment Painting",e["CCTV / Intercomm"]="CCTV / Intercomm",e["Misc expenses"]="Misc expenses",e["Apartment developments"]="Apartment developments",e["Apartment Work By Security and Others"]="Apartment Work By Security and Others",e["Septic Tank Repairs / Cleaning"]="Septic Tank Repairs / Cleaning",e["Water Tanks Cleaning"]="Water Tanks Cleaning",e["Generator Maintenance and Repair"]="Generator Maintenance and Repair",e["SMS Charges/Cheque book (Vijaya Bank)"]="SMS Charges/Cheque book (Vijaya Bank)",e["Festival/Holiday Celebration"]="Festival/Holiday Celebration",e["Drinking Water for Employees"]="Drinking Water for Employees",e["BAF Subscription Charges"]="BAF Subscription Charges",e["Maintenance Collection"]="Maintenance Collection",e["Income Tax Refund"]="Income Tax Refund",e["Other Income"]="Other Income",e["Interest on account"]="Interest on account",e["Fine / Extra Payment Received"]="Fine / Extra Payment Received",e["Corpus Fund"]="Corpus Fund",e["Tenant Deposit from the Owners"]="Tenant Deposit from the Owners",e["FD Deposit"]="FD Deposit"}(ze||(ze={}));var at=function(){return{type:a.LOAD_TRANS}},rt=function(e){return{type:a.LOAD_CASH_TRANS_SUCCESS,payload:e}},it=function(e){return{type:a.LOAD_ONLINE_TRANS_SUCCESS,payload:e}},ct=function(e){return{type:a.LOAD_CASH_TRANS_FAILURE,payload:e}},ot=function(e){return{type:a.LOAD_ONLINE_TRANS_FAILURE,payload:e}};function st(e,t){return e.filter((function(e){return e.Category&&t.indexOf(e.Category)>-1}))}function ut(e,t){return function(n){var r;n(at()),e.forEach((function(e){var n=e.Category,a=e.Date;if(n&&a){var r,i=a.replace(/\//g,"-"),c=I()(i,"DD-MM-YYYY").format("MMM-YY");t||(t={}),t[c]||(t[c]={});var o=e.Debit&&"0"!==(null===(r=e.Debit)||void 0===r?void 0:r.toString()),s=o?parseFloat(e.Debit.toString().replace(/,/g,"")):parseFloat(e.Credit.toString().replace(/,/g,""));o&&(s=-s),s&&"number"===typeof s?t[c][n]?t[c][n]+=s:t[c][n]=s:console.log("cat",n,c,e)}})),n((r=Object(k.a)({},t),{type:a.UPDATE_MONTHLY_SPLIT,payload:r}))}}function lt(e,t){return function(n){var r;n(at()),e.forEach((function(e){var n=e.Flat,a=e.Date;if(n&&a){var r=I()(a,"DD/MM/YYYY").format("MMM-YY");t||(t={}),t[r]||(t[r]={});var i=parseFloat(e.Credit.toString().replace(/,/g,""));i&&"number"===typeof i?t[r][n]?t[r][n]+=i:t[r][n]=i:console.log("Flat",n,r,e)}})),n((r=Object(k.a)({},t),{type:a.UPDATE_MONTHLY_MAINT_SPLIT,payload:r}))}}var pt=n(780);var ht=function(){var e=Object(l.c)((function(e){return e.trans})),t=Object(l.b)();Object(r.useEffect)((function(){t(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Cash Transactions";return function(t){t(at()),He.init().then((function(){He.getSheetByTitleAsJson(e).then((function(e){new $e(et).run(e),new nt(tt).run(st(e,[ze["Maintenance Collection"],ze["Corpus Fund"]])),t(rt(e)),He.saveSheetWithJSON(e)})).catch((function(e){t(ct(e.message))}))}))}}())}),[t]);var n=e.cashTransData,a=Object(r.useMemo)((function(){var e=[];return n&&n.length>1&&(e=Object.keys(n[0])),e}),[n]);return Object(pe.jsx)(pe.Fragment,{children:Object(pe.jsxs)("div",{className:"cash-trans",children:[e.loading&&Object(pe.jsx)(pt.a,{}),!e.loading&&Object(pe.jsxs)(xe.a,{children:[Object(pe.jsx)(Te.a,{children:Object(pe.jsxs)(Ee.a,{children:[Object(pe.jsx)(De.a,{children:"Sl. No."}),a.map((function(e){return Object(pe.jsx)(De.a,{children:e},e)}))]})}),Object(pe.jsx)(Ce.a,{children:!!n&&n.map((function(e,t){return Object(pe.jsxs)(Ee.a,{children:[Object(pe.jsx)(De.a,{children:t+1}),a.map((function(t){return Object(pe.jsx)(De.a,{children:"Date"!==t?e[t]:I()(e[t],"DD/MM/YYYY").format("DD/MM/YYYY")},"".concat(t,"-").concat(e[t]))}))]},JSON.stringify(e))}))})]})]})})};var dt=function(){var e=Object(l.c)((function(e){return e.trans})),t=Object(l.b)();Object(r.useEffect)((function(){t(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Online Transactions";return function(t){t(at()),He.init().then((function(){He.getSheetByTitleAsJson(e).then((function(e){new $e(et).run(e),new nt(tt).run(st(e,[ze["Maintenance Collection"],ze["Corpus Fund"]])),t(it(e)),He.saveSheetWithJSON(e)})).catch((function(e){t(ot(e.message))}))}))}}("Online Transactions"))}),[t]);var n=e.onlineTransData,a=Object(r.useMemo)((function(){var e=[];return n&&n.length>1&&(e=Object.keys(n[0])),e}),[n]);return Object(pe.jsx)(pe.Fragment,{children:Object(pe.jsxs)("div",{className:"online-trans",children:[e.loading&&Object(pe.jsx)(pt.a,{}),!e.loading&&Object(pe.jsxs)(xe.a,{children:[Object(pe.jsx)(Te.a,{children:Object(pe.jsxs)(Ee.a,{children:[Object(pe.jsx)(De.a,{children:"Sl. No."}),a.map((function(e){return Object(pe.jsx)(De.a,{children:e},e)}))]})}),Object(pe.jsx)(Ce.a,{children:!!n&&n.map((function(e,t){return Object(pe.jsxs)(Ee.a,{children:[Object(pe.jsx)(De.a,{children:t+1}),a.map((function(t){return Object(pe.jsx)(De.a,{children:"Date"!==t?e[t]:I()(e[t],"DD-MM-YYYY").format("DD/MM/YYYY")},"".concat(t,"-").concat(e[t]))}))]},JSON.stringify(e))}))})]})]})})},bt=(n(640),Object(ae.a)((function(e){return Object(re.a)({root:{width:"100%"},button:{marginRight:e.spacing(1)},instructions:{marginTop:e.spacing(1),marginBottom:e.spacing(1)}})})));var jt=function(){var e=Object(r.useState)(),t=Object(s.a)(e,2),n=t[0],a=t[1],i=Object(r.useState)("cash"),c=Object(s.a)(i,2),o=(c[0],c[1]),u=Object(r.useState)(""),p=Object(s.a)(u,2),h=p[0],d=(p[1],Object(l.b)()),b=Object(l.c)((function(e){return e.sheet})),j=b.initError,f=Object(l.c)((function(e){return e.trans})),v=f.monthlyCatSplit,O=f.cashTransData,m=f.onlineTransData,S=f.monthlyMaintSplit;Object(r.useEffect)((function(){h&&d(qe(h))}),[d,h]);var y=Object(r.useCallback)((function(){O&&m&&(d(ut([].concat(Object(q.a)(O),Object(q.a)(m)),{})),o(void 0))}),[O,d,m]),A=Object(r.useCallback)((function(){if(O&&m){var e=st([].concat(Object(q.a)(O),Object(q.a)(m)),[ze["Maintenance Collection"]]);d(lt(e,{})),o(void 0)}}),[O,d,m]),x=Object(r.useCallback)((function(){He.updateCategorySheet(v).then((function(){console.log("Saved"),a("Summary Updated")}))}),[v]),C=Object(r.useCallback)((function(){He.udpateMaintenanceSheet(S).then((function(){console.log("Saved"),a("Maintenence Split Updated")}))}),[S]),D=Object(r.useState)(0),T=Object(s.a)(D,2),E=T[0],N=T[1],M=Object(r.useMemo)((function(){return["Cash Transactions","Online Transactions","Map Transactions","Categorize Maintenance"]}),[]),w=Object(r.useCallback)((function(e){return!1}),[]),R=Object(r.useCallback)((function(e){return!1}),[]),I=bt(),L=Object(r.useCallback)((function(){switch(E){case 3:o(void 0),N(2);break;case 2:o("online"),N(1);break;case 1:o("cash"),N(0)}}),[E]),B=Object(r.useCallback)((function(){}),[]),Y=Object(r.useCallback)((function(){switch(E){case 0:o("online"),N(1);break;case 1:o(void 0),N(2),y();break;case 2:o(void 0),N(3),A()}}),[E,A,y]);return Object(pe.jsxs)("div",{children:[!!n&&Object(pe.jsx)(g.a,{severity:"info",children:n}),!!j&&Object(pe.jsx)(g.a,{severity:"error",children:j}),Object(pe.jsxs)("div",{className:"stepper-header",children:[Object(pe.jsx)(ie.a,{className:"steps",activeStep:E,children:M.map((function(e,t){var n={},a={};return w(t)&&(a.optional=Object(pe.jsx)(ue.a,{variant:"caption",children:"Optional"})),R(t)&&(n.completed=!1),Object(pe.jsx)(ce.a,Object(k.a)(Object(k.a)({},n),{},{children:Object(pe.jsx)(oe.a,Object(k.a)(Object(k.a)({},a),{},{children:e}))}),e)}))}),Object(pe.jsxs)("div",{className:"nav",children:[Object(pe.jsx)(se.a,{disabled:0===E,onClick:L,className:I.button,children:"Back"}),w(E)&&Object(pe.jsx)(se.a,{variant:"contained",color:"primary",onClick:B,className:I.button,children:"Skip"}),Object(pe.jsx)(se.a,{variant:"contained",color:"primary",onClick:Y,className:I.button,children:E===M.length-1?"Save":"Next"})]})]}),Object(pe.jsxs)("div",{className:"control",children:[2===E&&Object(pe.jsx)(se.a,{variant:"outlined",disabled:!v,onClick:x,children:"Save Categorized"}),"\xa0\xa0\xa0",3===E&&Object(pe.jsx)(se.a,{variant:"outlined",disabled:!S,onClick:C,children:"Save Split"})]}),!j&&!!b.sheetConfig.secret&&Object(pe.jsxs)(pe.Fragment,{children:[0===E&&Object(pe.jsx)(ht,{}),1===E&&Object(pe.jsx)(dt,{}),2===E&&!!v&&Object(pe.jsx)(Ge.a,{src:v}),3===E&&!!S&&Object(pe.jsx)(Ge.a,{src:S})]})]})},ft=function(){return Object(pe.jsx)(jt,{})},vt=n(63),Ot=n.n(vt),gt=n(375),mt=n.n(gt),St=n(376),yt=function(){var e=Object(ne.a)(Object(te.a)().mark((function e(){var t,n,a,r,i,c,o,s=arguments;return Object(te.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:Math.floor(Date.now()/1e3+3600),n="",a=U(),r=a.clientEmail,i=a.privateKey,c={iss:r,sub:n,aud:"https://www.googleapis.com/oauth2/v4/token",scope:"https://www.googleapis.com/auth/drive",exp:t,iat:Math.floor(Date.now()/1e3),jti:Object(St.uuid)()},o=mt.a.sign(c,i||"",{algorithm:"RS256"}),e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),At=function(){var e=Object(ne.a)(Object(te.a)().mark((function e(){var t,n,a,r,i;return Object(te.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=U(),n=t.clientEmail,e.next=3,yt();case 3:return a=e.sent,"https://www.googleapis.com/oauth2/v4/token",r={grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",client_id:n,assertion:a},e.next=8,Ot.a.post("https://www.googleapis.com/oauth2/v4/token",r);case 8:if(200!==(i=e.sent).status){e.next=11;break}return e.abrupt("return",i.data.access_token);case 11:throw new Error(i.data);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),xt="VERIFIED_",Ct="1zVRwXWZjfAS3Hk1rXq-XtqurPcQ-yAW-";function Dt(e){return kt.apply(this,arguments)}function kt(){return(kt=Object(ne.a)(Object(te.a)().mark((function e(t){var n,a,r,i,c;return Object(te.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=U(),a=n.googleAPIKey,r=encodeURI("'".concat(t||Ct,"' in parents and (mimeType = 'image/jpeg' or mimeType = 'image/png' or mimeType = 'application/pdf' or mimeType = 'application/vnd.google-apps.folder')")),e.prev=3,e.next=6,Ot.a.get("https://www.googleapis.com/drive/v3/files?q=".concat(r,"&key=").concat(a));case 6:return i=e.sent,c=i.data.files,console.log("Fetched files:",c),e.abrupt("return",c);case 12:e.prev=12,e.t0=e.catch(3),console.error("Error fetching files:",(null===e.t0||void 0===e.t0?void 0:e.t0.message)||e.t0);case 15:return e.abrupt("return",[]);case 16:case"end":return e.stop()}}),e,null,[[3,12]])})))).apply(this,arguments)}var Tt=function(){var e=Object(ne.a)(Object(te.a)().mark((function e(t,n){var a,r;return Object(te.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,At();case 3:return a=e.sent,e.next=6,Ot.a.patch("https://www.googleapis.com/drive/v3/files/".concat(t),{name:"".concat(xt).concat(n)},{headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"}});case 6:if(r=e.sent,console.log("File moved successfully:",r.data),200!==r.status){e.next=10;break}return e.abrupt("return",r.data);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error("Error occurred while moving the file:",e.t0);case 15:return e.abrupt("return",null);case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,n){return e.apply(this,arguments)}}(),Et=n(781);function Nt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];t&&0!==t.length||(t=Object.values(ze));var n="",a="",r="",i=e.split(/[\s_]/m).filter((function(e){return e&&"/"!==e}));return i.forEach((function(e){!n&&/^\d{2}-\d{2}-\d{4}$/.test(e)&&(n=e),!a&&/^\d+(\.\d{1,2})?$/.test(e)&&(a=e)})),r||(r=Mt(t,i)),{date:n,amount:parseFloat(a)||0,description:r}}function Mt(e,t){var n=new Map;e.forEach((function(e){var a=0,r=e.toLowerCase();t.forEach((function(e){r.includes(e.toLowerCase())&&(a+=1)})),n.set(e,a)}));var a=Array.from(n),r=[].concat(a).sort((function(e,t){return t[1]-e[1]}));return r.length>0&&0!==r[0][1]?r[0][0]:""}function wt(e){var t;t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):unescape(e.split(",")[1]);for(var n=e.split(",")[0].split(":")[1].split(";")[0],a=new Uint8Array(t.length),r=0;r<t.length;r+=1)a[r]=t.charCodeAt(r);return new Blob([a],{type:n})}var Rt=function(){var e=Object(ne.a)(Object(te.a)().mark((function e(t){var n,a,r,i;return Object(te.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=wt(t),a=new File([n],"canvasImage.jpg",{type:"image/jpeg"}),(r=new FormData).append("base64Image",a),e.next=6,Ot.a.post("https://api.ocr.space/parse/image",r,{headers:{"Content-Type":"multipart/form-data",apikey:"K84187439488957"}});case 6:return i=e.sent,e.abrupt("return",i);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function It(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Dt(t).then((function(t){e(t)}))}var Lt=function(){var e=Object(ne.a)(Object(te.a)().mark((function e(t,n){return Object(te.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bt(t.date,t.amount,t.category||"",Ut(n));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function Bt(e,t,n,a){return Yt.apply(this,arguments)}function Yt(){return(Yt=Object(ne.a)(Object(te.a)().mark((function e(t,n,a,r){var i;return Object(te.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={Date:t,Debit:n,Category:a},e.prev=1,e.next=4,He.searchUpdateRecord("Online Transactions",i,"Bill",r);case 4:e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(1),i={Debit:n,Category:a},e.next=11,He.searchUpdateRecord("Online Transactions",i,"Bill",r);case 11:case"end":return e.stop()}}),e,null,[[1,6]])})))).apply(this,arguments)}var _t=function(){var e=Object(ne.a)(Object(te.a)().mark((function e(t){var n,a,r=arguments;return Object(te.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:"Cash Transactions",e.next=3,He.getSheetByTitle(n);case 3:if(e.sent){e.next=7;break}return e.next=7,He.addSheet({headerValues:["Date","Description","Item Description/Purpose","Qty","Price","Debit","Credit","Total","Category","Flat","Bill"],title:n});case 7:return a=JSON.parse(JSON.stringify(t)),e.next=10,He.updateSheetWithJSON(a,n);case 10:return e.abrupt("return",!0);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ut=function(e){return"https://drive.google.com/uc?id=".concat(e)},Ht=function(e,t){var n,a,r,i={Date:null!==(n=e.date)&&void 0!==n?n:"",Description:null!==(a=e.description)&&void 0!==a?a:"",Debit:null!==(r=e.amount)&&void 0!==r?r:0,Credit:0,Category:e.category,Total:0};return t&&(i.Bill=Ut(t)),i},Pt=function(e,t){var n=Ht(e);t&&(n.Description=t),new $e(et).run([n]),e.category=n.Category,e.category&&(e.description=e.category)};function Ft(e,t){var n={};return new Promise((function(a){if(e&&e.indexOf("_")>-1&&(n=Nt(e)),n.amount&&n.date&&n.description){var r=Object(k.a)({},n);Pt(r),a(r)}else(function(e){var t=new FormData;return t.append("url",e),t.append("language","eng"),t.append("isOverlayRequired","true"),Ot.a.post("https://api.ocr.space/parse/image",t,{headers:{"Content-Type":"multipart/form-data",apikey:"K84187439488957"}}).catch((function(e){console.error(e)}))})("https://drive.google.com/uc?id=".concat(t.id)).then((function(e){var t,r,i,c=(null===(t=e.data)||void 0===t||null===(r=t.ParsedResults[0])||void 0===r?void 0:r.ParsedText)||"",o=Nt(c);o.amount=n.amount&&n.amount>0?n.amount:o.amount,o.description=null!==(i=n.description)&&void 0!==i?i:o.description,o.date=n.date?n.date:o.date;var s=Object(k.a)({},o);Pt(s,c.toLowerCase()),a(s)}))}))}n(352);var Kt,Jt=function(e){var t=e.bills,n=e.handleClick;return Object(pe.jsx)("div",{children:Object(pe.jsxs)(Et.a,{container:!0,spacing:2,children:[t.map((function(e,t){return Object(pe.jsxs)(Et.a,{item:!0,xs:2,className:"bill-grid-item",onClick:function(){return n(e)},children:[e.mimeType.startsWith("image/")&&Object(pe.jsx)("img",{src:Ut(e.id),alt:"Bill ".concat(t+1),style:{width:300,height:300,cursor:"pointer",padding:"5px"}}),"application/pdf"===e.mimeType&&Object(pe.jsx)("embed",{src:Ut(e.id),title:"Bill ".concat(t+1),style:{width:300,height:300,cursor:"pointer",padding:"5px"},type:"application/pdf"}),Object(pe.jsx)("h3",{style:{textAlign:"center"},children:e.name})]},"Image ".concat(t+1))})),0===t.length&&Object(pe.jsx)("h4",{className:"no-bills-msg",children:"No bills to display"})]})})},Wt=n(15),Vt=n(798),Gt=n(782),qt=n(783),zt=n(701),Zt=n(799),Xt=n(784),Qt=n(794),$t=n(702),en=n(785),tn=n(710),nn=n(708),an=n(803),rn=n(786),cn=function(e){var t=e.callback,n=e.date,a=e.amount,i=e.description,c=e.category,o=e.image,u=e.handleClose,l=e.expenseCategories,p=e.mimeType,h=e.transactionType,d=Object(r.useState)({date:I()(null!==n&&void 0!==n?n:"01-04-2023","DD-MM-YYYY").format("YYYY-MM-DD"),amount:null!==a&&void 0!==a?a:0,description:null!==i&&void 0!==i?i:"text",category:null!==c&&void 0!==c?c:"",transactionType:h}),b=Object(s.a)(d,2),j=b[0],f=b[1],v=Object(r.useState)({date:"",amount:"",description:"",category:"",transactionType:""}),O=Object(s.a)(v,2),g=O[0],m=O[1],S=Object(r.useCallback)((function(e){var t=e.target,n=t.name,a=t.value;f((function(e){return Object(k.a)(Object(k.a)({},e),{},Object(Wt.a)({},n,a))}))}),[]),y=Object(r.useCallback)((function(){var e=!1;if(j.transactionType||(g.transactionType="Select a transaction type",e=!0),j.amount||(g.amount="Enter a valid amount",e=!0),j.date&&"invalid date"!==j.date.toLowerCase()||(g.date="Enter a valid date",e=!0),j.description||(g.description="Enter a valid description",e=!0),j.category||(g.category="Select a category",e=!0),e)m(Object(k.a)({},g));else{var n=JSON.parse(JSON.stringify(j));n.date=I()(n.date,"YYYY-MM-DD").format("DD-MM-YYYY"),t(n)}}),[t,g,j]);return Object(pe.jsx)("div",{className:"expense-dialog",children:Object(pe.jsxs)(Vt.a,{open:!0,onClose:u,className:"bill-grid-dialog",fullWidth:!0,scroll:"paper",children:[Object(pe.jsx)(Gt.a,{children:"Form"}),Object(pe.jsxs)(qt.a,{children:[p.startsWith("image/")&&Object(pe.jsx)("img",{className:"expense-bill-img",src:"https://drive.google.com/uc?id=".concat(o),alt:"Expense Bill"}),"application/pdf"===p&&Object(pe.jsx)("embed",{className:"expense-bill-img",src:"https://drive.google.com/uc?id=".concat(o),title:"Expense Bill"}),Object(pe.jsxs)("form",{children:[Object(pe.jsxs)(zt.a,{variant:"outlined",fullWidth:!0,margin:"normal",error:!!g.transactionType,children:[Object(pe.jsxs)(Zt.a,{"aria-label":"Transaction Type",name:"transactionType",value:j.transactionType,onChange:S,row:!0,children:[Object(pe.jsx)(Xt.a,{value:"Cash",control:Object(pe.jsx)(Qt.a,{color:"primary"}),label:"Cash"}),Object(pe.jsx)(Xt.a,{value:"Online",control:Object(pe.jsx)(Qt.a,{color:"primary"}),label:"Online"})]}),!!g.transactionType&&Object(pe.jsx)($t.a,{children:g.transactionType})]}),Object(pe.jsx)(en.a,{type:"date",name:"date",label:"Date",value:j.date,onChange:S,fullWidth:!0,margin:"normal",variant:"outlined",placeholder:"DD-MM-YYYY",error:!!g.date,helperText:g.date}),Object(pe.jsx)(en.a,{type:"number",name:"amount",label:"Amount",value:j.amount,onChange:S,fullWidth:!0,margin:"normal",variant:"outlined",error:!!g.amount,helperText:g.amount}),Object(pe.jsx)(en.a,{type:"text",name:"description",label:"Description",value:j.description,onChange:S,fullWidth:!0,margin:"normal",variant:"outlined",error:!!g.description,helperText:g.description}),Object(pe.jsxs)(zt.a,{variant:"outlined",fullWidth:!0,margin:"normal",error:!!g.category,children:[Object(pe.jsx)(tn.a,{children:"Category"}),Object(pe.jsx)(nn.a,{name:"category",value:j.category,onChange:S,label:"Category",children:l.map((function(e){return Object(pe.jsx)(an.a,{value:e.key,children:e.label},e.key)}))}),!!g.category&&Object(pe.jsx)($t.a,{children:g.category})]})]})]}),Object(pe.jsxs)(rn.a,{children:[Object(pe.jsx)(se.a,{onClick:function(){return u()},color:"primary",children:"Cancel"}),Object(pe.jsx)(se.a,{onClick:y,color:"primary",children:"Submit"})]})]})})};!function(e){e.Online="Online",e.Cash="Cash"}(Kt||(Kt={}));var on=function(e){var t=e.folders,n=e.handleClick;return Object(pe.jsx)("div",{children:Object(pe.jsx)(Et.a,{container:!0,spacing:2,children:t.map((function(e,t){return Object(pe.jsxs)(Et.a,{item:!0,xs:2,children:[Object(pe.jsx)("img",{src:"/images/folder.jpg",id:"folder-".concat(e.name),alt:"Folder ".concat(t+1),style:{width:200,height:200,cursor:"pointer",padding:"5px"},onClick:function(){return n(e.id)}}),Object(pe.jsx)("h3",{style:{textAlign:"center"},children:e.name})]},"Image ".concat(t+1))}))})})},sn=function(){function e(){var t=this;Object(Re.a)(this,e),this.initProm=void 0,this.sheetIntialized=!1,this.sheets=new Map,this.initProm=He.init(),this.initProm.then((function(){t.sheetIntialized=!0}))}return Object(Ie.a)(e,[{key:"getSheet",value:function(){var e=Object(ne.a)(Object(te.a)().mark((function e(t){var n=this;return Object(te.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.sheetIntialized){e.next=3;break}return e.next=3,this.initProm;case 3:return e.abrupt("return",new Promise((function(e,a){n.sheets.has(t)?e(n.sheets.get(t)):He.getSheetByTitle(t).then((function(r){r?(n.sheets.set(t,r),e(r)):a()}))})));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getExpenseCategories",value:function(){var e=Object(ne.a)(Object(te.a)().mark((function e(){var t=this;return Object(te.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var a=[];t.getSheet("Summary").then((function(t){for(var n=He.getColumnWithSheet(t,0).map((function(e){return e.value})),r=[],i=1;i<n.length-1&&"Total Expense"!==n[i];i+=1)r.push(n[i]),a=r.map((function(e){return{key:e,label:e}}));e(a)}))})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"parseMonthlySheet",value:function(){var e=Object(ne.a)(Object(te.a)().mark((function e(t){var n,a;return Object(te.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getRows();case 2:return n=e.sent,a=n.map((function(e){return{Date:I()(e.Date,"DD/MM/YYYY").toDate(),Description:e.Desc,"Cheque No":e.ChqNo,Debit:parseFloat(e.Amount)<0?parseFloat(e.Amount):0,Credit:parseFloat(e.Amount)>=0?parseFloat(e.Amount):0,Total:parseFloat(e.Balance),type:e.Type}})),e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getMonthData",value:function(e){var t=this;return new Promise((function(n,a){t.getSheet(e).then(function(){var e=Object(ne.a)(Object(te.a)().mark((function e(a){var r;return Object(te.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.parseMonthlySheet(a);case 2:r=e.sent,n(r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(){He.addSheet({headerValues:["Date","Desc","ChqNo","Amount","Type","Balance"],title:e}).then((function(a){t.sheets.set(e,a),n([])}))}))}))}},{key:"pushSheetData",value:function(e,t){t.push({Date:I()(e.Date).format("DD-MM-YYYY"),Desc:e.Description,Balance:e.Total,Amount:e.Credit-e.Debit,ChqNo:e["Cheque No"],Type:e.type})}},{key:"transCompare",value:function(e,t){return I()(e.Date).format("DD/MM/YYY")===I()(t.Date).format("DD/MM/YYY")&&e.Description===t.Description&&e.Debit===t.Debit&&e.Credit===t.Credit&&e.type===t.type}},{key:"mergeSheetData",value:function(){var e=Object(ne.a)(Object(te.a)().mark((function e(t,n){var a,r,i=this;return Object(te.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=U().appData.transactions,r=[],n.length>0?(a.forEach((function(e){-1===n.findIndex((function(t){return i.transCompare(t,e)}))&&i.pushSheetData(e,r)})),n.forEach((function(e){-1===a.findIndex((function(t){return i.transCompare(t,e)}))&&a.push(e)}))):a.forEach((function(e){return i.pushSheetData(e,r)})),!r.length){e.next=6;break}return e.next=6,t.addRows(r);case 6:return e.abrupt("return",!0);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setMonthData",value:function(){var e=Object(ne.a)(Object(te.a)().mark((function e(t){var n,a;return Object(te.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMonthData(t);case 2:return n=e.sent,e.next=5,this.getSheet(t);case 5:return a=e.sent,e.next=8,this.mergeSheetData(a,n);case 8:return e.abrupt("return",!0);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();new sn,n(671);function un(){var e=Object(r.useState)(!1),t=Object(s.a)(e,2),n=t[0],a=t[1],i=Object(r.useState)([]),c=Object(s.a)(i,2),o=c[0],u=c[1],l=Object(r.useState)(!1),p=Object(s.a)(l,2),h=p[0],d=p[1],b=Object(r.useState)(),j=Object(s.a)(b,2),f=j[0],v=j[1],O=Object(r.useState)(""),g=Object(s.a)(O,2),m=g[0],S=g[1],y=Object(r.useState)({date:"",amount:0,description:"",category:""}),A=Object(s.a)(y,2),x=A[0],C=A[1],D=Object(r.useCallback)((function(e){S(e)}),[]),T=Object(r.useCallback)(function(){var e=Object(ne.a)(Object(te.a)().mark((function e(t){var n,r,i;return Object(te.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v(t),a(!0),n=o.find((function(e){return e.id===t.id})),r=null===n||void 0===n?void 0:n.name,e.next=6,Ft(r,t);case 6:i=e.sent,a(!1),C(i),d(!0);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[o]),E=Object(r.useCallback)((function(e){if(f&&null!==e&&void 0!==e&&e.date){var t=o.find((function(e){return e.id===f.id}));f&&t&&Tt(f.id,t.name).then((function(){if(It(u,m),e.transactionType===Kt.Cash){var t=[Ht(e,f.id)];_t(t)}else Lt(e,f.id)}))}v(void 0),d(!1)}),[o,f,m]);Object(r.useEffect)((function(){It(u,m)}),[m]);var N=Object(r.useState)([]),M=Object(s.a)(N,2),w=M[0],R=M[1];Object(r.useEffect)((function(){Object(ne.a)(Object(te.a)().mark((function e(){var t,n;return Object(te.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new sn,e.next=3,t.getExpenseCategories();case 3:n=e.sent,R(n);case 5:case"end":return e.stop()}}),e)})))()}),[]);var I=Object(r.useMemo)((function(){return o.filter((function(e){return(e.mimeType.startsWith("image/")||"application/pdf"===e.mimeType)&&!e.name.startsWith(xt)}))}),[o]),L=Object(r.useMemo)((function(){return o.filter((function(e){return"application/vnd.google-apps.folder"===e.mimeType}))}),[o]);return Object(pe.jsxs)("div",{className:"bill-workspace",children:[Object(pe.jsx)("h3",{children:"Unprocessed Bills"}),!!m&&Object(pe.jsx)(se.a,{className:"go-to-months-btn",size:"small",variant:"outlined",onClick:function(){return S("")},children:"Go Back"}),!m&&Object(pe.jsx)(on,{folders:L,handleClick:D}),!!m&&Object(pe.jsx)(Jt,{bills:I,handleClick:T}),!!f&&h&&Object(pe.jsx)(cn,Object(k.a)(Object(k.a)({},x),{},{image:f.id,mimeType:f.mimeType,callback:E,handleClose:E,expenseCategories:w})),n&&Object(pe.jsx)("div",{className:"overlay",children:Object(pe.jsx)(pt.a,{})})]})}var ln=n(792),pn=n(383),hn=n.n(pn),dn=n(382),bn=n.n(dn),jn=n(377),fn=(n(672),n(222)),vn=function(){function e(){if(Object(Re.a)(this,e),this.chatGPTPrivateKey="",this.openAI=void 0,this.appConfig=void 0,this.appConfig=U(),this.appConfig.chatGPTPrivateKey){this.chatGPTPrivateKey=this.appConfig.chatGPTPrivateKey;var t=new fn.Configuration({organization:"org-wfOq673LgvxydlfXwY3Fmcvm",apiKey:this.chatGPTPrivateKey});this.openAI=new fn.OpenAIApi(t)}}return Object(Ie.a)(e,[{key:"getCompleted",value:function(){var e=Object(ne.a)(Object(te.a)().mark((function e(t){return Object(te.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.openAI){e.next=2;break}return e.abrupt("return",this.openAI.createCompletion({model:"text-davinci-003",prompt:"Say this is a test",max_tokens:7,temperature:0,top_p:1,n:1,stream:!1,logprobs:null,stop:"\n"}));case 2:return e.abrupt("return",Promise.resolve(""));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();vn.instance=void 0;var On=vn;var gn=function(){var e=Object(r.useRef)(),t=Object(r.useState)(),n=Object(s.a)(t,2),a=n[0],i=n[1],c=Object(r.useState)(!0),o=Object(s.a)(c,2),u=o[0],l=o[1],p=Object(r.useCallback)((function(){var t=e.current||{};!a&&t&&t.takePhoto?(i(t.takePhoto()),l(!1)):i(void 0)}),[e,a]),h=Object(r.useCallback)((function(){l((function(e){return!e}))}),[]),d=u?"cash-trans block-page":"cash-trans",b=Object(r.useState)(),j=Object(s.a)(b,2),f=j[0],v=j[1];return Object(r.useEffect)((function(){a&&Rt(a).then(function(){var e=Object(ne.a)(Object(te.a)().mark((function e(t){var n,a,r;return Object(te.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.data.ParsedResults[0]||{},!(a=n.ParsedText)){e.next=6;break}return e.next=4,On.getInstance().getCompleted(a);case 4:r=e.sent,v(r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[a]),Object(pe.jsxs)("div",{className:d,children:[Object(pe.jsx)("div",{children:"Handle Cash Transactions"}),Object(pe.jsx)("pre",{children:JSON.stringify(f,void 0,4)}),!a&&Object(pe.jsx)(ln.a,{className:"close-camera","aria-label":"Take Photo",onClick:h,children:u?Object(pe.jsx)(bn.a,{}):Object(pe.jsx)(hn.a,{})}),!a&&Object(pe.jsx)(jn.a,{ref:e,facingMode:"environment",errorMessages:{}}),Object(pe.jsx)(ln.a,{className:"camera-click","aria-label":"Take Photo",onClick:p,children:Object(pe.jsx)("img",{src:"/images/circular-camera.png",alt:"Take Pic"})})]})},mn=function(){return Object(pe.jsx)(gn,{})},Sn=n(703),yn=n(791);function An(e){var t=i.a.useState(!0),n=Object(s.a)(t,2),a=n[0],c=(n[1],i.a.useState("")),o=Object(s.a)(c,2),u=o[0],l=o[1],p=Object(r.useCallback)((function(){e.handleSecret(u)}),[e,u]),h=Object(r.useCallback)((function(e){l(e.target.value)}),[]),d=Object(r.useCallback)((function(t){13===(t.keyCode?t.keyCode:t.which)&&e.handleSecret(u)}),[e,u]);return Object(pe.jsxs)(Vt.a,{open:a,keepMounted:!0,"aria-labelledby":"Secret Key","aria-describedby":"Enter your secret key",children:[Object(pe.jsx)(Gt.a,{id:"alert-dialog-slide-title",children:"Enter the secret key!!!"}),Object(pe.jsxs)(qt.a,{children:[Object(pe.jsx)(yn.a,{id:"alert-dialog-slide-description",children:"Check with other committee members, if secret key is not known."}),Object(pe.jsx)(Sn.a,{type:"password",value:u,onChange:h,onKeyPress:d}),Object(pe.jsx)("div",{className:"error",children:e.errorMsg})]}),Object(pe.jsx)(rn.a,{children:Object(pe.jsx)(se.a,{onClick:p,disabled:!u,color:"primary",children:"OK"})})]})}n(695),n(696);var xn=function(e){return Object(pe.jsx)(We,{})},Cn=function(e){return Object(pe.jsx)(ft,{})},Dn=function(e){return Object(pe.jsx)(un,{})},kn=function(e){return Object(pe.jsx)(mn,{})};var Tn=function(){var e=Object(r.useState)(""),t=Object(s.a)(e,2),n=t[0],a=t[1],i=Object(r.useState)(""),c=Object(s.a)(i,2),o=c[0],p=c[1],d=Object(r.useState)(!!U().secret),j=Object(s.a)(d,2),v=j[0],m=j[1];Object(r.useEffect)((function(){o&&(L(o).res?(a(""),m(!0)):(a("Wrong secret. Enter it again."),p("")))}),[o]);var y=Object(r.useState)(!1),C=Object(s.a)(y,2),D=C[0],k=C[1];return Object(pe.jsxs)(l.a,{store:ee,children:[Object(pe.jsxs)("header",{className:"app-header",children:[Object(pe.jsx)("img",{src:"/images/ssfa.png",alt:"Suraksha Sunflower Apartment",width:"80px",height:"60px"}),Object(pe.jsx)("span",{children:"Suraksha Sunflower "})]}),Object(pe.jsxs)("div",{className:"app",children:[Object(pe.jsxs)(x.c,{collapsed:D,children:[Object(pe.jsxs)(x.a,{iconShape:"circle",children:[Object(pe.jsx)(x.b,{icon:Object(pe.jsx)(O.a,{}),title:"Parse Online Transactions",children:Object(pe.jsx)(u.a,{to:"/",children:"Parse Online Transactions"})}),Object(pe.jsx)(x.b,{icon:Object(pe.jsx)(f.a,{}),title:"Categorize Transactions",children:Object(pe.jsx)(u.a,{to:"cat",children:"Categorize Transactions"})}),Object(pe.jsx)(x.b,{icon:Object(pe.jsx)(A.a,{}),title:"Upload Bills",children:Object(pe.jsx)(u.a,{to:"bills",children:"Upload Bills"})}),Object(pe.jsx)(x.b,{icon:Object(pe.jsx)(S.a,{}),title:"Cash Transactions",children:Object(pe.jsx)(u.a,{to:"cash",children:"Cash Transactions"})})]}),Object(pe.jsxs)(x.d,{className:"sb-footer",children:[!D&&Object(pe.jsx)(h.a,{onClick:function(){return k(!0)}}),D&&Object(pe.jsx)(b.a,{onClick:function(){return k(!1)}})]})]}),Object(pe.jsxs)("div",{className:"workspace",children:[n&&Object(pe.jsx)(g.a,{severity:"error",children:n}),!v&&Object(pe.jsx)(An,{errorMsg:n,handleSecret:p}),v&&Object(pe.jsxs)(u.b,{children:[Object(pe.jsx)(xn,{path:"/"}),Object(pe.jsx)(Cn,{path:"cat"}),Object(pe.jsx)(Dn,{path:"bills"}),Object(pe.jsx)(kn,{path:"cash"})]})]})]})]})};n(697);o.a.render(Object(pe.jsx)(i.a.StrictMode,{children:Object(pe.jsx)(Tn,{})}),document.getElementById("root"));t.default={}}},[[698,1,2]]]);
//# sourceMappingURL=main.4d71d9cf.chunk.js.map